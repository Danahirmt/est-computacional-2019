<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Datos limpios | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Datos limpios | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Datos limpios | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="transformación-de-datos.html"/>
<link rel="next" href="temas-selectos-de-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
<li class="chapter" data-level="10.9.1" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#iniciales-en-stan"><i class="fa fa-check"></i><b>10.9.1</b> Iniciales en Stan</a></li>
<li class="chapter" data-level="10.9.2" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recursos-de-stan-y-paquetes-con-r"><i class="fa fa-check"></i><b>10.9.2</b> Recursos de Stan y paquetes con R:</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datos-limpios" class="section level2">
<h2><span class="header-section-number">3.2</span> Datos limpios</h2>
<p>Una vez que importamos datos a R es conveniente limpiarlos, esto implica
almacenarlos de una manera consisistente que nos permita enfocarnos en responder
preguntas de los datos en lugar de estar luchando con los datos.</p>
<p>Datos limpios son datos que facilitan las tareas del análisis de datos:</p>
<ul>
<li><p><strong>Visualización</strong>: Resúmenes de datos usando gráficas, análisis exploratorio,
o presentación de resultados.</p></li>
<li><p><strong>Manipulación</strong>: Manipulación de variables como agregar, filtrar, reordenar,
transformar.</p></li>
<li><p><strong>Modelación</strong>: Ajustar modelos es sencillo si los datos están en la forma
correcta.</p></li>
</ul>

<div class="caja">
<p>Los <strong>principios de los datos limpios</strong> <span class="citation">(Wickham <a href="#ref-tidy">2014</a>)</span>
proveen una manera estándar de organizar la información:</p>
<ol style="list-style-type: decimal">
<li>Cada columna es una variable.</li>
<li>Cada renglón es una observación .</li>
<li>Cada celda es un único valor.
</div></li>
</ol>
<p>Vale la pena notar que los principios de los datos limpios se pueden ver como
teoría de algebra relacional para estadísticos, estós principios junto con
<em>cada tipo de unidad observacional forma una tabla</em> equivalen a
<a href="https://en.wikipedia.org/wiki/Third_normal_form">la tercera forma normal de Codd</a>
con enfoque en una sola tabla de datos en lugar de muchas conectadas en bases de
datos relacionales.</p>
<p>Veamos un ejemplo:</p>
<p>La mayor parte de las bases de datos en estadística tienen forma rectangular,
¿cuántas variables tiene la siguiente tabla?</p>
<div class="mi-tabla">
<table>
<thead>
<tr class="header">
<th></th>
<th>tratamientoA</th>
<th>tratamientoB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Juan Aguirre</td>
<td>-</td>
<td>2</td>
</tr>
<tr class="even">
<td>Ana Bernal</td>
<td>16</td>
<td>11</td>
</tr>
<tr class="odd">
<td>José López</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>La tabla anterior también se puede estructurar de la siguiente manera:</p>
<div class="mi-tabla">
<table>
<thead>
<tr class="header">
<th></th>
<th>Juan Aguirre</th>
<th>Ana Bernal</th>
<th>José López</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tratamientoA</td>
<td>-</td>
<td>16</td>
<td>3</td>
</tr>
<tr class="even">
<td>tratamientoB</td>
<td>2</td>
<td>11</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>Si vemos los principios (cada variable forma una columna, cada observación
forma un renglón, cada tipo de unidad observacional forma una tabla), ¿las
tablas anteriores cumplen los principios?</p>
<p>Para responder la pregunta identifiquemos primero cuáles son las variables y
cuáles las observaciones de esta pequeña base. Las variables son:
persona/nombre, tratamiento y resultado. Entonces, siguiendo los principios de
<em>datos limpios</em> obtenemos la siguiente estructura:</p>
<div class="mi-tabla">
<table>
<thead>
<tr class="header">
<th>nombre</th>
<th>tratamiento</th>
<th>resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Juan Aguirre</td>
<td>a</td>
<td>-</td>
</tr>
<tr class="even">
<td>Ana Bernal</td>
<td>a</td>
<td>16</td>
</tr>
<tr class="odd">
<td>José López</td>
<td>a</td>
<td>3</td>
</tr>
<tr class="even">
<td>Juan Aguirre</td>
<td>b</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Ana Bernal</td>
<td>b</td>
<td>11</td>
</tr>
<tr class="even">
<td>José López</td>
<td>b</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<div id="limpieza-bases-de-datos" class="section level3 unnumbered">
<h3>Limpieza bases de datos</h3>
<p>Los principios de los datos limpios parecen obvios pero la mayor parte de los
datos no los cumplen debido a:</p>
<ol style="list-style-type: decimal">
<li>La mayor parte de la gente no está familiarizada con los principios y es
difícil derivarlos por uno mismo.<br />
</li>
<li>Los datos suelen estar organizados para facilitar otros aspectos que no son
análisis, por ejemplo, la captura.</li>
</ol>
<p>Algunos de los problemas más comunes en las bases de datos que no están
<em>limpias</em> son:</p>
<ul>
<li>Los encabezados de las columnas son valores y no nombres de variables.</li>
<li>Más de una variable por columna.</li>
<li>Las variables están organizadas tanto en filas como en columnas.</li>
<li>Más de un tipo de observación en una tabla.</li>
<li>Una misma unidad observacional está almacenada en múltiples tablas.</li>
</ul>
<p>La mayor parte de estos problemas se pueden arreglar con pocas herramientas,
a continuación veremos como <em>limpiar</em> datos usando 2 funciones del paquete
<code>tidyr</code>:</p>
<ul>
<li><code>pivot_longer()</code>: recibe múltiples columnas y las convierte en pares de
valores y nombres de tal manera que alarga los datos.<br />
</li>
<li><code>pivot_wider()</code>: el opuesto a <code>pivot_longer()</code> recibe columnas que separa
haciendo los datos más anchos.</li>
</ul>
<p>Repasaremos los problemas más comunes que se encuentran en conjuntos de datos
sucios y mostraremos como se puede manipular la tabla de datos (usando las
funciones de pivoteo) con el fin de estructurarla para que cumpla los
principios de datos limpios.</p>
<p><strong>Nota:</strong> Quizá has visto código de <code>tidyr</code> usando las funciones <code>gather()</code> y
<code>spread()</code>, estas son versiones anteriores a las funciones de pivoteo, sin
embargo, se les seguirá dando mantenimiento puesto que son muy populares, <a href="https://tereom.github.io/tutoriales/datos_limpios.html">aquí</a> puedes encontrar
una versión de las notas usando que utilizan <code>gather()</code> y <code>spread()</code>.</p>
</div>
<div id="los-encabezados-de-las-columanas-son-valores" class="section level3 unnumbered">
<h3>Los encabezados de las columanas son valores</h3>
<p>Usaremos ejemplos para entender los conceptos más facilmente. Comenzaremos
con una tabla de datos que contiene las mediciones de partículas suspendidas
PM2.5 de la red automática de monitoreo atmosférico
(<a href="http://www.aire.cdmx.gob.mx">RAMA</a>) para los primeros meses del 2019.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw">library</span>(estcomp)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">pm25_<span class="dv">2019</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="co">#&gt; # A tibble: 5,088 x 26</span></a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="co">#&gt;    date        hour   AJM   AJU   BJU   CAM   CCA COY   FAR     GAM   HGM   INN</span></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb61-7" data-line-number="7"><span class="co">#&gt;  1 2019-01-01     1    19    35    62    90    66 NA    NA       NA    56    22</span></a>
<a class="sourceLine" id="cb61-8" data-line-number="8"><span class="co">#&gt;  2 2019-01-01     2    17    24    88   104    84 NA    NA       NA    61    14</span></a>
<a class="sourceLine" id="cb61-9" data-line-number="9"><span class="co">#&gt;  3 2019-01-01     3    14    20   107   140    95 NA    NA       NA    74     8</span></a>
<a class="sourceLine" id="cb61-10" data-line-number="10"><span class="co">#&gt;  4 2019-01-01     4     6    15   101   162    97 NA    NA       NA    90     9</span></a>
<a class="sourceLine" id="cb61-11" data-line-number="11"><span class="co">#&gt;  5 2019-01-01     5     4     8   121   133    88 NA    NA       NA    90     3</span></a>
<a class="sourceLine" id="cb61-12" data-line-number="12"><span class="co">#&gt;  6 2019-01-01     6     7     7    93   106    77 NA    NA       NA   106     3</span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13"><span class="co">#&gt;  7 2019-01-01     7    12     8    84    98    51 NA    NA       NA   115    NA</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"><span class="co">#&gt;  8 2019-01-01     8    15     7   101    82    39 NA    NA       NA    90    NA</span></a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="co">#&gt;  9 2019-01-01     9    24     3    89    54    26 NA    NA       NA    90    NA</span></a>
<a class="sourceLine" id="cb61-16" data-line-number="16"><span class="co">#&gt; 10 2019-01-01    10    24    NA    88    76    26 NA    NA       NA    99     2</span></a>
<a class="sourceLine" id="cb61-17" data-line-number="17"><span class="co">#&gt; # … with 5,078 more rows, and 14 more variables: MER &lt;dbl&gt;, MGH &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb61-18" data-line-number="18"><span class="co">#&gt; #   MON &lt;dbl&gt;, MPA &lt;lgl&gt;, NEZ &lt;dbl&gt;, PED &lt;dbl&gt;, SAC &lt;lgl&gt;, SAG &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb61-19" data-line-number="19"><span class="co">#&gt; #   SFE &lt;dbl&gt;, SJA &lt;lgl&gt;, TLA &lt;dbl&gt;, UAX &lt;dbl&gt;, UIZ &lt;dbl&gt;, XAL &lt;dbl&gt;</span></a></code></pre></div>
<p>¿Cuáles son las variables en estos datos?</p>
<p>Esta base de datos tiene 4 variables: fecha, hora, estación y medición
(en microgramos por metro cúbico <span class="math inline">\(\mu g/m^3\)</span>).</p>
<p>Al alargar los datos desaparecerán las columnas que se agrupan y darán
lugar a dos nuevas columnas: la correspondiente a estación y la
correspondiente a medición. Entonces, usamos la función <code>pivot_longer()</code> que
recibe los argumentos:</p>
<ul>
<li>data: <code>data.frame</code> que vamos a pivotear, alargar.<br />
</li>
<li>cols: columnas que vamos a pivotear (apilar), la
notación para seleccionarlas es <code>tidyselect</code>, la misma que usamos con <code>select()</code>
en <code>dplyr</code>.</li>
<li>names_to: nombre (<code>string</code>: en comillas “”) de la nueva columna que almacenará
los nombres de las columnas en los datos.<br />
</li>
<li>values_to: nombre (<code>string</code>: en comillas “”) de la nueva columna que
almacenará los valores en los datos.</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">pm25_<span class="dv">2019</span>_tidy &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(pm25_<span class="dv">2019</span>, <span class="dt">cols =</span> AJM<span class="op">:</span>XAL, <span class="dt">names_to =</span> <span class="st">&quot;station&quot;</span>, </a>
<a class="sourceLine" id="cb62-2" data-line-number="2">  <span class="dt">values_to =</span> <span class="st">&quot;measurement&quot;</span>)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3">pm25_<span class="dv">2019</span>_tidy</a>
<a class="sourceLine" id="cb62-4" data-line-number="4"><span class="co">#&gt; # A tibble: 122,112 x 4</span></a>
<a class="sourceLine" id="cb62-5" data-line-number="5"><span class="co">#&gt;    date        hour station measurement</span></a>
<a class="sourceLine" id="cb62-6" data-line-number="6"><span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb62-7" data-line-number="7"><span class="co">#&gt;  1 2019-01-01     1 AJM              19</span></a>
<a class="sourceLine" id="cb62-8" data-line-number="8"><span class="co">#&gt;  2 2019-01-01     1 AJU              35</span></a>
<a class="sourceLine" id="cb62-9" data-line-number="9"><span class="co">#&gt;  3 2019-01-01     1 BJU              62</span></a>
<a class="sourceLine" id="cb62-10" data-line-number="10"><span class="co">#&gt;  4 2019-01-01     1 CAM              90</span></a>
<a class="sourceLine" id="cb62-11" data-line-number="11"><span class="co">#&gt;  5 2019-01-01     1 CCA              66</span></a>
<a class="sourceLine" id="cb62-12" data-line-number="12"><span class="co">#&gt;  6 2019-01-01     1 COY              NA</span></a>
<a class="sourceLine" id="cb62-13" data-line-number="13"><span class="co">#&gt;  7 2019-01-01     1 FAR              NA</span></a>
<a class="sourceLine" id="cb62-14" data-line-number="14"><span class="co">#&gt;  8 2019-01-01     1 GAM              NA</span></a>
<a class="sourceLine" id="cb62-15" data-line-number="15"><span class="co">#&gt;  9 2019-01-01     1 HGM              56</span></a>
<a class="sourceLine" id="cb62-16" data-line-number="16"><span class="co">#&gt; 10 2019-01-01     1 INN              22</span></a>
<a class="sourceLine" id="cb62-17" data-line-number="17"><span class="co">#&gt; # … with 122,102 more rows</span></a></code></pre></div>
<p>Observemos que en la tabla original teníamos bajo la columna <em>AJM</em>, en el renglón
correspondiente a <em>2019-01-01</em> hora <em>1</em> un valor de 19, y podemos ver que este
valor en la tabla larga se almacena bajo la columna <em>measurement</em> y corresponde
a la estación <em>AJM</em>.</p>
<p>La nueva estructura de la base de datos nos permite, por ejemplo, hacer
fácilmente una gráfica donde podemos comparar las diferencias en las
frecuencias.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">pm25_<span class="dv">2019</span>_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb63-3" data-line-number="3">        <span class="dt">missing =</span> <span class="kw">is.na</span>(measurement), </a>
<a class="sourceLine" id="cb63-4" data-line-number="4">        <span class="dt">station =</span> <span class="kw">reorder</span>(station, missing, sum)</a>
<a class="sourceLine" id="cb63-5" data-line-number="5">        ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-6" data-line-number="6"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> hour, <span class="dt">fill =</span> <span class="kw">is.na</span>(measurement))) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_raster</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>station) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;faltante&quot;</span>, </a>
<a class="sourceLine" id="cb63-10" data-line-number="10">        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;TRUE&quot;</span> =<span class="st"> &quot;salmon&quot;</span>, <span class="st">&quot;FALSE&quot;</span> =<span class="st"> &quot;gray&quot;</span>))</a></code></pre></div>
<p><img src="02-manipulacion_files/figure-html/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Otro ejemplo, veamos los datos <code>df_edu</code>, ¿cuántas variables tenemos?</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">df_edu</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="co">#&gt; # A tibble: 7,371 x 16</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="co">#&gt;    state_code municipio_code region state_name state_abbr municipio_name sex  </span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb64-5" data-line-number="5"><span class="co">#&gt;  1 01         001            01001  Aguascali… AGS        Aguascalientes Total</span></a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="co">#&gt;  2 01         001            01001  Aguascali… AGS        Aguascalientes Homb…</span></a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="co">#&gt;  3 01         001            01001  Aguascali… AGS        Aguascalientes Muje…</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8"><span class="co">#&gt;  4 01         002            01002  Aguascali… AGS        Asientos       Total</span></a>
<a class="sourceLine" id="cb64-9" data-line-number="9"><span class="co">#&gt;  5 01         002            01002  Aguascali… AGS        Asientos       Homb…</span></a>
<a class="sourceLine" id="cb64-10" data-line-number="10"><span class="co">#&gt;  6 01         002            01002  Aguascali… AGS        Asientos       Muje…</span></a>
<a class="sourceLine" id="cb64-11" data-line-number="11"><span class="co">#&gt;  7 01         003            01003  Aguascali… AGS        Calvillo       Total</span></a>
<a class="sourceLine" id="cb64-12" data-line-number="12"><span class="co">#&gt;  8 01         003            01003  Aguascali… AGS        Calvillo       Homb…</span></a>
<a class="sourceLine" id="cb64-13" data-line-number="13"><span class="co">#&gt;  9 01         003            01003  Aguascali… AGS        Calvillo       Muje…</span></a>
<a class="sourceLine" id="cb64-14" data-line-number="14"><span class="co">#&gt; 10 01         004            01004  Aguascali… AGS        Cosío          Total</span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15"><span class="co">#&gt; # … with 7,361 more rows, and 9 more variables: pop_15 &lt;dbl&gt;, no_school &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16"><span class="co">#&gt; #   preschool &lt;dbl&gt;, elementary &lt;dbl&gt;, secondary &lt;dbl&gt;, highschool &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb64-17" data-line-number="17"><span class="co">#&gt; #   higher_edu &lt;dbl&gt;, other &lt;dbl&gt;, schoolyrs &lt;dbl&gt;</span></a></code></pre></div>
<p>Notemos que el nivel de escolaridad esta guardado en 6 columnas (preschool,
elementary, …, other), este tipo de almacenamiento <em>no es limpio</em> aunque
puede ser útil al momento de ingresar la información o para presentarla.</p>
<p>Para tener datos <em>limpios</em> apilamos los niveles de escolaridad de manera que
sea una sola columna (nuevamente alargamos los datos):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">df_edu_tidy &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">data =</span> df_edu, <span class="dt">cols =</span> preschool<span class="op">:</span>other, </a>
<a class="sourceLine" id="cb65-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="st">&quot;grade&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;percent&quot;</span>, <span class="dt">values_drop_na =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="kw">glimpse</span>(df_edu_tidy)</a>
<a class="sourceLine" id="cb65-4" data-line-number="4"><span class="co">#&gt; Observations: 44,226</span></a>
<a class="sourceLine" id="cb65-5" data-line-number="5"><span class="co">#&gt; Variables: 12</span></a>
<a class="sourceLine" id="cb65-6" data-line-number="6"><span class="co">#&gt; $ state_code     &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, …</span></a>
<a class="sourceLine" id="cb65-7" data-line-number="7"><span class="co">#&gt; $ municipio_code &lt;chr&gt; &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;…</span></a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="co">#&gt; $ region         &lt;chr&gt; &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, &quot;01001&quot;, …</span></a>
<a class="sourceLine" id="cb65-9" data-line-number="9"><span class="co">#&gt; $ state_name     &lt;chr&gt; &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, …</span></a>
<a class="sourceLine" id="cb65-10" data-line-number="10"><span class="co">#&gt; $ state_abbr     &lt;chr&gt; &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;, &quot;AGS&quot;…</span></a>
<a class="sourceLine" id="cb65-11" data-line-number="11"><span class="co">#&gt; $ municipio_name &lt;chr&gt; &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, …</span></a>
<a class="sourceLine" id="cb65-12" data-line-number="12"><span class="co">#&gt; $ sex            &lt;chr&gt; &quot;Total&quot;, &quot;Total&quot;, &quot;Total&quot;, &quot;Total&quot;, &quot;Total&quot;, &quot;Total&quot;, …</span></a>
<a class="sourceLine" id="cb65-13" data-line-number="13"><span class="co">#&gt; $ pop_15         &lt;dbl&gt; 631064, 631064, 631064, 631064, 631064, 631064, 301714…</span></a>
<a class="sourceLine" id="cb65-14" data-line-number="14"><span class="co">#&gt; $ no_school      &lt;dbl&gt; 2.662329, 2.662329, 2.662329, 2.662329, 2.662329, 2.66…</span></a>
<a class="sourceLine" id="cb65-15" data-line-number="15"><span class="co">#&gt; $ schoolyrs      &lt;dbl&gt; 10.211152, 10.211152, 10.211152, 10.211152, 10.211152,…</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16"><span class="co">#&gt; $ grade          &lt;chr&gt; &quot;preschool&quot;, &quot;elementary&quot;, &quot;secondary&quot;, &quot;highschool&quot;, …</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17"><span class="co">#&gt; $ percent        &lt;dbl&gt; 0.17335801, 20.15247265, 29.31144860, 23.31823714, 24.…</span></a></code></pre></div>
<p>El parámetro <code>values_drop_na = TRUE</code> se utiliza para eliminar los
renglones con valores faltantes en la columna de porcentaje, esto es, eliminamos
aquellas observaciones que tenían <code>NA</code> en la columnas de nivel de escolaridad de
la tabla ancha. En este caso optamos por que los faltantes sean implícitos, la
conveniencia de tenerlos implícitos/explícitos dependerá de la aplicación.</p>
<p>Con los datos limpios es facil hacer manipulaciones y grfiacs, ¿cómo habrían
hecho la siguiente gráfica antes de la limpieza?</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">df_edu_cdmx &lt;-<span class="st"> </span>df_edu_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="st">    </span><span class="kw">filter</span>(state_abbr <span class="op">==</span><span class="st"> &quot;CDMX&quot;</span>, sex <span class="op">!=</span><span class="st"> &quot;Total&quot;</span>, grade <span class="op">!=</span><span class="st"> &quot;other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">municipio_name =</span> <span class="kw">reorder</span>(municipio_name, percent, last))</a>
<a class="sourceLine" id="cb66-4" data-line-number="4"></a>
<a class="sourceLine" id="cb66-5" data-line-number="5"><span class="kw">ggplot</span>(df_edu_cdmx, <span class="kw">aes</span>(<span class="dt">x =</span> grade, </a>
<a class="sourceLine" id="cb66-6" data-line-number="6">    <span class="dt">y =</span> percent, <span class="dt">group =</span> sex, <span class="dt">color =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>municipio_name) <span class="op">+</span></a>
<a class="sourceLine" id="cb66-9" data-line-number="9"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">60</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb66-10" data-line-number="10"><span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;preschool&quot;</span>, <span class="st">&quot;elementary&quot;</span>, </a>
<a class="sourceLine" id="cb66-11" data-line-number="11">        <span class="st">&quot;secondary&quot;</span>, <span class="st">&quot;highschool&quot;</span>, <span class="st">&quot;higher_edu&quot;</span>))</a></code></pre></div>
<p><img src="02-manipulacion_files/figure-html/unnamed-chunk-57-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="una-columna-asociada-a-más-de-una-variable" class="section level3 unnumbered">
<h3>Una columna asociada a más de una variable</h3>
<p>Utilizaremos un subconjunto de los datos de la prueba ENLACE a nivel primaria,
la prueba <a href="http://www.enlace.sep.gob.mx/ba/">ENLACE</a> evaluaba a todos los
alumnos de tercero a sexto de primaria y a los alumnos de secundaria del país en
3 áreas: <em>español</em>, <em>matemáticas</em> y <em>formación cívica y ética</em>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;enlacep_2013&quot;</span>)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">enlacep_sub_<span class="dv">2013</span> &lt;-<span class="st"> </span>enlacep_<span class="dv">2013</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="st">    </span><span class="kw">select</span>(CVE_ENT<span class="op">:</span>PUNT_FCE_<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="st">    </span><span class="kw">sample_n</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb67-5" data-line-number="5"><span class="kw">glimpse</span>(enlacep_sub_<span class="dv">2013</span>)</a>
<a class="sourceLine" id="cb67-6" data-line-number="6"><span class="co">#&gt; Observations: 1,000</span></a>
<a class="sourceLine" id="cb67-7" data-line-number="7"><span class="co">#&gt; Variables: 22</span></a>
<a class="sourceLine" id="cb67-8" data-line-number="8"><span class="co">#&gt; $ CVE_ENT    &lt;chr&gt; &quot;07&quot;, &quot;04&quot;, &quot;19&quot;, &quot;12&quot;, &quot;12&quot;, &quot;14&quot;, &quot;17&quot;, &quot;31&quot;, &quot;12&quot;, &quot;07&quot;…</span></a>
<a class="sourceLine" id="cb67-9" data-line-number="9"><span class="co">#&gt; $ NOM_ENT    &lt;chr&gt; &quot;CHIAPAS&quot;, &quot;CAMPECHE&quot;, &quot;NUEVO LEON&quot;, &quot;GUERRERO&quot;, &quot;GUERRERO…</span></a>
<a class="sourceLine" id="cb67-10" data-line-number="10"><span class="co">#&gt; $ CCT        &lt;chr&gt; &quot;07DPR0144M&quot;, &quot;04KPR0241A&quot;, &quot;19DPR1279M&quot;, &quot;12KPR0662S&quot;, &quot;1…</span></a>
<a class="sourceLine" id="cb67-11" data-line-number="11"><span class="co">#&gt; $ TURNO      &lt;chr&gt; &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;…</span></a>
<a class="sourceLine" id="cb67-12" data-line-number="12"><span class="co">#&gt; $ ESCUELA    &lt;chr&gt; &quot;ESCUADRON 201&quot;, &quot;EL TAZIZTAL&quot;, &quot;CORREGIDORA DE QUERETARO&quot;…</span></a>
<a class="sourceLine" id="cb67-13" data-line-number="13"><span class="co">#&gt; $ TIPO       &lt;chr&gt; &quot;GENERAL&quot;, &quot;CONAFE&quot;, &quot;GENERAL&quot;, &quot;CONAFE&quot;, &quot;PARTICULAR&quot;, &quot;G…</span></a>
<a class="sourceLine" id="cb67-14" data-line-number="14"><span class="co">#&gt; $ CVE_MUN    &lt;chr&gt; &quot;046&quot;, &quot;011&quot;, &quot;021&quot;, &quot;048&quot;, &quot;001&quot;, &quot;059&quot;, &quot;022&quot;, &quot;050&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb67-15" data-line-number="15"><span class="co">#&gt; $ NOM_MUN    &lt;chr&gt; &quot;JIQUIPILAS&quot;, &quot;CANDELARIA&quot;, &quot;GENERAL ESCOBEDO&quot;, &quot;PETATLAN&quot;…</span></a>
<a class="sourceLine" id="cb67-16" data-line-number="16"><span class="co">#&gt; $ CVE_LOC    &lt;chr&gt; &quot;0103&quot;, &quot;0638&quot;, &quot;0001&quot;, &quot;0160&quot;, &quot;0001&quot;, &quot;0028&quot;, &quot;0002&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb67-17" data-line-number="17"><span class="co">#&gt; $ NOM_LOC    &lt;chr&gt; &quot;TIERRA Y LIBERTAD&quot;, &quot;TACISTAL&quot;, &quot;CIUDAD GENERAL ESCOBEDO&quot;…</span></a>
<a class="sourceLine" id="cb67-18" data-line-number="18"><span class="co">#&gt; $ PUNT_ESP_3 &lt;dbl&gt; 722, 424, 568, 514, 581, 494, 593, 506, 681, 438, 515, 630…</span></a>
<a class="sourceLine" id="cb67-19" data-line-number="19"><span class="co">#&gt; $ PUNT_MAT_3 &lt;dbl&gt; 786, 437, 619, 481, 636, 542, 649, 533, 789, 459, 556, 661…</span></a>
<a class="sourceLine" id="cb67-20" data-line-number="20"><span class="co">#&gt; $ PUNT_FCE_3 &lt;dbl&gt; 643, 407, 532, 439, 495, 465, 541, 466, 576, 428, 452, 594…</span></a>
<a class="sourceLine" id="cb67-21" data-line-number="21"><span class="co">#&gt; $ PUNT_ESP_4 &lt;dbl&gt; 645, 472, 527, 542, 453, 597, 632, 565, 566, 410, 517, 533…</span></a>
<a class="sourceLine" id="cb67-22" data-line-number="22"><span class="co">#&gt; $ PUNT_MAT_4 &lt;dbl&gt; 695, 473, 502, 572, 478, 595, 676, 589, 666, 400, 564, 599…</span></a>
<a class="sourceLine" id="cb67-23" data-line-number="23"><span class="co">#&gt; $ PUNT_FCE_4 &lt;dbl&gt; 621, 444, 482, 499, 429, 495, 555, 498, 549, 421, 452, 487…</span></a>
<a class="sourceLine" id="cb67-24" data-line-number="24"><span class="co">#&gt; $ PUNT_ESP_5 &lt;dbl&gt; 718, 311, 585, NA, 503, 496, 600, 549, 547, 511, 549, 664,…</span></a>
<a class="sourceLine" id="cb67-25" data-line-number="25"><span class="co">#&gt; $ PUNT_MAT_5 &lt;dbl&gt; 807, 347, 638, NA, 485, 525, 629, 562, 525, 518, 612, 634,…</span></a>
<a class="sourceLine" id="cb67-26" data-line-number="26"><span class="co">#&gt; $ PUNT_FCE_5 &lt;dbl&gt; 679, 380, 499, NA, 497, 488, 547, 498, 512, 536, 487, 618,…</span></a>
<a class="sourceLine" id="cb67-27" data-line-number="27"><span class="co">#&gt; $ PUNT_ESP_6 &lt;dbl&gt; 629, 381, 575, 408, 472, NA, 547, 594, 413, 390, 469, 571,…</span></a>
<a class="sourceLine" id="cb67-28" data-line-number="28"><span class="co">#&gt; $ PUNT_MAT_6 &lt;dbl&gt; 804, 351, 598, 477, 480, NA, 841, 607, 493, 444, 624, 574,…</span></a>
<a class="sourceLine" id="cb67-29" data-line-number="29"><span class="co">#&gt; $ PUNT_FCE_6 &lt;dbl&gt; 554, 451, 544, 432, 461, NA, 572, 523, 445, 400, 405, 485,…</span></a></code></pre></div>
<p><img src="img/manicule2.jpg" /> ¿Cuántas variables tiene este subconjunto de los datos?</p>
<ul>
<li><p>De manera similar a los ejemplos anteriores,
utiliza la función <code>pivot_longer</code> para apilar las columnas correspondientes a
área-grado.</p></li>
<li><p>Piensa en como podemos separar la “variable” área-grado en dos columnas.</p></li>
</ul>
<p>Ahora separaremos las variables área y grado de la columna <code>AREA_GRADO</code>,
para ello debemos pasar a la función <code>separate()</code>, esta recibe como parámetros:</p>
<ul>
<li><p>el nombre de la base de datos,</p></li>
<li><p>el nombre de la variable que deseamos separar en más de una,</p></li>
<li><p>la posición de donde deseamos “cortar” (hay más opciones para especificar
como separar, ver <code>?separate</code>). El default es separar valores en todos los
lugares que encuentre un caracter que no es alfanumérico (espacio, guión,…).</p></li>
</ul>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">enlacep_tidy &lt;-<span class="st"> </span><span class="kw">separate</span>(<span class="dt">data =</span> enlacep_long, <span class="dt">col =</span> AREA_GRADO, </a>
<a class="sourceLine" id="cb68-2" data-line-number="2">    <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;AREA&quot;</span>, <span class="st">&quot;GRADO&quot;</span>), <span class="dt">sep =</span> <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">enlacep_tidy</a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="co">#&gt; # A tibble: 12,000 x 13</span></a>
<a class="sourceLine" id="cb68-5" data-line-number="5"><span class="co">#&gt;    CVE_ENT NOM_ENT CCT   TURNO ESCUELA TIPO  CVE_MUN NOM_MUN CVE_LOC NOM_LOC</span></a>
<a class="sourceLine" id="cb68-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb68-7" data-line-number="7"><span class="co">#&gt;  1 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-8" data-line-number="8"><span class="co">#&gt;  2 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-9" data-line-number="9"><span class="co">#&gt;  3 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-10" data-line-number="10"><span class="co">#&gt;  4 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-11" data-line-number="11"><span class="co">#&gt;  5 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-12" data-line-number="12"><span class="co">#&gt;  6 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-13" data-line-number="13"><span class="co">#&gt;  7 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-14" data-line-number="14"><span class="co">#&gt;  8 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-15" data-line-number="15"><span class="co">#&gt;  9 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-16" data-line-number="16"><span class="co">#&gt; 10 07      CHIAPAS 07DP… MATU… ESCUAD… GENE… 046     JIQUIP… 0103    TIERRA…</span></a>
<a class="sourceLine" id="cb68-17" data-line-number="17"><span class="co">#&gt; # … with 11,990 more rows, and 3 more variables: AREA &lt;chr&gt;, GRADO &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb68-18" data-line-number="18"><span class="co">#&gt; #   PUNTAJE &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb68-19" data-line-number="19"></a>
<a class="sourceLine" id="cb68-20" data-line-number="20"><span class="co"># creamos un mejor código de área</span></a>
<a class="sourceLine" id="cb68-21" data-line-number="21">enlacep_tidy &lt;-<span class="st"> </span>enlacep_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-22" data-line-number="22"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb68-23" data-line-number="23">        <span class="dt">AREA =</span> <span class="kw">substr</span>(AREA, <span class="dv">6</span>, <span class="dv">8</span>),</a>
<a class="sourceLine" id="cb68-24" data-line-number="24">        <span class="dt">GRADO =</span> <span class="kw">as.numeric</span>(GRADO)</a>
<a class="sourceLine" id="cb68-25" data-line-number="25">        ) </a>
<a class="sourceLine" id="cb68-26" data-line-number="26"><span class="kw">glimpse</span>(enlacep_tidy)</a>
<a class="sourceLine" id="cb68-27" data-line-number="27"><span class="co">#&gt; Observations: 12,000</span></a>
<a class="sourceLine" id="cb68-28" data-line-number="28"><span class="co">#&gt; Variables: 13</span></a>
<a class="sourceLine" id="cb68-29" data-line-number="29"><span class="co">#&gt; $ CVE_ENT &lt;chr&gt; &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb68-30" data-line-number="30"><span class="co">#&gt; $ NOM_ENT &lt;chr&gt; &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAP…</span></a>
<a class="sourceLine" id="cb68-31" data-line-number="31"><span class="co">#&gt; $ CCT     &lt;chr&gt; &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DP…</span></a>
<a class="sourceLine" id="cb68-32" data-line-number="32"><span class="co">#&gt; $ TURNO   &lt;chr&gt; &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb68-33" data-line-number="33"><span class="co">#&gt; $ ESCUELA &lt;chr&gt; &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON…</span></a>
<a class="sourceLine" id="cb68-34" data-line-number="34"><span class="co">#&gt; $ TIPO    &lt;chr&gt; &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENER…</span></a>
<a class="sourceLine" id="cb68-35" data-line-number="35"><span class="co">#&gt; $ CVE_MUN &lt;chr&gt; &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;…</span></a>
<a class="sourceLine" id="cb68-36" data-line-number="36"><span class="co">#&gt; $ NOM_MUN &lt;chr&gt; &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQU…</span></a>
<a class="sourceLine" id="cb68-37" data-line-number="37"><span class="co">#&gt; $ CVE_LOC &lt;chr&gt; &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103…</span></a>
<a class="sourceLine" id="cb68-38" data-line-number="38"><span class="co">#&gt; $ NOM_LOC &lt;chr&gt; &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;…</span></a>
<a class="sourceLine" id="cb68-39" data-line-number="39"><span class="co">#&gt; $ AREA    &lt;chr&gt; &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;…</span></a>
<a class="sourceLine" id="cb68-40" data-line-number="40"><span class="co">#&gt; $ GRADO   &lt;dbl&gt; 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 3, 3, 3, 4, 4, 4, 5, 5, 5…</span></a>
<a class="sourceLine" id="cb68-41" data-line-number="41"><span class="co">#&gt; $ PUNTAJE &lt;dbl&gt; 722, 786, 643, 645, 695, 621, 718, 807, 679, 629, 804, 554, 4…</span></a></code></pre></div>
<p>Conforme nos habituemos a las funciones podemos sacar provecho de sus
argumentos adicionales:</p>
<ul>
<li><code>names_prefix</code>: recibe una expresión regular para eliminar el texto que
coincida del inicio de una variable.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">pivot_longer</span>(enlacep_sub_<span class="dv">2013</span>, <span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;PUNT&quot;</span>), </a>
<a class="sourceLine" id="cb69-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;AREA_GRADO&quot;</span>), <span class="dt">values_to =</span> <span class="st">&quot;PUNTAJE&quot;</span>, </a>
<a class="sourceLine" id="cb69-3" data-line-number="3">  <span class="dt">names_prefix =</span> <span class="st">&quot;PUNT_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb69-5" data-line-number="5"><span class="co">#&gt; Observations: 12,000</span></a>
<a class="sourceLine" id="cb69-6" data-line-number="6"><span class="co">#&gt; Variables: 12</span></a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="co">#&gt; $ CVE_ENT    &lt;chr&gt; &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;…</span></a>
<a class="sourceLine" id="cb69-8" data-line-number="8"><span class="co">#&gt; $ NOM_ENT    &lt;chr&gt; &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CH…</span></a>
<a class="sourceLine" id="cb69-9" data-line-number="9"><span class="co">#&gt; $ CCT        &lt;chr&gt; &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb69-10" data-line-number="10"><span class="co">#&gt; $ TURNO      &lt;chr&gt; &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;…</span></a>
<a class="sourceLine" id="cb69-11" data-line-number="11"><span class="co">#&gt; $ ESCUELA    &lt;chr&gt; &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUAD…</span></a>
<a class="sourceLine" id="cb69-12" data-line-number="12"><span class="co">#&gt; $ TIPO       &lt;chr&gt; &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GE…</span></a>
<a class="sourceLine" id="cb69-13" data-line-number="13"><span class="co">#&gt; $ CVE_MUN    &lt;chr&gt; &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb69-14" data-line-number="14"><span class="co">#&gt; $ NOM_MUN    &lt;chr&gt; &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;J…</span></a>
<a class="sourceLine" id="cb69-15" data-line-number="15"><span class="co">#&gt; $ CVE_LOC    &lt;chr&gt; &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb69-16" data-line-number="16"><span class="co">#&gt; $ NOM_LOC    &lt;chr&gt; &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERT…</span></a>
<a class="sourceLine" id="cb69-17" data-line-number="17"><span class="co">#&gt; $ AREA_GRADO &lt;chr&gt; &quot;ESP_3&quot;, &quot;MAT_3&quot;, &quot;FCE_3&quot;, &quot;ESP_4&quot;, &quot;MAT_4&quot;, &quot;FCE_4&quot;, &quot;ESP…</span></a>
<a class="sourceLine" id="cb69-18" data-line-number="18"><span class="co">#&gt; $ PUNTAJE    &lt;dbl&gt; 722, 786, 643, 645, 695, 621, 718, 807, 679, 629, 804, 554…</span></a></code></pre></div>
<ul>
<li><code>names_sep</code>: nos permite hacer el pivoteo y separar en una misma operación,
en este caso <code>names_to</code> consiste en un vector con más de una entrada y
<code>names_sep</code> indica como separar el nombre de las columnas.</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">pivot_longer</span>(enlacep_sub_<span class="dv">2013</span>, <span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;PUNT&quot;</span>), </a>
<a class="sourceLine" id="cb70-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;AREA&quot;</span>, <span class="st">&quot;GRADO&quot;</span>), <span class="dt">values_to =</span> <span class="st">&quot;PUNTAJE&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;PUNT_&quot;</span>, </a>
<a class="sourceLine" id="cb70-3" data-line-number="3">  <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="co">#&gt; Observations: 12,000</span></a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="co">#&gt; Variables: 13</span></a>
<a class="sourceLine" id="cb70-7" data-line-number="7"><span class="co">#&gt; $ CVE_ENT &lt;chr&gt; &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="co">#&gt; $ NOM_ENT &lt;chr&gt; &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAP…</span></a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="co">#&gt; $ CCT     &lt;chr&gt; &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DP…</span></a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="co">#&gt; $ TURNO   &lt;chr&gt; &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb70-11" data-line-number="11"><span class="co">#&gt; $ ESCUELA &lt;chr&gt; &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON…</span></a>
<a class="sourceLine" id="cb70-12" data-line-number="12"><span class="co">#&gt; $ TIPO    &lt;chr&gt; &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENER…</span></a>
<a class="sourceLine" id="cb70-13" data-line-number="13"><span class="co">#&gt; $ CVE_MUN &lt;chr&gt; &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;…</span></a>
<a class="sourceLine" id="cb70-14" data-line-number="14"><span class="co">#&gt; $ NOM_MUN &lt;chr&gt; &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQU…</span></a>
<a class="sourceLine" id="cb70-15" data-line-number="15"><span class="co">#&gt; $ CVE_LOC &lt;chr&gt; &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103…</span></a>
<a class="sourceLine" id="cb70-16" data-line-number="16"><span class="co">#&gt; $ NOM_LOC &lt;chr&gt; &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;…</span></a>
<a class="sourceLine" id="cb70-17" data-line-number="17"><span class="co">#&gt; $ AREA    &lt;chr&gt; &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;…</span></a>
<a class="sourceLine" id="cb70-18" data-line-number="18"><span class="co">#&gt; $ GRADO   &lt;chr&gt; &quot;3&quot;, &quot;3&quot;, &quot;3&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;5&quot;, &quot;5&quot;, &quot;5&quot;, &quot;6&quot;, &quot;6&quot;, &quot;6&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb70-19" data-line-number="19"><span class="co">#&gt; $ PUNTAJE &lt;dbl&gt; 722, 786, 643, 645, 695, 621, 718, 807, 679, 629, 804, 554, 4…</span></a></code></pre></div>
<ul>
<li><code>names_pattern</code>: similar a <code>names_sep</code> pero recibe una expresión regular.</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">pivot_longer</span>(enlacep_sub_<span class="dv">2013</span>, <span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;PUNT&quot;</span>), </a>
<a class="sourceLine" id="cb71-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;AREA&quot;</span>, <span class="st">&quot;GRADO&quot;</span>), <span class="dt">names_pattern =</span> <span class="st">&quot;PUNT_?(.*)_(.*)&quot;</span>, </a>
<a class="sourceLine" id="cb71-3" data-line-number="3">  <span class="dt">values_to =</span> <span class="st">&quot;PUNTAJE&quot;</span>)</a></code></pre></div>
<ul>
<li><code>names_ptypes, values_ptypes</code>: permiten especificar el tipo de las nuevas
columnas.</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw">pivot_longer</span>(enlacep_sub_<span class="dv">2013</span>, <span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;PUNT&quot;</span>), </a>
<a class="sourceLine" id="cb72-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;AREA&quot;</span>, <span class="st">&quot;GRADO&quot;</span>), <span class="dt">values_to =</span> <span class="st">&quot;PUNTAJE&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;PUNT_&quot;</span>, </a>
<a class="sourceLine" id="cb72-3" data-line-number="3">  <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">names_ptypes =</span> <span class="kw">list</span>(<span class="dt">GRADO =</span> <span class="kw">integer</span>())) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb72-5" data-line-number="5"><span class="co">#&gt; Observations: 12,000</span></a>
<a class="sourceLine" id="cb72-6" data-line-number="6"><span class="co">#&gt; Variables: 13</span></a>
<a class="sourceLine" id="cb72-7" data-line-number="7"><span class="co">#&gt; $ CVE_ENT &lt;chr&gt; &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;07&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb72-8" data-line-number="8"><span class="co">#&gt; $ NOM_ENT &lt;chr&gt; &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAPAS&quot;, &quot;CHIAP…</span></a>
<a class="sourceLine" id="cb72-9" data-line-number="9"><span class="co">#&gt; $ CCT     &lt;chr&gt; &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DPR0144M&quot;, &quot;07DP…</span></a>
<a class="sourceLine" id="cb72-10" data-line-number="10"><span class="co">#&gt; $ TURNO   &lt;chr&gt; &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;MATUTINO&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb72-11" data-line-number="11"><span class="co">#&gt; $ ESCUELA &lt;chr&gt; &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON 201&quot;, &quot;ESCUADRON…</span></a>
<a class="sourceLine" id="cb72-12" data-line-number="12"><span class="co">#&gt; $ TIPO    &lt;chr&gt; &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENERAL&quot;, &quot;GENER…</span></a>
<a class="sourceLine" id="cb72-13" data-line-number="13"><span class="co">#&gt; $ CVE_MUN &lt;chr&gt; &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;, &quot;046&quot;…</span></a>
<a class="sourceLine" id="cb72-14" data-line-number="14"><span class="co">#&gt; $ NOM_MUN &lt;chr&gt; &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQUIPILAS&quot;, &quot;JIQU…</span></a>
<a class="sourceLine" id="cb72-15" data-line-number="15"><span class="co">#&gt; $ CVE_LOC &lt;chr&gt; &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103&quot;, &quot;0103…</span></a>
<a class="sourceLine" id="cb72-16" data-line-number="16"><span class="co">#&gt; $ NOM_LOC &lt;chr&gt; &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;, &quot;TIERRA Y LIBERTAD&quot;…</span></a>
<a class="sourceLine" id="cb72-17" data-line-number="17"><span class="co">#&gt; $ AREA    &lt;chr&gt; &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;, &quot;ESP&quot;, &quot;MAT&quot;, &quot;FCE&quot;…</span></a>
<a class="sourceLine" id="cb72-18" data-line-number="18"><span class="co">#&gt; $ GRADO   &lt;int&gt; 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 3, 3, 3, 4, 4, 4, 5, 5, 5…</span></a>
<a class="sourceLine" id="cb72-19" data-line-number="19"><span class="co">#&gt; $ PUNTAJE &lt;dbl&gt; 722, 786, 643, 645, 695, 621, 718, 807, 679, 629, 804, 554, 4…</span></a></code></pre></div>
</div>
<div id="variables-almacenadas-en-filas-y-columnas" class="section level3 unnumbered">
<h3>Variables almacenadas en filas y columnas</h3>
<p>El problema más difícil es cuando las variables están tanto en filas como en
columnas, veamos una base de datos de fertilidad. ¿Cuáles son las
variables en estos datos?</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;df_fertility&quot;</span>)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">df_fertility</a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="co">#&gt; # A tibble: 306 x 11</span></a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="co">#&gt;    state size_localidad est   age_15_19 age_20_24 age_25_29 age_30_34 age_35_39</span></a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb73-6" data-line-number="6"><span class="co">#&gt;  1 01 A… Menos de 2 50… Valor     74.2     175.      175.      102.       59.0 </span></a>
<a class="sourceLine" id="cb73-7" data-line-number="7"><span class="co">#&gt;  2 01 A… Menos de 2 50… Erro…      6.71     11.0       9.35      8.05      7.29</span></a>
<a class="sourceLine" id="cb73-8" data-line-number="8"><span class="co">#&gt;  3 01 A… 2 500-14 999 … Valor     82.5     171.      140.      103.       72.0 </span></a>
<a class="sourceLine" id="cb73-9" data-line-number="9"><span class="co">#&gt;  4 01 A… 2 500-14 999 … Erro…      9.79     12.5      10.4       8.76      9.08</span></a>
<a class="sourceLine" id="cb73-10" data-line-number="10"><span class="co">#&gt;  5 01 A… 15 000-49 999… Valor     72.6     146.      147.       99.0      58.7 </span></a>
<a class="sourceLine" id="cb73-11" data-line-number="11"><span class="co">#&gt;  6 01 A… 15 000-49 999… Erro…      7.07     10.8      10.5       8.11      7.37</span></a>
<a class="sourceLine" id="cb73-12" data-line-number="12"><span class="co">#&gt;  7 01 A… 100 000 y más… Valor     66.3     120.      102.       84.2      53.9 </span></a>
<a class="sourceLine" id="cb73-13" data-line-number="13"><span class="co">#&gt;  8 01 A… 100 000 y más… Erro…      7.57      8.66      8.98      8.59      6.61</span></a>
<a class="sourceLine" id="cb73-14" data-line-number="14"><span class="co">#&gt;  9 02 B… Menos de 2 50… Valor     89.6     158.      117.       86.0      42.0 </span></a>
<a class="sourceLine" id="cb73-15" data-line-number="15"><span class="co">#&gt; 10 02 B… Menos de 2 50… Erro…     15.8      17.2      13.2      12.3       9.64</span></a>
<a class="sourceLine" id="cb73-16" data-line-number="16"><span class="co">#&gt; # … with 296 more rows, and 3 more variables: age_40_44 &lt;dbl&gt;, age_45_49 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb73-17" data-line-number="17"><span class="co">#&gt; #   global &lt;dbl&gt;</span></a></code></pre></div>
<p>Estos datos tienen variables en columnas individuales (state, size_localidad),
en múltiples columnas (grupo de edad, age_15_19,..) y en filas (Valor y
Error estándar).</p>
<p>Comencemos por apilar las columnas.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">fertility_long &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(df_fertility, <span class="dt">cols =</span> age_<span class="dv">15</span>_<span class="dv">19</span><span class="op">:</span>global, </a>
<a class="sourceLine" id="cb74-2" data-line-number="2">  <span class="dt">names_to =</span> <span class="st">&quot;age_bracket&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;age_&quot;</span>)</a>
<a class="sourceLine" id="cb74-3" data-line-number="3">fertility_long</a>
<a class="sourceLine" id="cb74-4" data-line-number="4"><span class="co">#&gt; # A tibble: 2,448 x 5</span></a>
<a class="sourceLine" id="cb74-5" data-line-number="5"><span class="co">#&gt;    state             size_localidad            est            age_bracket  value</span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;             &lt;chr&gt;                     &lt;chr&gt;          &lt;chr&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb74-7" data-line-number="7"><span class="co">#&gt;  1 01 Aguascalientes Menos de 2 500 habitantes Valor          15_19        74.2 </span></a>
<a class="sourceLine" id="cb74-8" data-line-number="8"><span class="co">#&gt;  2 01 Aguascalientes Menos de 2 500 habitantes Valor          20_24       175.  </span></a>
<a class="sourceLine" id="cb74-9" data-line-number="9"><span class="co">#&gt;  3 01 Aguascalientes Menos de 2 500 habitantes Valor          25_29       175.  </span></a>
<a class="sourceLine" id="cb74-10" data-line-number="10"><span class="co">#&gt;  4 01 Aguascalientes Menos de 2 500 habitantes Valor          30_34       102.  </span></a>
<a class="sourceLine" id="cb74-11" data-line-number="11"><span class="co">#&gt;  5 01 Aguascalientes Menos de 2 500 habitantes Valor          35_39        59.0 </span></a>
<a class="sourceLine" id="cb74-12" data-line-number="12"><span class="co">#&gt;  6 01 Aguascalientes Menos de 2 500 habitantes Valor          40_44        23.0 </span></a>
<a class="sourceLine" id="cb74-13" data-line-number="13"><span class="co">#&gt;  7 01 Aguascalientes Menos de 2 500 habitantes Valor          45_49         4.49</span></a>
<a class="sourceLine" id="cb74-14" data-line-number="14"><span class="co">#&gt;  8 01 Aguascalientes Menos de 2 500 habitantes Valor          global        3.06</span></a>
<a class="sourceLine" id="cb74-15" data-line-number="15"><span class="co">#&gt;  9 01 Aguascalientes Menos de 2 500 habitantes Error estándar 15_19         6.71</span></a>
<a class="sourceLine" id="cb74-16" data-line-number="16"><span class="co">#&gt; 10 01 Aguascalientes Menos de 2 500 habitantes Error estándar 20_24        11.0 </span></a>
<a class="sourceLine" id="cb74-17" data-line-number="17"><span class="co">#&gt; # … with 2,438 more rows</span></a></code></pre></div>
<p>Podemos crear algunas variables adicionales.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">fertility_vars &lt;-<span class="st"> </span>fertility_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">        <span class="dt">state_code =</span> <span class="kw">str_sub</span>(state, <span class="dv">1</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb75-4" data-line-number="4">        <span class="dt">state_name =</span> <span class="kw">str_sub</span>(state, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb75-5" data-line-number="5">        ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-6" data-line-number="6"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>state)</a>
<a class="sourceLine" id="cb75-7" data-line-number="7">fertility_vars</a>
<a class="sourceLine" id="cb75-8" data-line-number="8"><span class="co">#&gt; # A tibble: 2,448 x 6</span></a>
<a class="sourceLine" id="cb75-9" data-line-number="9"><span class="co">#&gt;    size_localidad         est         age_bracket  value state_code state_name  </span></a>
<a class="sourceLine" id="cb75-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt;                  &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb75-11" data-line-number="11"><span class="co">#&gt;  1 Menos de 2 500 habita… Valor       15_19        74.2  01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-12" data-line-number="12"><span class="co">#&gt;  2 Menos de 2 500 habita… Valor       20_24       175.   01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-13" data-line-number="13"><span class="co">#&gt;  3 Menos de 2 500 habita… Valor       25_29       175.   01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-14" data-line-number="14"><span class="co">#&gt;  4 Menos de 2 500 habita… Valor       30_34       102.   01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-15" data-line-number="15"><span class="co">#&gt;  5 Menos de 2 500 habita… Valor       35_39        59.0  01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-16" data-line-number="16"><span class="co">#&gt;  6 Menos de 2 500 habita… Valor       40_44        23.0  01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-17" data-line-number="17"><span class="co">#&gt;  7 Menos de 2 500 habita… Valor       45_49         4.49 01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-18" data-line-number="18"><span class="co">#&gt;  8 Menos de 2 500 habita… Valor       global        3.06 01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-19" data-line-number="19"><span class="co">#&gt;  9 Menos de 2 500 habita… Error está… 15_19         6.71 01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-20" data-line-number="20"><span class="co">#&gt; 10 Menos de 2 500 habita… Error está… 20_24        11.0  01         Aguascalien…</span></a>
<a class="sourceLine" id="cb75-21" data-line-number="21"><span class="co">#&gt; # … with 2,438 more rows</span></a></code></pre></div>
<p>Finalmente, la columna <em>est</em> no es una variable, sino que almacena el nombre
de 2 variables: <em>Valor</em> y <em>Error Estándar</em> la operación que debemos aplicar
(<code>pivot_wider()</code>) es el inverso de apilar (<code>pivot_longer</code>), sus argumentos son:</p>
<ul>
<li>data: <code>data.frame</code> que vamos a pivotear.<br />
</li>
<li>names_from: nombre o nombres de las columnas (sin comillas) de los cuáles
obtendremos los nombres de las nuevas columnas.</li>
<li>values_from: nombre o nombres de las columnas (sin comillas) de los cuáles
obtendremos los valores que llenarán las nuevas columnas.</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">fertility_tidy &lt;-<span class="st"> </span><span class="kw">pivot_wider</span>(fertility_vars, <span class="dt">names_from =</span> est, </a>
<a class="sourceLine" id="cb76-2" data-line-number="2">  <span class="dt">values_from =</span> value)</a></code></pre></div>
<p>Y podemos mejorar los nombres de las columnas, una opción rápida es usar el paquete janitor.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">fertility_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="st">    </span>janitor<span class="op">::</span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="st">    </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb77-4" data-line-number="4"><span class="co">#&gt; Observations: 1,224</span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5"><span class="co">#&gt; Variables: 6</span></a>
<a class="sourceLine" id="cb77-6" data-line-number="6"><span class="co">#&gt; $ size_localidad &lt;chr&gt; &quot;Menos de 2 500 habitantes&quot;, &quot;Menos de 2 500 habitante…</span></a>
<a class="sourceLine" id="cb77-7" data-line-number="7"><span class="co">#&gt; $ age_bracket    &lt;chr&gt; &quot;15_19&quot;, &quot;20_24&quot;, &quot;25_29&quot;, &quot;30_34&quot;, &quot;35_39&quot;, &quot;40_44&quot;, …</span></a>
<a class="sourceLine" id="cb77-8" data-line-number="8"><span class="co">#&gt; $ state_code     &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, &quot;01&quot;, …</span></a>
<a class="sourceLine" id="cb77-9" data-line-number="9"><span class="co">#&gt; $ state_name     &lt;chr&gt; &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, &quot;Aguascalientes&quot;, …</span></a>
<a class="sourceLine" id="cb77-10" data-line-number="10"><span class="co">#&gt; $ valor          &lt;dbl&gt; 74.2032276, 175.0281396, 174.5274362, 101.5836230, 58.…</span></a>
<a class="sourceLine" id="cb77-11" data-line-number="11"><span class="co">#&gt; $ error_estandar &lt;dbl&gt; 6.70671255, 11.00329648, 9.34594033, 8.04764573, 7.286…</span></a></code></pre></div>
<p>o podemos hacerlo manualmente</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">names</span>(fertility_tidy)[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;est&quot;</span>, <span class="st">&quot;std_error&quot;</span>)</a></code></pre></div>
<p>Ahora es inmediato no solo hacer gráficas sino también ajustar un modelo.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># ajustamos un modelo lineal donde la variable respuesta es temperatura </span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="co"># máxima, y la variable explicativa es el mes</span></a>
<a class="sourceLine" id="cb79-3" data-line-number="3">fertility_sub &lt;-<span class="st"> </span><span class="kw">filter</span>(fertility_tidy, age_bracket <span class="op">!=</span><span class="st"> &quot;global&quot;</span>)</a>
<a class="sourceLine" id="cb79-4" data-line-number="4">fertility_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(est <span class="op">~</span><span class="st"> </span>age_bracket, <span class="dt">data =</span> fertility_sub)</a>
<a class="sourceLine" id="cb79-5" data-line-number="5"><span class="kw">summary</span>(fertility_lm)</a>
<a class="sourceLine" id="cb79-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb79-7" data-line-number="7"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb79-8" data-line-number="8"><span class="co">#&gt; lm(formula = est ~ age_bracket, data = fertility_sub)</span></a>
<a class="sourceLine" id="cb79-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb79-10" data-line-number="10"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb79-11" data-line-number="11"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb79-12" data-line-number="12"><span class="co">#&gt; -55.060  -5.778  -0.383   6.874  55.133 </span></a>
<a class="sourceLine" id="cb79-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb79-14" data-line-number="14"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb79-15" data-line-number="15"><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb79-16" data-line-number="16"><span class="co">#&gt; (Intercept)        66.505      1.143   58.21   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-17" data-line-number="17"><span class="co">#&gt; age_bracket20_24   70.675      1.616   43.74   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-18" data-line-number="18"><span class="co">#&gt; age_bracket25_29   58.881      1.616   36.44   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-19" data-line-number="19"><span class="co">#&gt; age_bracket30_34   22.910      1.616   14.18   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-20" data-line-number="20"><span class="co">#&gt; age_bracket35_39  -20.312      1.616  -12.57   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-21" data-line-number="21"><span class="co">#&gt; age_bracket40_44  -53.346      1.616  -33.01   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-22" data-line-number="22"><span class="co">#&gt; age_bracket45_49  -64.797      1.616  -40.10   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb79-23" data-line-number="23"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb79-24" data-line-number="24"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb79-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb79-26" data-line-number="26"><span class="co">#&gt; Residual standard error: 14.13 on 1064 degrees of freedom</span></a>
<a class="sourceLine" id="cb79-27" data-line-number="27"><span class="co">#&gt; Multiple R-squared:  0.922,  Adjusted R-squared:  0.9215 </span></a>
<a class="sourceLine" id="cb79-28" data-line-number="28"><span class="co">#&gt; F-statistic:  2096 on 6 and 1064 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<p>Vale la pena notar que aunque los datos limpios facilitan las
tareas de análisis, distintas funciones o tareas requieren los datos en
distintos formas y saber pivotear las tablas es muy útil.</p>
<p><img src="img/manicule2.jpg" /> Grafica el valor estimado de fertilidad del grupo de
edad 20-24 contra 25-29. ¿Qué transformación debes hacer? Tip: elimina la
columna que corresponde al error estándar antes de ensanchar los
datos.</p>
</div>
<div id="una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas" class="section level3 unnumbered">
<h3>Una misma unidad observacional está almacenada en múltiples tablas</h3>
<p>También es común que los valores sobre una misma unidad observacional estén
separados en muchas tablas o archivos, es común que estas tablas esten divididas
de acuerdo a una variable, de tal manera que cada archivo representa a una
persona, año o ubicación. Para juntar los archivos hacemos lo siguiente:</p>
<ol style="list-style-type: decimal">
<li>Enlistamos las rutas de los archivos.</li>
<li>Leemos cada archivo y agregamos una columna con el nombre del archivo.</li>
<li>Combinamos las tablas en un solo data frame.</li>
</ol>
<p>Veamos un ejemplo, descargamos la carpeta con los datos de varios contaminantes
de RAMA,</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">usethis<span class="op">::</span><span class="kw">use_zip</span>(<span class="st">&quot;https://github.com/tereom/estcomp/raw/master/data-raw/19RAMA.zip&quot;</span>, </a>
<a class="sourceLine" id="cb80-2" data-line-number="2">    <span class="st">&quot;data&quot;</span>)</a></code></pre></div>
<p>ésta contiene 9 archivos de excel que almacenan información de monitoreo de
contaminantes. Cada archivo contiene información de un contaminante y el nombre
del archivo indica el contaminante.</p>
<p>Los pasos en R (usando el paquete <code>purrr</code>), primero creamos un vector con los
nombres de los archivos en un directorio, eligiendo aquellos que contengan las
letras “.csv”.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">paths &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;data/19RAMA&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.xls$&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Después le asignamos el nombre del archivo al nombre de cada elemento del vector.
Este paso se realiza para preservar los nombres de los archivos ya que estos
los asignaremos a una variable mas adelante.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">paths &lt;-<span class="st"> </span><span class="kw">set_names</span>(paths, <span class="kw">basename</span>(paths))</a></code></pre></div>
<p>La función <code>map_df</code> itera sobre cada dirección, lee el archivo excel de dicha
dirección y los combina en un data frame.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb83-2" data-line-number="2">rama &lt;-<span class="st"> </span><span class="kw">map_df</span>(paths, read_excel, <span class="dt">.id =</span> <span class="st">&quot;FILENAME&quot;</span>)</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"></a>
<a class="sourceLine" id="cb83-4" data-line-number="4"><span class="co"># eliminamos la basura del id</span></a>
<a class="sourceLine" id="cb83-5" data-line-number="5">rama &lt;-<span class="st"> </span>rama <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PARAMETRO =</span> <span class="kw">str_remove</span>(FILENAME, <span class="st">&quot;2019&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_remove</span>(<span class="st">&quot;.xls&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(PARAMETRO, FECHA<span class="op">:</span>AJU)</a>
<a class="sourceLine" id="cb83-8" data-line-number="8"><span class="co"># y apilamos para tener una columna por estación</span></a>
<a class="sourceLine" id="cb83-9" data-line-number="9">rama_tidy &lt;-<span class="st"> </span>rama <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-10" data-line-number="10"><span class="st">    </span><span class="kw">gather</span>(estacion, valor, ACO<span class="op">:</span>AJU) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-11" data-line-number="11"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">valor =</span> <span class="kw">ifelse</span>(<span class="op">-</span><span class="dv">99</span>, <span class="ot">NA</span>, valor))</a>
<a class="sourceLine" id="cb83-12" data-line-number="12">rama_tidy</a>
<a class="sourceLine" id="cb83-13" data-line-number="13"><span class="co">#&gt; # A tibble: 1,648,512 x 5</span></a>
<a class="sourceLine" id="cb83-14" data-line-number="14"><span class="co">#&gt;    PARAMETRO FECHA                HORA estacion valor</span></a>
<a class="sourceLine" id="cb83-15" data-line-number="15"><span class="co">#&gt;    &lt;chr&gt;     &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb83-16" data-line-number="16"><span class="co">#&gt;  1 CO        2019-01-01 00:00:00     1 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-17" data-line-number="17"><span class="co">#&gt;  2 CO        2019-01-01 00:00:00     2 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-18" data-line-number="18"><span class="co">#&gt;  3 CO        2019-01-01 00:00:00     3 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-19" data-line-number="19"><span class="co">#&gt;  4 CO        2019-01-01 00:00:00     4 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-20" data-line-number="20"><span class="co">#&gt;  5 CO        2019-01-01 00:00:00     5 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-21" data-line-number="21"><span class="co">#&gt;  6 CO        2019-01-01 00:00:00     6 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-22" data-line-number="22"><span class="co">#&gt;  7 CO        2019-01-01 00:00:00     7 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-23" data-line-number="23"><span class="co">#&gt;  8 CO        2019-01-01 00:00:00     8 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-24" data-line-number="24"><span class="co">#&gt;  9 CO        2019-01-01 00:00:00     9 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-25" data-line-number="25"><span class="co">#&gt; 10 CO        2019-01-01 00:00:00    10 ACO      NA   </span></a>
<a class="sourceLine" id="cb83-26" data-line-number="26"><span class="co">#&gt; # … with 1,648,502 more rows</span></a></code></pre></div>
</div>
<div id="otras-consideraciones" class="section level3 unnumbered">
<h3>Otras consideraciones</h3>
<p>En las buenas prácticas es importante tomar en cuenta los siguientes puntos:</p>
<ul>
<li><p>Incluir un encabezado con el nombre de las variables.</p></li>
<li><p>Los nombres de las variables deben ser entendibles (e.g. AgeAtDiagnosis es
mejor que AgeDx).</p></li>
<li><p>En general los datos se deben guardar en un archivo por tabla.</p></li>
<li><p>Escribir un script con las modificaciones que se hicieron a los <em>datos crudos</em>
(reproducibilidad).</p></li>
<li><p>Otros aspectos importantes en la <em>limpieza</em> de datos son: selección del tipo
de variables (por ejemplo fechas), datos faltantes, <em>typos</em> y detección de
valores atípicos.</p></li>
</ul>
</div>
<div id="recursos-adicionales" class="section level3 unnumbered">
<h3>Recursos adicionales</h3>
<ul>
<li><p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">Data Transformation Cheat Sheet</a>
de RStudio.</p></li>
<li><p><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data Wrangling Cheat Sheet</a>
de RStudio.</p></li>
<li><p>Limpiar nombres de columnas, eliminar filas vacías y más, paquete
<a href="https://github.com/sfirke/janitor">janitor</a>.</p></li>
<li><p>Lectura de datos tabulares con distintas estructuras, paquete
<a href="https://buff.ly/2z9CcBN">tidycells</a>.</p></li>
</ul>

</div>
</div>
<!-- </div> -->
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-tidy">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software, Articles</em> 59 (10):1–23. <a href="https://doi.org/10.18637/jss.v059.i10" class="uri">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="transformación-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="temas-selectos-de-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/02-manipulacion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
