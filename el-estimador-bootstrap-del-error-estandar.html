<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 El estimador bootstrap del error estándar | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 El estimador bootstrap del error estándar | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 El estimador bootstrap del error estándar | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="el-principio-del-plug-in.html"/>
<link rel="next" href="intervalos-de-confianza.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificacion"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#noticias"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualizacion.html"><a href="principios-visualizacion.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-de-datos-en-la-estadistica"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engano-y-chartjunk.html"><a href="factor-de-engano-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequenos-multiplos-y-densidad-grafica.html"><a href="pequenos-multiplos-y-densidad-grafica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoracion.html"><a href="decoracion.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepcion-de-escala.html"><a href="percepcion-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-grafica-de-minard.html"><a href="ejemplos-grafica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-r-y-al-paquete-ggplot2.html"><a href="introduccion-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-analisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-agrupacion-de-datos.html"><a href="manipulacion-y-agrupacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#summarise-y-resumenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-mas-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteracion.html"><a href="funciones-e-iteracion.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteracion.html"><a href="funciones-e-iteracion.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteracion.html"><a href="iteracion.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeno"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-calculo-de-probabilidades.html"><a href="introduccion-a-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extension-de-proporcion.html"><a href="probabilidad-como-extension-de-proporcion.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html#resultados-empiricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulacion-para-el-calculo-de-probabilidades.html"><a href="simulacion-para-el-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html#propiedades-de-la-funcion-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribucion-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-parametrico.html"><a href="bootstrap-no-parametrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#funcion-de-distribucion-empirica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parametros-y-estadisticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estandar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#variacion-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="mas-alla-de-muestras-aleatorias-simples.html"><a href="mas-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalacion-y-visualizacion.html"><a href="instalacion-y-visualizacion.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos-1.html"><a href="transformacion-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="union-de-tablas-y-limpieza-de-datos.html"><a href="union-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programacion-funcional-y-distribucion-muestral.html"><a href="programacion-funcional-y-distribucion-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a></li>
<li class="chapter" data-level="" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i>5. Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="el-estimador-bootstrap-del-error-estandar" class="section level2">
<h2><span class="header-section-number">6.2</span> El estimador bootstrap del error estándar</h2>
<p>Entonces, los pasos para calcular estimador bootstrap del error estándar son:</p>
<p>Tenemos una muestra aleatoria <span class="math inline">\(\textbf{x}=(x_1,x_2,...,x_n)\)</span>
proveniente de una distribución de probabilidad desconocida <span class="math inline">\(P\)</span>,</p>
<ol style="list-style-type: decimal">
<li><p>Seleccionamos muestras aleatorias con reemplazo de la distribución empírica.</p></li>
<li><p>Calculamos la estadística de interés para cada muestra:
<span class="math display">\[\hat{\theta}=s(\textbf{x})\]</span>
la estimación puede ser la estimación <em>plug-in</em> <span class="math inline">\(t(P_n)\)</span> pero también puede
ser otra.</p></li>
<li><p>La distribución de la estadística es la distribución bootstrap, y el
estimador bootstrap del error estándar es la desviación estándar de la
distribución bootstrap.</p></li>
</ol>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">dist_empirica &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">obs =</span> samples<span class="op">$</span>sims[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb194-2" data-line-number="2"></a>
<a class="sourceLine" id="cb194-3" data-line-number="3">dist_empirica_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dist_empirica, <span class="kw">aes</span>(<span class="dt">x =</span> obs)) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">xintercept =</span> <span class="dv">5</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">&quot;x_bar&quot;</span>), </a>
<a class="sourceLine" id="cb194-7" data-line-number="7">        <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-8" data-line-number="8"><span class="st">    </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-10" data-line-number="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="st">&quot;Distribución empírica&quot;</span><span class="op">~</span>P[n])) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-11" data-line-number="11"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;mu&#39;</span> =<span class="st"> &#39;red&#39;</span>, <span class="st">&#39;x_bar&#39;</span> =<span class="st"> &#39;blue&#39;</span>), <span class="dt">name =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb194-12" data-line-number="12">        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(mu), <span class="kw">expression</span>(<span class="kw">bar</span>(x)))) </a>
<a class="sourceLine" id="cb194-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb194-14" data-line-number="14">samples_boot &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">sample_boot =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-15" data-line-number="15"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb194-16" data-line-number="16">        <span class="dt">sims_boot =</span> <span class="kw">rerun</span>(<span class="dv">3</span>, <span class="kw">sample</span>(dist_empirica<span class="op">$</span>obs, <span class="dt">replace =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb194-17" data-line-number="17">        <span class="dt">x_bar_boot =</span> <span class="kw">map_dbl</span>(sims_boot, mean)</a>
<a class="sourceLine" id="cb194-18" data-line-number="18">      )</a>
<a class="sourceLine" id="cb194-19" data-line-number="19"></a>
<a class="sourceLine" id="cb194-20" data-line-number="20">muestras_boot_plot &lt;-<span class="st"> </span>samples_boot <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-21" data-line-number="21"><span class="st">    </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-22" data-line-number="22"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-23" data-line-number="23"><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-24" data-line-number="24"><span class="st">        </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>]), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb194-25" data-line-number="25">            <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-26" data-line-number="26"><span class="st">        </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-27" data-line-number="27"><span class="st">        </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_bar_boot, <span class="dt">xend =</span> x_bar_boot, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> <span class="fl">0.8</span>), </a>
<a class="sourceLine" id="cb194-28" data-line-number="28">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-29" data-line-number="29"><span class="st">        </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-30" data-line-number="30"><span class="st">        </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sample_boot) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-31" data-line-number="31"><span class="st">        </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_bar_boot, <span class="dt">y =</span> <span class="fl">0.95</span>, <span class="dt">label =</span> <span class="st">&quot;bar(x)^&#39;*&#39;&quot;</span>), </a>
<a class="sourceLine" id="cb194-32" data-line-number="32">            <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-33" data-line-number="33"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Muestras bootstrap&quot;</span>) </a>
<a class="sourceLine" id="cb194-34" data-line-number="34"></a>
<a class="sourceLine" id="cb194-35" data-line-number="35">boot_dist &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-36" data-line-number="36"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb194-37" data-line-number="37">        <span class="dt">sims_boot =</span> <span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">sample</span>(dist_empirica<span class="op">$</span>obs, <span class="dt">replace =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb194-38" data-line-number="38">        <span class="dt">mu_hat_star =</span> <span class="kw">map_dbl</span>(sims_boot, mean))</a>
<a class="sourceLine" id="cb194-39" data-line-number="39">boot_muestral_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(boot_dist, <span class="kw">aes</span>(<span class="dt">x =</span> mu_hat_star)) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-40" data-line-number="40"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-41" data-line-number="41"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb194-42" data-line-number="42">        <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="st">&quot;Distribución bootstrap de &quot;</span><span class="op">~</span><span class="kw">hat</span>(mu)<span class="op">^</span><span class="st">&#39;*&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-43" data-line-number="43"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-44" data-line-number="44"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>]), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb194-45" data-line-number="45">        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb194-46" data-line-number="46"></a>
<a class="sourceLine" id="cb194-47" data-line-number="47">(dist_empirica_plot <span class="op">|</span><span class="st"> </span><span class="kw">plot_spacer</span>()) <span class="op">/</span><span class="st"> </span>(muestras_boot_plot <span class="op">|</span><span class="st"> </span>boot_muestral_plot) </a></code></pre></div>
<p><img src="img/bootstrap_world.png" /></p>
<p>Describamos la notación y conceptos:</p>
<div class="caja">
<p>Definimos una <strong>muestra bootstrap</strong> como una muestra aleatoria de tamaño <span class="math inline">\(n\)</span> que
se obtiene de la distribución empírica <span class="math inline">\(P_n\)</span> y la denotamos
<span class="math display">\[\textbf{x}^* = (x_1^*,...,x_n^*).\]</span></p>
</div>
<p>La notación de estrella indica que <span class="math inline">\(\textbf{x}^*\)</span> no son los datos <span class="math inline">\(\textbf{x}\)</span>
sino una versión de <strong>remuestreo</strong> de <span class="math inline">\(\textbf{x}\)</span>.</p>
<p>Otra manera de frasearlo: Los datos bootsrtap <span class="math inline">\(x_1^*,...,x_n^*\)</span> son una muestra
aleatoria de tamaño <span class="math inline">\(n\)</span> seleccionada con reemplazo de la población de <span class="math inline">\(n\)</span>
objetos <span class="math inline">\((x_1,...,x_n)\)</span>.</p>
<div class="caja">
<p>A cada muestra bootstrap <span class="math inline">\(\textbf{x}^*\)</span> le corresponde una replicación
<span class="math inline">\(\hat{\theta}^*=s(\textbf{x}^*).\)</span></p>
</div>
<p>el estimador bootstrap de <span class="math inline">\(se_P(\hat{\theta})\)</span> se define como:</p>
<p><span class="math display">\[se_{P_n}(\hat{\theta}^*)\]</span></p>
<p>en otras palabras, la estimación bootstrap de <span class="math inline">\(se_P(\hat{\theta})\)</span> es el error
estándar de <span class="math inline">\(\hat{\theta}\)</span> para conjuntos de datos de tamaño <span class="math inline">\(n\)</span> seleccionados
de manera aleatoria de <span class="math inline">\(P_n\)</span>.</p>
<p>La fórmula <span class="math inline">\(se_{P_n}(\hat{\theta}^*)\)</span> no existe para casi ninguna estimación
diferente de la media, por lo que recurrimos a la técnica computacional
bootstrap:</p>
<div class="caja">
<p><strong>Algoritmo bootstrap para estimar errores estándar</strong></p>
<ol style="list-style-type: decimal">
<li><p>Selecciona <span class="math inline">\(B\)</span> muestras bootstrap independientes:
<span class="math display">\[\textbf{x}^{*1},..., \textbf{x}^{*B}\]</span>.</p></li>
<li><p>Evalúa la replicación bootstrap correspondiente a cada muestra bootstrap:
<span class="math display">\[\hat{\theta}^{*b}=s(\textbf{x}^{*b})\]</span>
para <span class="math inline">\(b=1,2,...,B.\)</span></p></li>
<li><p>Estima el error estándar <span class="math inline">\(se_P(\hat{\theta})\)</span> usando la desviación estándar
muestral de las <span class="math inline">\(B\)</span> replicaciones:
<span class="math display">\[\hat{se}_B = \bigg\{\frac{\sum_{b=1}^B[\hat{\theta}^{*}(b)-\hat{\theta}^*(\cdot)]^2 }{B-1}\bigg\}^{1/2}\]</span></p></li>
</ol>
donde <span class="math display">\[\hat{\theta}^*(\cdot)=\sum_{b=1}^B \theta^{*}(b)/B \]</span>.
</p>
</div>
<p>Notemos que:</p>
<ul>
<li><p>La estimación bootstrap de <span class="math inline">\(se_{P}(\hat{\theta})\)</span>, el error estándar
de una estadística <span class="math inline">\(\hat{\theta}\)</span>, es un estimador <em>plug-in</em> que usa la
función de distribución empírica <span class="math inline">\(P_n\)</span> en lugar de la distribución desconocida
<span class="math inline">\(P\)</span>.</p></li>
<li><p>Conforme el número de replicaciones <span class="math inline">\(B\)</span> aumenta
<span class="math display">\[\hat{se}_B\approx se_{P_n}(\hat{\theta})\]</span>
este hecho equivale a decir que la desviación estándar empírica se acerca a
la desviación estándar poblacional conforme crece el número de muestras. La
<em>población</em> en este caso es la población de valores <span class="math inline">\(\hat{\theta}^*=s(x^*)\)</span>.</p></li>
<li><p>Al estimador de bootstrap ideal <span class="math inline">\(se_{P_n}(\hat{\theta})\)</span> y su aproximación
<span class="math inline">\(\hat{se}_B\)</span> se les denota <strong>estimadores bootstrap no paramétricos</strong> ya que
estan basados en <span class="math inline">\(P_n\)</span>, el estimador no paramétrico de la población <span class="math inline">\(P\)</span>.</p></li>
</ul>
<div id="ejemplo-error-estandar-bootstrap-de-una-media" class="section level4 unnumbered">
<h4>Ejemplo: Error estándar bootstrap de una media</h4>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">mediaBoot &lt;-<span class="st"> </span><span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb195-2" data-line-number="2">  <span class="co"># x: variable de interés</span></a>
<a class="sourceLine" id="cb195-3" data-line-number="3">  <span class="co"># n: número de replicaciones bootstrap</span></a>
<a class="sourceLine" id="cb195-4" data-line-number="4">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb195-5" data-line-number="5">  muestra_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb195-6" data-line-number="6">  <span class="kw">mean</span>(muestra_boot) <span class="co"># replicacion bootstrap de theta_gorro</span></a>
<a class="sourceLine" id="cb195-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb195-8" data-line-number="8">thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">mediaBoot</span>(enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb195-9" data-line-number="9"><span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb195-10" data-line-number="10"><span class="co">#&gt; [1] 3.238793</span></a></code></pre></div>
<p>y se compara con <span class="math inline">\(\hat{se}(\bar{x})\)</span> (estimador <em>plug-in</em> del error estándar):</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1">se &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb196-2" data-line-number="2"><span class="kw">se</span>(enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb196-3" data-line-number="3"><span class="co">#&gt; [1] 3.264511</span></a></code></pre></div>
<p><strong>Nota:</strong> Conforme <span class="math inline">\(B\)</span> aumenta <span class="math inline">\(\hat{se}_{B}(\bar{x})\to \{\sum_{i=1}^n(x_i - \bar{x})^2 / n \}^{1/2}\)</span>,
se demuestra con la ley débil de los grandes números.</p>
<p><img src="img/manicule2.jpg" /> Considera el coeficiente de correlación muestral entre la
calificación de <span class="math inline">\(y=\)</span>esp_3 y la de <span class="math inline">\(z=\)</span>esp_6: <span class="math inline">\(\hat{corr}(y,z)=0.9\)</span>. ¿Qué tan
precisa es esta estimación?</p>
</div>
<div id="variacion-en-distribuciones-bootstrap" class="section level3 unnumbered">
<h3>Variación en distribuciones bootstrap</h3>
<p>En el proceso de estimación bootstrap hay dos fuentes de variación pues:</p>
<ul>
<li><p>La muestra original se selecciona con aleatoriedad de una población.</p></li>
<li><p>Las muestras bootstrap se seleccionan con aleatoriedad de la muestra
original. Esto es: <em>La estimación bootstrap ideal es un resultado asintótico
<span class="math inline">\(B=\infty\)</span>, en esta caso <span class="math inline">\(\hat{se}_B\)</span> iguala la estimación <em>plug-in</em>
<span class="math inline">\(se_{P_n}\)</span>.</em></p></li>
</ul>
<p>En el proceso de <em>bootstrap</em> podemos controlar la variación del segundo aspecto,
conocida como <strong>implementación de muestreo Monte Carlo</strong>, y la variación
Monte Carlo decrece conforme incrementamos el número de muestras.</p>
<p>Podemos eliminar la variación Monte Carlo si seleccionamos todas las posibles
muestras con reemplazo de tamaño <span class="math inline">\(n\)</span>, hay <span class="math inline">\({2n-1}\choose{n}\)</span> posibles muestras
y si seleccionamos todas obtenemos <span class="math inline">\(\hat{se}_\infty\)</span> (bootstrap ideal), sin
embargo, en la mayor parte de los problemas no es factible proceder así.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">8098</span>)</a>
<a class="sourceLine" id="cb197-2" data-line-number="2">pob_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="dv">-15</span><span class="op">:</span><span class="dv">20</span>), <span class="kw">aes</span>(x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-3" data-line-number="3"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnormm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="dt">mu =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">8</span>), </a>
<a class="sourceLine" id="cb197-4" data-line-number="4">        <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">3</span>)), <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">xintercept =</span> <span class="dv">5</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;mu&#39;</span> =<span class="st"> &#39;red&#39;</span>), <span class="dt">name =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb197-7" data-line-number="7">        <span class="dt">labels =</span> <span class="kw">expression</span>(mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-8" data-line-number="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Población&quot;, color = &quot;&quot;) +</span></a>
<a class="sourceLine" id="cb197-9" data-line-number="9"><span class="st">    theme(axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb197-10" data-line-number="10"></a>
<a class="sourceLine" id="cb197-11" data-line-number="11"><span class="st">samples &lt;- data_frame(sample = 1:6) %&gt;% </span></a>
<a class="sourceLine" id="cb197-12" data-line-number="12"><span class="st">    mutate(</span></a>
<a class="sourceLine" id="cb197-13" data-line-number="13"><span class="st">        sims = rerun(6, rnormm(50, p = c(0.3, 0.7), mu = c(-2, 8), </span></a>
<a class="sourceLine" id="cb197-14" data-line-number="14"><span class="st">            sigma = c(3.5, 3))), </span></a>
<a class="sourceLine" id="cb197-15" data-line-number="15"><span class="st">        x_bar = map_dbl(sims, mean))</span></a>
<a class="sourceLine" id="cb197-16" data-line-number="16"></a>
<a class="sourceLine" id="cb197-17" data-line-number="17"><span class="st"> means_boot &lt;- function(n, sims) {</span></a>
<a class="sourceLine" id="cb197-18" data-line-number="18"><span class="st">    rerun(n, mean(sample(sims, replace = TRUE))) %&gt;%</span></a>
<a class="sourceLine" id="cb197-19" data-line-number="19"><span class="st">        flatten_dbl()</span></a>
<a class="sourceLine" id="cb197-20" data-line-number="20"><span class="st"> }</span></a>
<a class="sourceLine" id="cb197-21" data-line-number="21"><span class="st">samples_boot &lt;- samples %&gt;% </span></a>
<a class="sourceLine" id="cb197-22" data-line-number="22"><span class="st">    mutate(</span></a>
<a class="sourceLine" id="cb197-23" data-line-number="23"><span class="st">        medias_boot_30_1 = map(sims, ~means_boot(n = 30, .)), </span></a>
<a class="sourceLine" id="cb197-24" data-line-number="24"><span class="st">        medias_boot_30_2 = map(sims, ~means_boot(n = 30, .)), </span></a>
<a class="sourceLine" id="cb197-25" data-line-number="25"><span class="st">        medias_boot_1000_1 = map(sims, ~means_boot(n = 1000, .)), </span></a>
<a class="sourceLine" id="cb197-26" data-line-number="26"><span class="st">        medias_boot_1000_2 = map(sims, ~means_boot(n = 1000, .))</span></a>
<a class="sourceLine" id="cb197-27" data-line-number="27"><span class="st">    )</span></a>
<a class="sourceLine" id="cb197-28" data-line-number="28"></a>
<a class="sourceLine" id="cb197-29" data-line-number="29"><span class="st">emp_dists &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb197-30" data-line-number="30"><span class="st">    unnest(cols = sims) %&gt;% </span></a>
<a class="sourceLine" id="cb197-31" data-line-number="31"><span class="st">    rename(obs = sims)</span></a>
<a class="sourceLine" id="cb197-32" data-line-number="32"><span class="st">emp_dists_plots &lt;- ggplot(emp_dists, aes(x = obs)) +</span></a>
<a class="sourceLine" id="cb197-33" data-line-number="33"><span class="st">    geom_histogram(binwidth = 2, alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb197-34" data-line-number="34"><span class="st">    geom_vline(aes(color = &quot;</span>mu<span class="st">&quot;, xintercept = 5), alpha = 0.5, </span></a>
<a class="sourceLine" id="cb197-35" data-line-number="35"><span class="st">      show.legend = FALSE) +</span></a>
<a class="sourceLine" id="cb197-36" data-line-number="36"><span class="st">    geom_vline(aes(xintercept = x_bar, color = &quot;</span>x_bar<span class="st">&quot;), show.legend = FALSE, </span></a>
<a class="sourceLine" id="cb197-37" data-line-number="37"><span class="st">        alpha = 0.8, linetype = &quot;</span>dashed<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb197-38" data-line-number="38"><span class="st">    xlim(-15, 20) +</span></a>
<a class="sourceLine" id="cb197-39" data-line-number="39"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb197-40" data-line-number="40"><span class="st">    labs(x = &quot;&quot;, y = &quot;&quot;, subtitle = expression(&quot;</span>Distribución empírica<span class="st">&quot;~P[n])) +</span></a>
<a class="sourceLine" id="cb197-41" data-line-number="41"><span class="st">    scale_colour_manual(values = c(&#39;mu&#39; = &#39;red&#39;, &#39;x_bar&#39; = &#39;blue&#39;), name = &#39;&#39;, </span></a>
<a class="sourceLine" id="cb197-42" data-line-number="42"><span class="st">        labels = c(expression(mu), expression(bar(x)))) +</span></a>
<a class="sourceLine" id="cb197-43" data-line-number="43"><span class="st">    facet_wrap(~ sample, ncol = 1) +</span></a>
<a class="sourceLine" id="cb197-44" data-line-number="44"><span class="st">    theme(strip.background = element_blank(), strip.text.x = element_blank(), </span></a>
<a class="sourceLine" id="cb197-45" data-line-number="45"><span class="st">        axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb197-46" data-line-number="46"><span class="st"> </span></a>
<a class="sourceLine" id="cb197-47" data-line-number="47"><span class="st">boot_dists_30 &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb197-48" data-line-number="48"><span class="st">    unnest(cols = c(medias_boot_30_1, medias_boot_30_2)) %&gt;% </span></a>
<a class="sourceLine" id="cb197-49" data-line-number="49"><span class="st">    pivot_longer(cols = c(medias_boot_30_1, medias_boot_30_2), </span></a>
<a class="sourceLine" id="cb197-50" data-line-number="50"><span class="st">    values_to = &quot;</span>mu_hat_star<span class="st">&quot;, names_to = &quot;</span>boot_trial<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb197-51" data-line-number="51"><span class="st">    names_prefix = &quot;</span>medias_boot_<span class="dv">30</span>_<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb197-52" data-line-number="52"><span class="st">boot_dists_30_plot &lt;- ggplot(boot_dists_30, aes(x = mu_hat_star)) +</span></a>
<a class="sourceLine" id="cb197-53" data-line-number="53"><span class="st">    geom_histogram(alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb197-54" data-line-number="54"><span class="st">    labs(x = &quot;&quot;, y = &quot;&quot;,</span></a>
<a class="sourceLine" id="cb197-55" data-line-number="55"><span class="st">        subtitle = expression(&quot;</span>Distribución bootstrap <span class="dt">B =</span> <span class="dv">30</span><span class="st">&quot;)) +</span></a>
<a class="sourceLine" id="cb197-56" data-line-number="56"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb197-57" data-line-number="57"><span class="st">    geom_vline(aes(xintercept = x_bar), color = &quot;</span>blue<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb197-58" data-line-number="58"><span class="st">        linetype = &quot;</span>dashed<span class="st">&quot;, alpha = 0.8) +</span></a>
<a class="sourceLine" id="cb197-59" data-line-number="59"><span class="st">    facet_grid(sample~boot_trial) +</span></a>
<a class="sourceLine" id="cb197-60" data-line-number="60"><span class="st">    theme(strip.background = element_blank(), strip.text.y = element_blank(), </span></a>
<a class="sourceLine" id="cb197-61" data-line-number="61"><span class="st">        axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb197-62" data-line-number="62"></a>
<a class="sourceLine" id="cb197-63" data-line-number="63"><span class="st">boot_dists_1000 &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb197-64" data-line-number="64"><span class="st">    unnest(cols = c(medias_boot_1000_1, medias_boot_1000_2)) %&gt;% </span></a>
<a class="sourceLine" id="cb197-65" data-line-number="65"><span class="st">    pivot_longer(cols = c(medias_boot_1000_1, medias_boot_1000_2), </span></a>
<a class="sourceLine" id="cb197-66" data-line-number="66"><span class="st">    values_to = &quot;</span>mu_hat_star<span class="st">&quot;, names_to = &quot;</span>boot_trial<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb197-67" data-line-number="67"><span class="st">    names_prefix = &quot;</span>medias_boot_<span class="dv">1000</span>_<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb197-68" data-line-number="68"><span class="st">boot_dists_1000_plot &lt;- ggplot(boot_dists_1000, aes(x = mu_hat_star)) +</span></a>
<a class="sourceLine" id="cb197-69" data-line-number="69"><span class="st">    geom_histogram(alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb197-70" data-line-number="70"><span class="st">    labs(subtitle = expression(&quot;</span>Distribución bootstrap <span class="dt">B =</span> <span class="dv">1000</span><span class="st">&quot;), </span></a>
<a class="sourceLine" id="cb197-71" data-line-number="71"><span class="st">       x = &quot;&quot;, y = &quot;&quot;) +</span></a>
<a class="sourceLine" id="cb197-72" data-line-number="72"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb197-73" data-line-number="73"><span class="st">    geom_vline(aes(xintercept = x_bar), color = &quot;</span>blue<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb197-74" data-line-number="74"><span class="st">        linetype = &quot;</span>dashed<span class="st">&quot;, alpha = 0.8) +</span></a>
<a class="sourceLine" id="cb197-75" data-line-number="75"><span class="st">    facet_grid(sample~boot_trial) +</span></a>
<a class="sourceLine" id="cb197-76" data-line-number="76"><span class="st">    scale_colour_manual(values = c(&#39;mu&#39; = &#39;red&#39;, &#39;x_bar&#39; = &#39;blue&#39;), name = &#39;&#39;,</span></a>
<a class="sourceLine" id="cb197-77" data-line-number="77"><span class="st">    labels = c(expression(mu), expression(bar(x)))) +</span></a>
<a class="sourceLine" id="cb197-78" data-line-number="78"><span class="st">    theme(strip.background = element_blank(), strip.text.y = element_blank(), </span></a>
<a class="sourceLine" id="cb197-79" data-line-number="79"><span class="st">        strip.text.x = element_blank(), axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb197-80" data-line-number="80"></a>
<a class="sourceLine" id="cb197-81" data-line-number="81"><span class="st">(pob_plot | plot_spacer() | plot_spacer()) /</span></a>
<a class="sourceLine" id="cb197-82" data-line-number="82"><span class="st">(emp_dists_plots | boot_dists_30_plot | boot_dists_1000_plot) +</span></a>
<a class="sourceLine" id="cb197-83" data-line-number="83"><span class="st">plot_layout(heights = c(1, 5))</span></a></code></pre></div>
<p>En la siguiente gráfica mostramos 6 posibles muestras de tamaño 50 simuladas de
la población, para cada una de ellas se graficó la distribución empírica y se
se realizan histogramas de la distribución bootstrap con <span class="math inline">\(B=30\)</span> y <span class="math inline">\(B=1000\)</span>, en
cada caso hacemos dos repeticiones, notemos que cuando el número de muestras
bootstrap es grande las distribuciones bootstrap son muy similares (para una
muestra de la población dada), esto es porque disminuimos el erro Monte Carlo.
También vale la pena recalcar que la distribución bootstrap está centrada en el
valor observado en la muestra (línea azúl punteada) y no en el valor poblacional
sin embargo la forma de la distribución es similar a lo largo de las filas.</p>
<p><img src="img/bootstrap_mc_error.png" /></p>
<!--
* En la práctica para elegir el tamaño de $B$ debemos considerar que buscamos 
las mismas propiedades para la estimación de un error estándar que para 
cualquier estimación: poco sesgo y desviación estándar chica. El sesgo de la 
estifmación bootstrap del error estándar suele ser bajo y el error estándar está

 Una respuesta aproximada es en términos del coeficiente de variación de 
$\hat{se}_B$, esto es el cociente de la desviación estándar de $\hat{se}_B$ y su 
valor esperado, la variabilidad adicional de parar en $B$ replicaciones en lugar 
de seguir hasta infiniti se refleja en un incremento en el coeficiente de 
variación
-->
<p>Entonces, ¿cuántas muestras bootstrap?</p>
<ol style="list-style-type: decimal">
<li><p>Incluso un número chico de replicaciones bootstrap, digamos <span class="math inline">\(B=25\)</span> es
informativo, y <span class="math inline">\(B=50\)</span> con frecuencia es suficiente para dar una buena
estimación de <span class="math inline">\(se_P(\hat{\theta})\)</span> (<span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>).</p></li>
<li><p>Cuando se busca estimar error estándar <span class="citation">Hesterberg (<a href="#ref-tim">2015</a>)</span> recomienda <span class="math inline">\(B=1000\)</span> muestras, o
<span class="math inline">\(B=10,000\)</span> muestras dependiendo la presición que se busque.</p></li>
</ol>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">seMediaBoot &lt;-<span class="st"> </span><span class="cf">function</span>(x, B){</a>
<a class="sourceLine" id="cb198-2" data-line-number="2">    thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">mediaBoot</span>(x)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb198-3" data-line-number="3">    <span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb198-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb198-5" data-line-number="5"></a>
<a class="sourceLine" id="cb198-6" data-line-number="6">B_muestras &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">n_sims =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">3000</span>, </a>
<a class="sourceLine" id="cb198-7" data-line-number="7">    <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb198-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">est =</span> <span class="kw">map_dbl</span>(n_sims, <span class="op">~</span><span class="kw">seMediaBoot</span>(<span class="dt">x =</span> enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>, <span class="dt">B =</span> .)))</a>
<a class="sourceLine" id="cb198-9" data-line-number="9"><span class="co">#&gt; Warning: `data_frame()` is deprecated, use `tibble()`.</span></a>
<a class="sourceLine" id="cb198-10" data-line-number="10"><span class="co">#&gt; This warning is displayed once per session.</span></a>
<a class="sourceLine" id="cb198-11" data-line-number="11">B_muestras</a>
<a class="sourceLine" id="cb198-12" data-line-number="12"><span class="co">#&gt; # A tibble: 12 x 2</span></a>
<a class="sourceLine" id="cb198-13" data-line-number="13"><span class="co">#&gt;    n_sims   est</span></a>
<a class="sourceLine" id="cb198-14" data-line-number="14"><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb198-15" data-line-number="15"><span class="co">#&gt;  1      5  3.08</span></a>
<a class="sourceLine" id="cb198-16" data-line-number="16"><span class="co">#&gt;  2     25  3.20</span></a>
<a class="sourceLine" id="cb198-17" data-line-number="17"><span class="co">#&gt;  3     50  3.17</span></a>
<a class="sourceLine" id="cb198-18" data-line-number="18"><span class="co">#&gt;  4    100  3.04</span></a>
<a class="sourceLine" id="cb198-19" data-line-number="19"><span class="co">#&gt;  5    200  3.36</span></a>
<a class="sourceLine" id="cb198-20" data-line-number="20"><span class="co">#&gt;  6    400  3.24</span></a>
<a class="sourceLine" id="cb198-21" data-line-number="21"><span class="co">#&gt;  7   1000  3.17</span></a>
<a class="sourceLine" id="cb198-22" data-line-number="22"><span class="co">#&gt;  8   1500  3.38</span></a>
<a class="sourceLine" id="cb198-23" data-line-number="23"><span class="co">#&gt;  9   3000  3.27</span></a>
<a class="sourceLine" id="cb198-24" data-line-number="24"><span class="co">#&gt; 10   5000  3.29</span></a>
<a class="sourceLine" id="cb198-25" data-line-number="25"><span class="co">#&gt; 11  10000  3.27</span></a>
<a class="sourceLine" id="cb198-26" data-line-number="26"><span class="co">#&gt; 12  20000  3.26</span></a></code></pre></div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-efron">
<p>Efron, Bradley, and Robert J. Tibshirani. 1993. <em>An Introduction to the Bootstrap</em>. Monographs on Statistics and Applied Probability 57. Boca Raton, Florida, USA: Chapman &amp; Hall/CRC.</p>
</div>
<div id="ref-tim">
<p>Hesterberg, Tim C. 2015. “What Teachers Should Know About the Bootstrap: Resampling in the Undergraduate Statistics Curriculum.” <em>The American Statistician</em> 69 (4). Taylor &amp; Francis:371–86. <a href="https://doi.org/10.1080/00031305.2015.1089789" class="uri">https://doi.org/10.1080/00031305.2015.1089789</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="el-principio-del-plug-in.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intervalos-de-confianza.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/05-bootstrap_no_parametrico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
