<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 El estimador bootstrap del error estándar | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 El estimador bootstrap del error estándar | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 El estimador bootstrap del error estándar | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="el-principio-del-plug-in.html"/>
<link rel="next" href="intervalos-de-confianza.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#ejemplo-estimación-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
<li class="chapter" data-level="10.10.1" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#iniciales-en-stan"><i class="fa fa-check"></i><b>10.10.1</b> Iniciales en Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="reparametrización.html"><a href="reparametrización.html"><i class="fa fa-check"></i><b>10.11</b> Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#ejemplo-el-embudo-de-neal"><i class="fa fa-check"></i>Ejemplo: El embudo de Neal</a></li>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#modelos-jerárquicos-y-parametrización-no-centrada"><i class="fa fa-check"></i>Modelos jerárquicos y parametrización no centrada</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="recursos-de-stan-y-paquetes-con-r.html"><a href="recursos-de-stan-y-paquetes-con-r.html"><i class="fa fa-check"></i>Recursos de Stan y paquetes con R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="el-estimador-bootstrap-del-error-estándar" class="section level2">
<h2><span class="header-section-number">6.2</span> El estimador bootstrap del error estándar</h2>
<p>Entonces, los pasos para calcular estimador bootstrap del error estándar son:</p>
<p>Tenemos una muestra aleatoria <span class="math inline">\(\textbf{x}=(x_1,x_2,...,x_n)\)</span>
proveniente de una distribución de probabilidad desconocida <span class="math inline">\(P\)</span>,</p>
<ol style="list-style-type: decimal">
<li><p>Seleccionamos muestras aleatorias con reemplazo de la distribución empírica.</p></li>
<li><p>Calculamos la estadística de interés para cada muestra:
<span class="math display">\[\hat{\theta}=s(\textbf{x})\]</span>
la estimación puede ser la estimación <em>plug-in</em> <span class="math inline">\(t(P_n)\)</span> pero también puede
ser otra.</p></li>
<li><p>La distribución de la estadística es la distribución bootstrap, y el
estimador bootstrap del error estándar es la desviación estándar de la
distribución bootstrap.</p></li>
</ol>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">dist_empirica &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">obs =</span> samples<span class="op">$</span>sims[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb188-2" data-line-number="2"></a>
<a class="sourceLine" id="cb188-3" data-line-number="3">dist_empirica_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dist_empirica, <span class="kw">aes</span>(<span class="dt">x =</span> obs)) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">xintercept =</span> <span class="dv">5</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">&quot;x_bar&quot;</span>), </a>
<a class="sourceLine" id="cb188-7" data-line-number="7">        <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-8" data-line-number="8"><span class="st">    </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-10" data-line-number="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="st">&quot;Distribución empírica&quot;</span><span class="op">~</span>P[n])) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-11" data-line-number="11"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;mu&#39;</span> =<span class="st"> &#39;red&#39;</span>, <span class="st">&#39;x_bar&#39;</span> =<span class="st"> &#39;blue&#39;</span>), <span class="dt">name =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb188-12" data-line-number="12">        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(mu), <span class="kw">expression</span>(<span class="kw">bar</span>(x)))) </a>
<a class="sourceLine" id="cb188-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb188-14" data-line-number="14">samples_boot &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">sample_boot =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-15" data-line-number="15"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb188-16" data-line-number="16">        <span class="dt">sims_boot =</span> <span class="kw">rerun</span>(<span class="dv">3</span>, <span class="kw">sample</span>(dist_empirica<span class="op">$</span>obs, <span class="dt">replace =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb188-17" data-line-number="17">        <span class="dt">x_bar_boot =</span> <span class="kw">map_dbl</span>(sims_boot, mean)</a>
<a class="sourceLine" id="cb188-18" data-line-number="18">      )</a>
<a class="sourceLine" id="cb188-19" data-line-number="19"></a>
<a class="sourceLine" id="cb188-20" data-line-number="20">muestras_boot_plot &lt;-<span class="st"> </span>samples_boot <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-21" data-line-number="21"><span class="st">    </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-22" data-line-number="22"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-23" data-line-number="23"><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-24" data-line-number="24"><span class="st">        </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>]), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb188-25" data-line-number="25">            <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-26" data-line-number="26"><span class="st">        </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-27" data-line-number="27"><span class="st">        </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_bar_boot, <span class="dt">xend =</span> x_bar_boot, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> <span class="fl">0.8</span>), </a>
<a class="sourceLine" id="cb188-28" data-line-number="28">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-29" data-line-number="29"><span class="st">        </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-30" data-line-number="30"><span class="st">        </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sample_boot) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-31" data-line-number="31"><span class="st">        </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_bar_boot, <span class="dt">y =</span> <span class="fl">0.95</span>, <span class="dt">label =</span> <span class="st">&quot;bar(x)^&#39;*&#39;&quot;</span>), </a>
<a class="sourceLine" id="cb188-32" data-line-number="32">            <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-33" data-line-number="33"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Muestras bootstrap&quot;</span>) </a>
<a class="sourceLine" id="cb188-34" data-line-number="34"></a>
<a class="sourceLine" id="cb188-35" data-line-number="35">boot_dist &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-36" data-line-number="36"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb188-37" data-line-number="37">        <span class="dt">sims_boot =</span> <span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">sample</span>(dist_empirica<span class="op">$</span>obs, <span class="dt">replace =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb188-38" data-line-number="38">        <span class="dt">mu_hat_star =</span> <span class="kw">map_dbl</span>(sims_boot, mean))</a>
<a class="sourceLine" id="cb188-39" data-line-number="39">boot_muestral_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(boot_dist, <span class="kw">aes</span>(<span class="dt">x =</span> mu_hat_star)) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-40" data-line-number="40"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-41" data-line-number="41"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb188-42" data-line-number="42">        <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="st">&quot;Distribución bootstrap de &quot;</span><span class="op">~</span><span class="kw">hat</span>(mu)<span class="op">^</span><span class="st">&#39;*&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-43" data-line-number="43"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-44" data-line-number="44"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> samples<span class="op">$</span>x_bar[<span class="dv">1</span>]), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb188-45" data-line-number="45">        <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb188-46" data-line-number="46"></a>
<a class="sourceLine" id="cb188-47" data-line-number="47">(dist_empirica_plot <span class="op">|</span><span class="st"> </span><span class="kw">plot_spacer</span>()) <span class="op">/</span><span class="st"> </span>(muestras_boot_plot <span class="op">|</span><span class="st"> </span>boot_muestral_plot) </a></code></pre></div>
<p><img src="img/bootstrap_world.png" /></p>
<p>Describamos la notación y conceptos:</p>
<div class="caja">
<p>Definimos una <strong>muestra bootstrap</strong> como una muestra aleatoria de tamaño <span class="math inline">\(n\)</span> que
se obtiene de la distribución empírica <span class="math inline">\(P_n\)</span> y la denotamos
<span class="math display">\[\textbf{x}^* = (x_1^*,...,x_n^*).\]</span></p>
</div>
<p>La notación de estrella indica que <span class="math inline">\(\textbf{x}^*\)</span> no son los datos <span class="math inline">\(\textbf{x}\)</span>
sino una versión de <strong>remuestreo</strong> de <span class="math inline">\(\textbf{x}\)</span>.</p>
<p>Otra manera de frasearlo: Los datos bootsrtap <span class="math inline">\(x_1^*,...,x_n^*\)</span> son una muestra
aleatoria de tamaño <span class="math inline">\(n\)</span> seleccionada con reemplazo de la población de <span class="math inline">\(n\)</span>
objetos <span class="math inline">\((x_1,...,x_n)\)</span>.</p>
<div class="caja">
<p>A cada muestra bootstrap <span class="math inline">\(\textbf{x}^*\)</span> le corresponde una replicación
<span class="math inline">\(\hat{\theta}^*=s(\textbf{x}^*).\)</span></p>
</div>
<p>el estimador bootstrap de <span class="math inline">\(se_P(\hat{\theta})\)</span> se define como:</p>
<p><span class="math display">\[se_{P_n}(\hat{\theta}^*)\]</span></p>
<p>en otras palabras, la estimación bootstrap de <span class="math inline">\(se_P(\hat{\theta})\)</span> es el error
estándar de <span class="math inline">\(\hat{\theta}\)</span> para conjuntos de datos de tamaño <span class="math inline">\(n\)</span> seleccionados
de manera aleatoria de <span class="math inline">\(P_n\)</span>.</p>
<p>La fórmula <span class="math inline">\(se_{P_n}(\hat{\theta}^*)\)</span> no existe para casi ninguna estimación
diferente de la media, por lo que recurrimos a la técnica computacional
bootstrap:</p>
<div class="caja">
<p><strong>Algoritmo bootstrap para estimar errores estándar</strong></p>
<ol style="list-style-type: decimal">
<li><p>Selecciona <span class="math inline">\(B\)</span> muestras bootstrap independientes:
<span class="math display">\[\textbf{x}^{*1},..., \textbf{x}^{*B}\]</span>.</p></li>
<li><p>Evalúa la replicación bootstrap correspondiente a cada muestra bootstrap:
<span class="math display">\[\hat{\theta}^{*b}=s(\textbf{x}^{*b})\]</span>
para <span class="math inline">\(b=1,2,...,B.\)</span></p></li>
<li><p>Estima el error estándar <span class="math inline">\(se_P(\hat{\theta})\)</span> usando la desviación estándar
muestral de las <span class="math inline">\(B\)</span> replicaciones:
<span class="math display">\[\hat{se}_B = \bigg\{\frac{\sum_{b=1}^B[\hat{\theta}^{*}(b)-\hat{\theta}^*(\cdot)]^2 }{B-1}\bigg\}^{1/2}\]</span></p></li>
</ol>
donde <span class="math display">\[\hat{\theta}^*(\cdot)=\sum_{b=1}^B \theta^{*}(b)/B \]</span>.
</p>
</div>
<p>Notemos que:</p>
<ul>
<li><p>La estimación bootstrap de <span class="math inline">\(se_{P}(\hat{\theta})\)</span>, el error estándar
de una estadística <span class="math inline">\(\hat{\theta}\)</span>, es un estimador <em>plug-in</em> que usa la
función de distribución empírica <span class="math inline">\(P_n\)</span> en lugar de la distribución desconocida
<span class="math inline">\(P\)</span>.</p></li>
<li><p>Conforme el número de replicaciones <span class="math inline">\(B\)</span> aumenta
<span class="math display">\[\hat{se}_B\approx se_{P_n}(\hat{\theta})\]</span>
este hecho equivale a decir que la desviación estándar empírica se acerca a
la desviación estándar poblacional conforme crece el número de muestras. La
<em>población</em> en este caso es la población de valores <span class="math inline">\(\hat{\theta}^*=s(x^*)\)</span>.</p></li>
<li><p>Al estimador de bootstrap ideal <span class="math inline">\(se_{P_n}(\hat{\theta})\)</span> y su aproximación
<span class="math inline">\(\hat{se}_B\)</span> se les denota <strong>estimadores bootstrap no paramétricos</strong> ya que
estan basados en <span class="math inline">\(P_n\)</span>, el estimador no paramétrico de la población <span class="math inline">\(P\)</span>.</p></li>
</ul>
<div id="ejemplo-error-estándar-bootstrap-de-una-media" class="section level4 unnumbered">
<h4>Ejemplo: Error estándar bootstrap de una media</h4>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">mediaBoot &lt;-<span class="st"> </span><span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb189-2" data-line-number="2">  <span class="co"># x: variable de interés</span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3">  <span class="co"># n: número de replicaciones bootstrap</span></a>
<a class="sourceLine" id="cb189-4" data-line-number="4">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb189-5" data-line-number="5">  muestra_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb189-6" data-line-number="6">  <span class="kw">mean</span>(muestra_boot) <span class="co"># replicacion bootstrap de theta_gorro</span></a>
<a class="sourceLine" id="cb189-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb189-8" data-line-number="8">thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">mediaBoot</span>(enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb189-9" data-line-number="9"><span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb189-10" data-line-number="10"><span class="co">#&gt; [1] 3.238793</span></a></code></pre></div>
<p>y se compara con <span class="math inline">\(\hat{se}(\bar{x})\)</span> (estimador <em>plug-in</em> del error estándar):</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">se &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb190-2" data-line-number="2"><span class="kw">se</span>(enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb190-3" data-line-number="3"><span class="co">#&gt; [1] 3.264511</span></a></code></pre></div>
<p><strong>Nota:</strong> Conforme <span class="math inline">\(B\)</span> aumenta <span class="math inline">\(\hat{se}_{B}(\bar{x})\to \{\sum_{i=1}^n(x_i - \bar{x})^2 / n \}^{1/2}\)</span>,
se demuestra con la ley débil de los grandes números.</p>
<p><img src="img/manicule2.jpg" /> Considera el coeficiente de correlación muestral entre la
calificación de <span class="math inline">\(y=\)</span>esp_3 y la de <span class="math inline">\(z=\)</span>esp_6: <span class="math inline">\(\hat{corr}(y,z)=0.9\)</span>. ¿Qué tan
precisa es esta estimación?</p>
</div>
<div id="variación-en-distribuciones-bootstrap" class="section level3 unnumbered">
<h3>Variación en distribuciones bootstrap</h3>
<p>En el proceso de estimación bootstrap hay dos fuentes de variación pues:</p>
<ul>
<li><p>La muestra original se selecciona con aleatoriedad de una población.</p></li>
<li><p>Las muestras bootstrap se seleccionan con aleatoriedad de la muestra
original. Esto es: <em>La estimación bootstrap ideal es un resultado asintótico
<span class="math inline">\(B=\infty\)</span>, en esta caso <span class="math inline">\(\hat{se}_B\)</span> iguala la estimación <em>plug-in</em>
<span class="math inline">\(se_{P_n}\)</span>.</em></p></li>
</ul>
<p>En el proceso de <em>bootstrap</em> podemos controlar la variación del segundo aspecto,
conocida como <strong>implementación de muestreo Monte Carlo</strong>, y la variación
Monte Carlo decrece conforme incrementamos el número de muestras.</p>
<p>Podemos eliminar la variación Monte Carlo si seleccionamos todas las posibles
muestras con reemplazo de tamaño <span class="math inline">\(n\)</span>, hay <span class="math inline">\({2n-1}\choose{n}\)</span> posibles muestras
y si seleccionamos todas obtenemos <span class="math inline">\(\hat{se}_\infty\)</span> (bootstrap ideal), sin
embargo, en la mayor parte de los problemas no es factible proceder así.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">8098</span>)</a>
<a class="sourceLine" id="cb191-2" data-line-number="2">pob_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="dv">-15</span><span class="op">:</span><span class="dv">20</span>), <span class="kw">aes</span>(x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-3" data-line-number="3"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnormm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="dt">mu =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">8</span>), </a>
<a class="sourceLine" id="cb191-4" data-line-number="4">        <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">3</span>)), <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">xintercept =</span> <span class="dv">5</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-6" data-line-number="6"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;mu&#39;</span> =<span class="st"> &#39;red&#39;</span>), <span class="dt">name =</span> <span class="st">&#39;&#39;</span>, </a>
<a class="sourceLine" id="cb191-7" data-line-number="7">        <span class="dt">labels =</span> <span class="kw">expression</span>(mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Población&quot;, color = &quot;&quot;) +</span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9"><span class="st">    theme(axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb191-10" data-line-number="10"></a>
<a class="sourceLine" id="cb191-11" data-line-number="11"><span class="st">samples &lt;- data_frame(sample = 1:6) %&gt;% </span></a>
<a class="sourceLine" id="cb191-12" data-line-number="12"><span class="st">    mutate(</span></a>
<a class="sourceLine" id="cb191-13" data-line-number="13"><span class="st">        sims = rerun(6, rnormm(50, p = c(0.3, 0.7), mu = c(-2, 8), </span></a>
<a class="sourceLine" id="cb191-14" data-line-number="14"><span class="st">            sigma = c(3.5, 3))), </span></a>
<a class="sourceLine" id="cb191-15" data-line-number="15"><span class="st">        x_bar = map_dbl(sims, mean))</span></a>
<a class="sourceLine" id="cb191-16" data-line-number="16"></a>
<a class="sourceLine" id="cb191-17" data-line-number="17"><span class="st"> means_boot &lt;- function(n, sims) {</span></a>
<a class="sourceLine" id="cb191-18" data-line-number="18"><span class="st">    rerun(n, mean(sample(sims, replace = TRUE))) %&gt;%</span></a>
<a class="sourceLine" id="cb191-19" data-line-number="19"><span class="st">        flatten_dbl()</span></a>
<a class="sourceLine" id="cb191-20" data-line-number="20"><span class="st"> }</span></a>
<a class="sourceLine" id="cb191-21" data-line-number="21"><span class="st">samples_boot &lt;- samples %&gt;% </span></a>
<a class="sourceLine" id="cb191-22" data-line-number="22"><span class="st">    mutate(</span></a>
<a class="sourceLine" id="cb191-23" data-line-number="23"><span class="st">        medias_boot_30_1 = map(sims, ~means_boot(n = 30, .)), </span></a>
<a class="sourceLine" id="cb191-24" data-line-number="24"><span class="st">        medias_boot_30_2 = map(sims, ~means_boot(n = 30, .)), </span></a>
<a class="sourceLine" id="cb191-25" data-line-number="25"><span class="st">        medias_boot_1000_1 = map(sims, ~means_boot(n = 1000, .)), </span></a>
<a class="sourceLine" id="cb191-26" data-line-number="26"><span class="st">        medias_boot_1000_2 = map(sims, ~means_boot(n = 1000, .))</span></a>
<a class="sourceLine" id="cb191-27" data-line-number="27"><span class="st">    )</span></a>
<a class="sourceLine" id="cb191-28" data-line-number="28"></a>
<a class="sourceLine" id="cb191-29" data-line-number="29"><span class="st">emp_dists &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb191-30" data-line-number="30"><span class="st">    unnest(cols = sims) %&gt;% </span></a>
<a class="sourceLine" id="cb191-31" data-line-number="31"><span class="st">    rename(obs = sims)</span></a>
<a class="sourceLine" id="cb191-32" data-line-number="32"><span class="st">emp_dists_plots &lt;- ggplot(emp_dists, aes(x = obs)) +</span></a>
<a class="sourceLine" id="cb191-33" data-line-number="33"><span class="st">    geom_histogram(binwidth = 2, alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb191-34" data-line-number="34"><span class="st">    geom_vline(aes(color = &quot;</span>mu<span class="st">&quot;, xintercept = 5), alpha = 0.5, </span></a>
<a class="sourceLine" id="cb191-35" data-line-number="35"><span class="st">      show.legend = FALSE) +</span></a>
<a class="sourceLine" id="cb191-36" data-line-number="36"><span class="st">    geom_vline(aes(xintercept = x_bar, color = &quot;</span>x_bar<span class="st">&quot;), show.legend = FALSE, </span></a>
<a class="sourceLine" id="cb191-37" data-line-number="37"><span class="st">        alpha = 0.8, linetype = &quot;</span>dashed<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb191-38" data-line-number="38"><span class="st">    xlim(-15, 20) +</span></a>
<a class="sourceLine" id="cb191-39" data-line-number="39"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb191-40" data-line-number="40"><span class="st">    labs(x = &quot;&quot;, y = &quot;&quot;, subtitle = expression(&quot;</span>Distribución empírica<span class="st">&quot;~P[n])) +</span></a>
<a class="sourceLine" id="cb191-41" data-line-number="41"><span class="st">    scale_colour_manual(values = c(&#39;mu&#39; = &#39;red&#39;, &#39;x_bar&#39; = &#39;blue&#39;), name = &#39;&#39;, </span></a>
<a class="sourceLine" id="cb191-42" data-line-number="42"><span class="st">        labels = c(expression(mu), expression(bar(x)))) +</span></a>
<a class="sourceLine" id="cb191-43" data-line-number="43"><span class="st">    facet_wrap(~ sample, ncol = 1) +</span></a>
<a class="sourceLine" id="cb191-44" data-line-number="44"><span class="st">    theme(strip.background = element_blank(), strip.text.x = element_blank(), </span></a>
<a class="sourceLine" id="cb191-45" data-line-number="45"><span class="st">        axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb191-46" data-line-number="46"><span class="st"> </span></a>
<a class="sourceLine" id="cb191-47" data-line-number="47"><span class="st">boot_dists_30 &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb191-48" data-line-number="48"><span class="st">    unnest(cols = c(medias_boot_30_1, medias_boot_30_2)) %&gt;% </span></a>
<a class="sourceLine" id="cb191-49" data-line-number="49"><span class="st">    pivot_longer(cols = c(medias_boot_30_1, medias_boot_30_2), </span></a>
<a class="sourceLine" id="cb191-50" data-line-number="50"><span class="st">    values_to = &quot;</span>mu_hat_star<span class="st">&quot;, names_to = &quot;</span>boot_trial<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb191-51" data-line-number="51"><span class="st">    names_prefix = &quot;</span>medias_boot_<span class="dv">30</span>_<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb191-52" data-line-number="52"><span class="st">boot_dists_30_plot &lt;- ggplot(boot_dists_30, aes(x = mu_hat_star)) +</span></a>
<a class="sourceLine" id="cb191-53" data-line-number="53"><span class="st">    geom_histogram(alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb191-54" data-line-number="54"><span class="st">    labs(x = &quot;&quot;, y = &quot;&quot;,</span></a>
<a class="sourceLine" id="cb191-55" data-line-number="55"><span class="st">        subtitle = expression(&quot;</span>Distribución bootstrap <span class="dt">B =</span> <span class="dv">30</span><span class="st">&quot;)) +</span></a>
<a class="sourceLine" id="cb191-56" data-line-number="56"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb191-57" data-line-number="57"><span class="st">    geom_vline(aes(xintercept = x_bar), color = &quot;</span>blue<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb191-58" data-line-number="58"><span class="st">        linetype = &quot;</span>dashed<span class="st">&quot;, alpha = 0.8) +</span></a>
<a class="sourceLine" id="cb191-59" data-line-number="59"><span class="st">    facet_grid(sample~boot_trial) +</span></a>
<a class="sourceLine" id="cb191-60" data-line-number="60"><span class="st">    theme(strip.background = element_blank(), strip.text.y = element_blank(), </span></a>
<a class="sourceLine" id="cb191-61" data-line-number="61"><span class="st">        axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb191-62" data-line-number="62"></a>
<a class="sourceLine" id="cb191-63" data-line-number="63"><span class="st">boot_dists_1000 &lt;- samples_boot %&gt;% </span></a>
<a class="sourceLine" id="cb191-64" data-line-number="64"><span class="st">    unnest(cols = c(medias_boot_1000_1, medias_boot_1000_2)) %&gt;% </span></a>
<a class="sourceLine" id="cb191-65" data-line-number="65"><span class="st">    pivot_longer(cols = c(medias_boot_1000_1, medias_boot_1000_2), </span></a>
<a class="sourceLine" id="cb191-66" data-line-number="66"><span class="st">    values_to = &quot;</span>mu_hat_star<span class="st">&quot;, names_to = &quot;</span>boot_trial<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb191-67" data-line-number="67"><span class="st">    names_prefix = &quot;</span>medias_boot_<span class="dv">1000</span>_<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb191-68" data-line-number="68"><span class="st">boot_dists_1000_plot &lt;- ggplot(boot_dists_1000, aes(x = mu_hat_star)) +</span></a>
<a class="sourceLine" id="cb191-69" data-line-number="69"><span class="st">    geom_histogram(alpha = 0.5, fill = &quot;</span>darkgray<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb191-70" data-line-number="70"><span class="st">    labs(subtitle = expression(&quot;</span>Distribución bootstrap <span class="dt">B =</span> <span class="dv">1000</span><span class="st">&quot;), </span></a>
<a class="sourceLine" id="cb191-71" data-line-number="71"><span class="st">       x = &quot;&quot;, y = &quot;&quot;) +</span></a>
<a class="sourceLine" id="cb191-72" data-line-number="72"><span class="st">    geom_vline(xintercept = 5, color = &quot;</span>red<span class="st">&quot;, alpha = 0.5) +</span></a>
<a class="sourceLine" id="cb191-73" data-line-number="73"><span class="st">    geom_vline(aes(xintercept = x_bar), color = &quot;</span>blue<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb191-74" data-line-number="74"><span class="st">        linetype = &quot;</span>dashed<span class="st">&quot;, alpha = 0.8) +</span></a>
<a class="sourceLine" id="cb191-75" data-line-number="75"><span class="st">    facet_grid(sample~boot_trial) +</span></a>
<a class="sourceLine" id="cb191-76" data-line-number="76"><span class="st">    scale_colour_manual(values = c(&#39;mu&#39; = &#39;red&#39;, &#39;x_bar&#39; = &#39;blue&#39;), name = &#39;&#39;,</span></a>
<a class="sourceLine" id="cb191-77" data-line-number="77"><span class="st">    labels = c(expression(mu), expression(bar(x)))) +</span></a>
<a class="sourceLine" id="cb191-78" data-line-number="78"><span class="st">    theme(strip.background = element_blank(), strip.text.y = element_blank(), </span></a>
<a class="sourceLine" id="cb191-79" data-line-number="79"><span class="st">        strip.text.x = element_blank(), axis.text.y = element_blank())</span></a>
<a class="sourceLine" id="cb191-80" data-line-number="80"></a>
<a class="sourceLine" id="cb191-81" data-line-number="81"><span class="st">(pob_plot | plot_spacer() | plot_spacer()) /</span></a>
<a class="sourceLine" id="cb191-82" data-line-number="82"><span class="st">(emp_dists_plots | boot_dists_30_plot | boot_dists_1000_plot) +</span></a>
<a class="sourceLine" id="cb191-83" data-line-number="83"><span class="st">plot_layout(heights = c(1, 5))</span></a></code></pre></div>
<p>En la siguiente gráfica mostramos 6 posibles muestras de tamaño 50 simuladas de
la población, para cada una de ellas se graficó la distribución empírica y se
se realizan histogramas de la distribución bootstrap con <span class="math inline">\(B=30\)</span> y <span class="math inline">\(B=1000\)</span>, en
cada caso hacemos dos repeticiones, notemos que cuando el número de muestras
bootstrap es grande las distribuciones bootstrap son muy similares (para una
muestra de la población dada), esto es porque disminuimos el erro Monte Carlo.
También vale la pena recalcar que la distribución bootstrap está centrada en el
valor observado en la muestra (línea azúl punteada) y no en el valor poblacional
sin embargo la forma de la distribución es similar a lo largo de las filas.</p>
<p><img src="img/bootstrap_mc_error.png" /></p>
<!--
* En la práctica para elegir el tamaño de $B$ debemos considerar que buscamos 
las mismas propiedades para la estimación de un error estándar que para 
cualquier estimación: poco sesgo y desviación estándar chica. El sesgo de la 
estifmación bootstrap del error estándar suele ser bajo y el error estándar está

 Una respuesta aproximada es en términos del coeficiente de variación de 
$\hat{se}_B$, esto es el cociente de la desviación estándar de $\hat{se}_B$ y su 
valor esperado, la variabilidad adicional de parar en $B$ replicaciones en lugar 
de seguir hasta infiniti se refleja en un incremento en el coeficiente de 
variación
-->
<p>Entonces, ¿cuántas muestras bootstrap?</p>
<ol style="list-style-type: decimal">
<li><p>Incluso un número chico de replicaciones bootstrap, digamos <span class="math inline">\(B=25\)</span> es
informativo, y <span class="math inline">\(B=50\)</span> con frecuencia es suficiente para dar una buena
estimación de <span class="math inline">\(se_P(\hat{\theta})\)</span> (<span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>).</p></li>
<li><p>Cuando se busca estimar error estándar <span class="citation">Hesterberg (<a href="#ref-tim">2015</a>)</span> recomienda <span class="math inline">\(B=1000\)</span> muestras, o
<span class="math inline">\(B=10,000\)</span> muestras dependiendo la presición que se busque.</p></li>
</ol>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1">seMediaBoot &lt;-<span class="st"> </span><span class="cf">function</span>(x, B){</a>
<a class="sourceLine" id="cb192-2" data-line-number="2">    thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">mediaBoot</span>(x)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb192-3" data-line-number="3">    <span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb192-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb192-5" data-line-number="5"></a>
<a class="sourceLine" id="cb192-6" data-line-number="6">B_muestras &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">n_sims =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">3000</span>, </a>
<a class="sourceLine" id="cb192-7" data-line-number="7">    <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb192-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">est =</span> <span class="kw">map_dbl</span>(n_sims, <span class="op">~</span><span class="kw">seMediaBoot</span>(<span class="dt">x =</span> enlace_muestra<span class="op">$</span>esp_<span class="dv">3</span>, <span class="dt">B =</span> .)))</a>
<a class="sourceLine" id="cb192-9" data-line-number="9"><span class="co">#&gt; Warning: `data_frame()` is deprecated, use `tibble()`.</span></a>
<a class="sourceLine" id="cb192-10" data-line-number="10"><span class="co">#&gt; This warning is displayed once per session.</span></a>
<a class="sourceLine" id="cb192-11" data-line-number="11">B_muestras</a>
<a class="sourceLine" id="cb192-12" data-line-number="12"><span class="co">#&gt; # A tibble: 12 x 2</span></a>
<a class="sourceLine" id="cb192-13" data-line-number="13"><span class="co">#&gt;    n_sims   est</span></a>
<a class="sourceLine" id="cb192-14" data-line-number="14"><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb192-15" data-line-number="15"><span class="co">#&gt;  1      5  3.08</span></a>
<a class="sourceLine" id="cb192-16" data-line-number="16"><span class="co">#&gt;  2     25  3.20</span></a>
<a class="sourceLine" id="cb192-17" data-line-number="17"><span class="co">#&gt;  3     50  3.17</span></a>
<a class="sourceLine" id="cb192-18" data-line-number="18"><span class="co">#&gt;  4    100  3.04</span></a>
<a class="sourceLine" id="cb192-19" data-line-number="19"><span class="co">#&gt;  5    200  3.36</span></a>
<a class="sourceLine" id="cb192-20" data-line-number="20"><span class="co">#&gt;  6    400  3.24</span></a>
<a class="sourceLine" id="cb192-21" data-line-number="21"><span class="co">#&gt;  7   1000  3.17</span></a>
<a class="sourceLine" id="cb192-22" data-line-number="22"><span class="co">#&gt;  8   1500  3.38</span></a>
<a class="sourceLine" id="cb192-23" data-line-number="23"><span class="co">#&gt;  9   3000  3.27</span></a>
<a class="sourceLine" id="cb192-24" data-line-number="24"><span class="co">#&gt; 10   5000  3.29</span></a>
<a class="sourceLine" id="cb192-25" data-line-number="25"><span class="co">#&gt; 11  10000  3.27</span></a>
<a class="sourceLine" id="cb192-26" data-line-number="26"><span class="co">#&gt; 12  20000  3.26</span></a></code></pre></div>
<div id="ejemplo-componentes-principales-calificaciones-en-exámenes" class="section level4 unnumbered">
<h4>Ejemplo componentes principales: calificaciones en exámenes</h4>
<p>Los datos <em>marks</em> (Mardia, Kent y Bibby, 1979) contienen los puntajes de 88
estudiantes en 5 pruebas: mecánica, vectores, álgebra, análisis y estadística.
Cada renglón corresponde a la calificación de un estudiante en cada prueba.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw">data</span>(marks, <span class="dt">package =</span> <span class="st">&quot;ggm&quot;</span>)</a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="kw">glimpse</span>(marks)</a>
<a class="sourceLine" id="cb193-3" data-line-number="3"><span class="co">#&gt; Observations: 88</span></a>
<a class="sourceLine" id="cb193-4" data-line-number="4"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb193-5" data-line-number="5"><span class="co">#&gt; $ mechanics  &lt;dbl&gt; 77, 63, 75, 55, 63, 53, 51, 59, 62, 64, 52, 55, 50, 65, 31…</span></a>
<a class="sourceLine" id="cb193-6" data-line-number="6"><span class="co">#&gt; $ vectors    &lt;dbl&gt; 82, 78, 73, 72, 63, 61, 67, 70, 60, 72, 64, 67, 50, 63, 55…</span></a>
<a class="sourceLine" id="cb193-7" data-line-number="7"><span class="co">#&gt; $ algebra    &lt;dbl&gt; 67, 80, 71, 63, 65, 72, 65, 68, 58, 60, 60, 59, 64, 58, 60…</span></a>
<a class="sourceLine" id="cb193-8" data-line-number="8"><span class="co">#&gt; $ analysis   &lt;dbl&gt; 67, 70, 66, 70, 70, 64, 65, 62, 62, 62, 63, 62, 55, 56, 57…</span></a>
<a class="sourceLine" id="cb193-9" data-line-number="9"><span class="co">#&gt; $ statistics &lt;dbl&gt; 81, 81, 81, 68, 63, 73, 68, 56, 70, 45, 54, 44, 63, 37, 73…</span></a></code></pre></div>
<p>Entonces un análisis de componentes principales proseguiría como sigue:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">pc_marks &lt;-<span class="st"> </span><span class="kw">princomp</span>(marks)</a>
<a class="sourceLine" id="cb194-2" data-line-number="2"><span class="kw">summary</span>(pc_marks)</a>
<a class="sourceLine" id="cb194-3" data-line-number="3"><span class="co">#&gt; Importance of components:</span></a>
<a class="sourceLine" id="cb194-4" data-line-number="4"><span class="co">#&gt;                            Comp.1     Comp.2      Comp.3     Comp.4     Comp.5</span></a>
<a class="sourceLine" id="cb194-5" data-line-number="5"><span class="co">#&gt; Standard deviation     26.0600955 14.1291852 10.13060363 9.15149631 5.63935825</span></a>
<a class="sourceLine" id="cb194-6" data-line-number="6"><span class="co">#&gt; Proportion of Variance  0.6191097  0.1819910  0.09355915 0.07634838 0.02899179</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7"><span class="co">#&gt; Cumulative Proportion   0.6191097  0.8011007  0.89465983 0.97100821 1.00000000</span></a>
<a class="sourceLine" id="cb194-8" data-line-number="8"><span class="kw">loadings</span>(pc_marks)</a>
<a class="sourceLine" id="cb194-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb194-10" data-line-number="10"><span class="co">#&gt; Loadings:</span></a>
<a class="sourceLine" id="cb194-11" data-line-number="11"><span class="co">#&gt;            Comp.1 Comp.2 Comp.3 Comp.4 Comp.5</span></a>
<a class="sourceLine" id="cb194-12" data-line-number="12"><span class="co">#&gt; mechanics   0.505  0.749  0.301  0.295       </span></a>
<a class="sourceLine" id="cb194-13" data-line-number="13"><span class="co">#&gt; vectors     0.368  0.207 -0.419 -0.781  0.190</span></a>
<a class="sourceLine" id="cb194-14" data-line-number="14"><span class="co">#&gt; algebra     0.346        -0.146        -0.924</span></a>
<a class="sourceLine" id="cb194-15" data-line-number="15"><span class="co">#&gt; analysis    0.451 -0.301 -0.594  0.521  0.286</span></a>
<a class="sourceLine" id="cb194-16" data-line-number="16"><span class="co">#&gt; statistics  0.535 -0.547  0.600 -0.178  0.151</span></a>
<a class="sourceLine" id="cb194-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb194-18" data-line-number="18"><span class="co">#&gt;                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5</span></a>
<a class="sourceLine" id="cb194-19" data-line-number="19"><span class="co">#&gt; SS loadings       1.0    1.0    1.0    1.0    1.0</span></a>
<a class="sourceLine" id="cb194-20" data-line-number="20"><span class="co">#&gt; Proportion Var    0.2    0.2    0.2    0.2    0.2</span></a>
<a class="sourceLine" id="cb194-21" data-line-number="21"><span class="co">#&gt; Cumulative Var    0.2    0.4    0.6    0.8    1.0</span></a>
<a class="sourceLine" id="cb194-22" data-line-number="22"><span class="kw">plot</span>(pc_marks, <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/pc-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">biplot</span>(pc_marks)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Los cálculos de un análisis de componentes principales involucran la matriz de
covarianzas empírica <span class="math inline">\(G\)</span> (estimaciones <em>plug-in</em>)</p>
<p><span class="math display">\[G_{jk} = \frac{1}{88}\sum_{i=1}^88(x_{ij}-\bar{x_j})(x_{ik}-\bar{x_k})\]</span></p>
<p>para <span class="math inline">\(j,k=1,2,3,4,5\)</span>, y donde <span class="math inline">\(\bar{x_j} = \sum_{i=1}^88 x_{ij} / 88\)</span> (la media
de la i-ésima columna).</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1">G &lt;-<span class="st"> </span><span class="kw">cov</span>(marks) <span class="op">*</span><span class="st"> </span><span class="dv">87</span> <span class="op">/</span><span class="st"> </span><span class="dv">88</span></a>
<a class="sourceLine" id="cb196-2" data-line-number="2">G</a>
<a class="sourceLine" id="cb196-3" data-line-number="3"><span class="co">#&gt;            mechanics   vectors   algebra  analysis statistics</span></a>
<a class="sourceLine" id="cb196-4" data-line-number="4"><span class="co">#&gt; mechanics   302.2147 125.59969 100.31599 105.11415  116.15819</span></a>
<a class="sourceLine" id="cb196-5" data-line-number="5"><span class="co">#&gt; vectors     125.5997 170.87810  84.18957  93.59711   97.88688</span></a>
<a class="sourceLine" id="cb196-6" data-line-number="6"><span class="co">#&gt; algebra     100.3160  84.18957 111.60318 110.83936  120.48567</span></a>
<a class="sourceLine" id="cb196-7" data-line-number="7"><span class="co">#&gt; analysis    105.1142  93.59711 110.83936 217.87603  153.76808</span></a>
<a class="sourceLine" id="cb196-8" data-line-number="8"><span class="co">#&gt; statistics  116.1582  97.88688 120.48567 153.76808  294.37177</span></a></code></pre></div>
<p>Los <em>pesos</em> y las <em>componentes principales</em> no son mas que los eigenvalores y
eigenvectores de la matriz de covarianzas <span class="math inline">\(G\)</span>, estos se calculan a través de una
serie de de manipulaciones algebraicas que requieren cálculos del orden de p<sup>3</sup>
(cuando G es una matriz de tamaño p<span class="math inline">\(\times\)</span>p).</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1">eigen_G &lt;-<span class="st"> </span><span class="kw">eigen</span>(G)</a>
<a class="sourceLine" id="cb197-2" data-line-number="2">lambda &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>values</a>
<a class="sourceLine" id="cb197-3" data-line-number="3">v &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb197-4" data-line-number="4">lambda</a>
<a class="sourceLine" id="cb197-5" data-line-number="5"><span class="co">#&gt; [1] 679.12858 199.63388 102.62913  83.74988  31.80236</span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6">v</a>
<a class="sourceLine" id="cb197-7" data-line-number="7"><span class="co">#&gt;           [,1]        [,2]       [,3]         [,4]        [,5]</span></a>
<a class="sourceLine" id="cb197-8" data-line-number="8"><span class="co">#&gt; [1,] 0.5053373  0.74917585  0.3006046  0.294631757 -0.07873256</span></a>
<a class="sourceLine" id="cb197-9" data-line-number="9"><span class="co">#&gt; [2,] 0.3682215  0.20692361 -0.4185473 -0.781332853 -0.18955902</span></a>
<a class="sourceLine" id="cb197-10" data-line-number="10"><span class="co">#&gt; [3,] 0.3456083 -0.07622065 -0.1457830 -0.003348995  0.92384059</span></a>
<a class="sourceLine" id="cb197-11" data-line-number="11"><span class="co">#&gt; [4,] 0.4512152 -0.30063472 -0.5944322  0.520724416 -0.28551729</span></a>
<a class="sourceLine" id="cb197-12" data-line-number="12"><span class="co">#&gt; [5,] 0.5347961 -0.54747360  0.5998773 -0.177611847 -0.15121842</span></a></code></pre></div>
<ol style="list-style-type: decimal">
<li>Proponemos el siguiente modelo simple para puntajes correlacionados:</li>
</ol>
<p><span class="math display">\[\textbf{x}_i = Q_i \textbf{v}\]</span></p>
<p>donde <span class="math inline">\(\textbf{x}_i\)</span> es la tupla de calificaciones del i-ésimo estudiante,
<span class="math inline">\(Q_i\)</span> es un número que representa la habilidad del estudiante y <span class="math inline">\(\textbf{v}\)</span> es
un vector fijo con 5 números que aplica a todos los estudiantes. Si este modelo
simple fuera cierto, entonces únicamente el <span class="math inline">\(\hat{\lambda}_1\)</span> sería positivo
y <span class="math inline">\(\textbf{v} = \hat{v}_1\)</span>.
Sea <span class="math display">\[\hat{\theta}=\sum_{i=1}^5\hat{\lambda}_i\]</span>
el modelo propuesto es equivalente a <span class="math inline">\(\hat{\theta}=1\)</span>, inculso si el modelo es
correcto, no esperamos que <span class="math inline">\(\hat{\theta}\)</span> sea exactamente uno pues hay ruido en
los datos.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">theta_hat &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb198-2" data-line-number="2">theta_hat</a>
<a class="sourceLine" id="cb198-3" data-line-number="3"><span class="co">#&gt; [1] 0.6191097</span></a></code></pre></div>
<p>El valor de <span class="math inline">\(\hat{\theta}\)</span> mide el porcentaje de la varianza explicada en la
primer componente principal, ¿qué tan preciso es <span class="math inline">\(\hat{\theta}\)</span>? La complejidad
matemática en el cálculo de <span class="math inline">\(\hat{\theta}\)</span> es irrelevante siempre y cuando
podamos calcular <span class="math inline">\(\hat{\theta}^*\)</span> para una muestra bootstrap, en esta caso una
muestra bootsrtap es una base de datos de 88 <span class="math inline">\(\times\)</span> 5 <span class="math inline">\(\textbf{X}^*\)</span>, donde las
filas <span class="math inline">\(\bf{x_i}^*\)</span> de <span class="math inline">\(\textbf{X}^*\)</span> son una muestra aleatoria de tamaño
88 de la verdadera matriz de datos.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1">pc_boot &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb199-2" data-line-number="2">    muestra_boot &lt;-<span class="st"> </span><span class="kw">sample_n</span>(marks, <span class="dt">size =</span> <span class="dv">88</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb199-3" data-line-number="3">    G &lt;-<span class="st"> </span><span class="kw">cov</span>(muestra_boot) <span class="op">*</span><span class="st"> </span><span class="dv">87</span> <span class="op">/</span><span class="st"> </span><span class="dv">88</span> </a>
<a class="sourceLine" id="cb199-4" data-line-number="4">    eigen_G &lt;-<span class="st"> </span><span class="kw">eigen</span>(G)</a>
<a class="sourceLine" id="cb199-5" data-line-number="5">    theta_hat &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>values[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigen_G<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb199-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb199-7" data-line-number="7">B &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb199-8" data-line-number="8">thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">pc_boot</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a></code></pre></div>
<p>Veamos un histograma de las replicaciones de <span class="math inline">\(\hat{\theta}\)</span>:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(<span class="dt">theta =</span> thetas_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="fl">0.02</span>, </a>
<a class="sourceLine" id="cb200-3" data-line-number="3">        <span class="dt">fill =</span> <span class="st">&quot;gray40&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(theta)), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-5" data-line-number="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(theta)<span class="op">^</span><span class="st">&quot;*&quot;</span>), <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/pc_hist-1.png" width="300px" style="display: block; margin: auto;" /></p>
<p>Estas tienen un error estándar</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1">theta_se &lt;-<span class="st"> </span><span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb201-2" data-line-number="2">theta_se</a>
<a class="sourceLine" id="cb201-3" data-line-number="3"><span class="co">#&gt; [1] 0.04657769</span></a></code></pre></div>
<p>y media</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1"><span class="kw">mean</span>(thetas_boot)</a>
<a class="sourceLine" id="cb202-2" data-line-number="2"><span class="co">#&gt; [1] 0.6199592</span></a></code></pre></div>
<p>la media de las replicaciones es muy similar a la estimación <span class="math inline">\(\hat{\theta}\)</span>,
esto indica que <span class="math inline">\(\hat{\theta}\)</span> es cercano a insesgado.</p>
<ol start="2" style="list-style-type: decimal">
<li>El eigenvetor <span class="math inline">\(\hat{v}_1\)</span> correspondiente al mayor eigenvalor se conoce
como primera componente de <span class="math inline">\(G\)</span>, supongamos que deseamos resumir la calificación
de los estudiantes mediante un único número, entonces la mejor combinación
lineal de los puntajes es</li>
</ol>
<p><span class="math display">\[y_i = \sum_{k = 1}^5 \hat{v}_{1k}x_{ik}\]</span></p>
<p>esto es, la combinación lineal que utiliza las componentes de <span class="math inline">\(\hat{v}_1\)</span> como
ponderadores. Si queremos un resumen compuesto por dos números <span class="math inline">\((y_i,z_i)\)</span>, la
segunda combinación lineal debería ser:</p>
<p><span class="math display">\[z_i = \sum_{k = 1}^5 \hat{v}_{2k}x_{ik}\]</span></p>
<p><img src="img/manicule2.jpg" /> Las componentes principales <span class="math inline">\(\hat{v}_1\)</span> y
<span class="math inline">\(\hat{v}_2\)</span> son estadísticos, usa bootstrap para dar una medición de su
variabilidad calculando el error estándar de cada una.</p>
</div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-efron">
<p>Efron, Bradley, and Robert J. Tibshirani. 1993. <em>An Introduction to the Bootstrap</em>. Monographs on Statistics and Applied Probability 57. Boca Raton, Florida, USA: Chapman &amp; Hall/CRC.</p>
</div>
<div id="ref-tim">
<p>Hesterberg, Tim C. 2015. “What Teachers Should Know About the Bootstrap: Resampling in the Undergraduate Statistics Curriculum.” <em>The American Statistician</em> 69 (4). Taylor &amp; Francis:371–86. <a href="https://doi.org/10.1080/00031305.2015.1089789" class="uri">https://doi.org/10.1080/00031305.2015.1089789</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="el-principio-del-plug-in.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intervalos-de-confianza.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/05-bootstrap_no_parametrico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
