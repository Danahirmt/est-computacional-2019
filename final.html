<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Final | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Final | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Final | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-jerárquicos-1.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#ejemplo-estimación-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html"><i class="fa fa-check"></i><b>10.11</b> Inicialesy Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html#iniciales-en-stan"><i class="fa fa-check"></i>Iniciales en Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="reparametrización.html"><a href="reparametrización.html"><i class="fa fa-check"></i><b>10.12</b> Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#ejemplo-el-embudo-de-neal"><i class="fa fa-check"></i>Ejemplo: El embudo de Neal</a></li>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#modelos-jerárquicos-y-parametrización-no-centrada"><i class="fa fa-check"></i>Modelos jerárquicos y parametrización no centrada</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="recursos-de-stan-y-paquetes-con-r.html"><a href="recursos-de-stan-y-paquetes-con-r.html"><i class="fa fa-check"></i><b>10.13</b> Recursos de Stan y paquetes con R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i>Final</a><ul>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#inferencia-gráfica"><i class="fa fa-check"></i>1. Inferencia gráfica</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#simulación-para-el-cálculo-de-tamaños-de-muestra"><i class="fa fa-check"></i>2. Simulación para el cálculo de tamaños de muestra</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#mcmc-1"><i class="fa fa-check"></i>3. MCMC</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#modelos-jerárquicos-y-stan"><i class="fa fa-check"></i>4. Modelos jerárquicos y Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="final" class="section level2 unnumbered">
<h2>Final</h2>
<ul>
<li><p>Puede realizarse individual o en parejas.</p></li>
<li><p>Enviar por correo electónico documento final (html ó pdf).</p></li>
<li><p>Entregar <strong>jueves 12 de diciembre antes de las 18:00 hr</strong>, después de eso se
califica sobre 7 (máximo entregar sábado 14 a las 13:00 hrs).</p></li>
<li><p>Incluir código y respuestas que describan lo que se hizo.</p></li>
<li><p>Dudas y artículo para pregunta 3 <a href="https://drive.google.com/open?id=1IadZgMhrTAsll8YLLwcnBhk17UcwOdtK">aquí</a>.</p></li>
</ul>
<div id="inferencia-gráfica" class="section level3 unnumbered">
<h3>1. Inferencia gráfica</h3>
<p>Para este ejercicio utilizaremos los datos de un estudio
longitudinal de <em>Singer y Willet 2003</em> (wages). En este estudio se visitó a
hombres en edad laboral que habitan en EUA, se visitó a cada sujeto entre 1 y 13
veces, en cada visita se registraró, entre otras variables:</p>
<pre><code>id: identificador de sujeto  
hgc: grado de educación más alto completado  
lnw : logaritmo natural del salario  
exper: años de experiencia laboral  
raza: hispanic, black, white (si las dos primeras son cero)</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1">wages &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/wages.csv&quot;</span>)</a></code></pre></div>
<p>El objetivo del ejercicio es estudiar la relación entre salario y experiencia
laboral por raza para aquellos sujetos cuyo año máximo de estudios completados
es igual a 9, 10 u 11, estos son sujetos que abandonaron sus estudios durante
preparatoria. Seguiremos un enfoque no paramétrico que consiste en ajustar un
suavizador para cada grupo de raza (blanco, hispano o negro) como se muestra
en la siguiente gráfica.</p>
<p><img src="img/wages.png" /></p>
<p>Utilizaremos una prueba de hipótesis gráfica para determinar si existe una
diferencia significativa entre las curvas.</p>
<ol style="list-style-type: decimal">
<li><strong>Preparación de los datos</strong>.</li>
</ol>
<ul>
<li><p>Selecciona los sujetos con grado de estudios completado igual a 9, 10 u 11.</p></li>
<li><p>Elimina las observaciones donde el logaritmo del salario (lnw) es mayor a 3.5.</p></li>
<li><p>Crea una variable correspondiente a raza, un sujeto es de raza hispana si
la variable hispanic toma el valor 1, de raza negra si la variable black
toma el valor 1 y de raza blanca si las dos anteriores son cero.</p></li>
<li><p>Crea un subconjunto de la base de datos de tal manera que tengas el mismo
número de sujetos distintos en cada grupo de raza. Nota: habrá el mismo número
de sujetos en cada grupo pero el número de observaciones puede diferir pues los
sujetos fueron visitados un número distinto de veces.</p></li>
</ul>
<p>2 <strong>Prueba de hipótesis visual</strong></p>
<ul>
<li><p>El escenario nulo consiste en que no hay diferencia entre las razas. Para
generar los datos nulos, la etiqueta de raza de cada sujeto se permuta,
es decir, se reasigna la raza de cada sujeto de manera aleatoria (para todas las
mediciones de un sujeto dado se reasigna una misma raza). Genera 9 conjuntos de
datos nulos y para cada uno ajusta una curva <em>loess</em> siguiendo la instrucción de
la gráfica de arriba. Crea una gráfica de paneles donde incluyas los 9
conjuntos nulos y los datos reales, estos últimos estarán escondidos de manera
aleatoria.</p></li>
<li><p>Realiza la siguiente pregunta a una o más personas <strong>que no tomen la clase</strong>:</p></li>
</ul>
<p><em>Las siguientes 10 gráficas muestran suavizamientos de log(salarios) por años
de experiencia laboral. Una de ellas usa datos reales y las otras 9 son datos
nulos, generados bajo el supuesto de que no existe diferencia entre los
subgrupos. ¿Cuál es la gráfica más distinta?</em></p>
<p>Reporta si las personas cuestionadas pudieron distinguir los datos.</p>
<ul>
<li><p>¿Cuál es tu conclusión de la prueba de hipótesis visual?</p></li>
<li><p>¿A cuántas personas preguntaste y cuál es el valor p de la prueba?</p></li>
</ul>
</div>
<div id="simulación-para-el-cálculo-de-tamaños-de-muestra" class="section level3 unnumbered">
<h3>2. Simulación para el cálculo de tamaños de muestra</h3>
<p>En el conteo rápido del estado de Guanajuato, se calculó el tamaño de muestra
fijando como objetivo que los intervalos del <span class="math inline">\(95\)</span>% de confianza tuvieran una
longitud máxima de 2 puntos porcentuales para todos los candidatos. En este
ejercicio calcularás el tamaño de muestra mínimo que cumpla con el objetivo
usando 3 diseños de muestreo distintos: 1) muestreo aleatorio simple (MAS),
2) estratificando con distrito local y 3) estratificando con distrito federal.</p>
<p>Utilizarás simulación y los resultados de las elecciones de gobernador en
Guanajuato correspondientes al 2012.</p>
<p>En el caso de <strong>MAS</strong>, para cada tamaño de muestra
<span class="math inline">\(n=50,100,200,300,400,500,600,700\)</span>:</p>
<ol style="list-style-type: lower-roman">
<li><p>Simula una muestra aleatoria de tamaño <span class="math inline">\(n\)</span>.</p></li>
<li><p>Calcula el estimador de razón (correspondiente a muestreo aleatorio simple)
para cada candidato:</p></li>
</ol>
<p><span class="math display">\[\hat{p}=\frac{\sum_{i} Y_{i}}{\sum_i X_{i}}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\hat{p}\)</span> es la estimación de la proporción de votos que recibió el candidato
en la elección.</p></li>
<li><p><span class="math inline">\(Y_{i}\)</span> es el número total de votos que recibió el candidato
en la <span class="math inline">\(i\)</span>-ésima casilla.</p></li>
<li><p><span class="math inline">\(X_{i}\)</span> es el número total de votos en la <span class="math inline">\(i\)</span>-ésima casilla.</p></li>
</ul>
<ol start="3" style="list-style-type: lower-roman">
<li>Repite los pasos i y ii <span class="math inline">\(1000\)</span> veces para estimar el error estándar para
una muestra de tamaño <span class="math inline">\(n\)</span>.</li>
</ol>
<p>Para cada <strong>estratificación</strong> (<code>distrito_fed_17</code> y <code>distrito_loc_17</code>) y
tamaño de muestra <span class="math inline">\(n=50,100,200,300,400,500,600,700\)</span>:</p>
<ol style="list-style-type: lower-roman">
<li>Simula una muestra estratificada de tamaño <span class="math inline">\(n\)</span>, donde el tamaño de muestra en
cada estrato se asigna proporcional al tamaño del estrato, esto es, sea <span class="math inline">\(N_h\)</span> el
número de casillas en el <span class="math inline">\(h\)</span>-ésimo estrato, entonces para el estrato <span class="math inline">\(h\)</span> el
número de casillas en la muestra será:
<span class="math display">\[n_h = N_h \cdot \frac{n}{\sum_j N_j}\]</span></li>
<li>Calcula el estimador de razón combinado (correspondiente a muestreo
estratificado) para cada candidato:</li>
</ol>
<p><span class="math display">\[\hat{p}=\frac{\sum_h \frac{N_h}{n_h} \sum_i Y_{hi}}{\sum_h \frac{N_h}{n_h} \sum_i X_{hi}}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\hat{p}\)</span> es la estimación de la proporción de votos que recibió el candidato
en la elección.</p></li>
<li><p><span class="math inline">\(Y_{hi}\)</span> es el número total de votos que recibió el candidato
en la <span class="math inline">\(i\)</span>-ésima casillas, que pertence al <span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(X_{hi}\)</span> es el número total de votos en la <span class="math inline">\(i\)</span>-ésima casilla, que pertence al
<span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(N_h\)</span> es el número total de casillas en el <span class="math inline">\(h\)</span>-ésimo estrato.</p></li>
<li><p><span class="math inline">\(n_h\)</span> es el número de casillas del <span class="math inline">\(h\)</span>-ésimo estrato que se seleccionaron en
la muestra.</p></li>
</ul>
<ol start="3" style="list-style-type: lower-roman">
<li>Repite los pasos i y ii <span class="math inline">\(1000\)</span> veces para estimar el error estándar para
una muestra de tamaño <span class="math inline">\(n\)</span>.</li>
</ol>
<p>Ahora:</p>
<ol style="list-style-type: decimal">
<li><p>Reporta en una tabla el error estándar para cada candidato, tamaño de muestra
y diseño (MAS y las dos estratificaciones propuestas).</p></li>
<li><p>Grafica los datos de la tabla: realiza una gráfica de paneles (con
<code>facet_wrap()</code>), cada partido en un panel, en el eje horizontal grafica el
tamaño de muestra y en el eje vertical el error estándar, tendrás en una misma
gráfica tres curvas, una para muestreo aleatorio simple y una para
cada estratificación.</p></li>
<li><p>¿Qué diseño y tamaño de muestra elegirías? Explica tu respuesta y de
ser necesario repite los pasos i-iii para otros valores de <span class="math inline">\(n\)</span>.</p></li>
</ol>
</div>
<div id="mcmc-1" class="section level3 unnumbered">
<h3>3. MCMC</h3>
<p>Siguiendo con el conteo rápido de Guanajuato, calcularás intervalos de confianza
usando el modelo propuesto en <span class="citation">Mendoza and Nieto-Barajas (<a href="#ref-mendoza2016">2016</a>)</span>.</p>
<p>Los autores proponen ajustar un modelo de manera independiente para cada
candidato en cada estrato:</p>
<ul>
<li>Verosimilitud</li>
</ul>
<p><span class="math display">\[X_{ij}^k\big|\theta_{ij},\tau_{ij}\sim N\bigg(n_i^k\theta_{ij}, \frac{\tau_{ij}}{n_i^k}\bigg)\]</span></p>
<p>para <span class="math inline">\(k=1,...,c_i\)</span>, <span class="math inline">\(i = 1,...,N\)</span>, <span class="math inline">\(j=1,...,J\)</span></p>
<ul>
<li>Iniciales</li>
</ul>
<p><span class="math display">\[p(\theta_{i,j},\tau_{ij})\propto \tau_{ij}^{-1}I(\tau_{ij}&gt;0)I(0&lt;\theta_{i,j}&lt;1)\]</span></p>
<ul>
<li>Posterior</li>
</ul>
<p><span class="math display">\[p(\theta_{ij}, \tau_{ij}|X_{ij}) \sim N\bigg(\theta_{ij} \bigg| \frac{\sum_{k=1}^{c_i}x_{ij}^k}{\sum_{k=1}^{c_i}n_{i}^k}, \tau_{ij}\sum_{k=1}^{c_i}n_i^k\bigg)I(0&lt;\theta_{ij}&lt;1)\times Ga\bigg(\tau_{ij}\bigg|\frac{c_i-1}{2}, \frac{1}{2}\bigg[\sum_{k=1}^{c_i}\frac{(x_{ij}^k)^2}{n_i^k}-\frac{\big(\sum_{k=1}^{c_i}x_{ij}^k\big)^2}{\sum_{k=1}^{c_i}n_i^k}\bigg]\bigg)\]</span>
donde:</p>
<ul>
<li><p><span class="math inline">\(X_{ij}\)</span> número de personas que favorecen al candidato <span class="math inline">\(j\)</span> en el estrato <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(X_{ij}^k\)</span> número de personas que favorecen al candidato <span class="math inline">\(j\)</span> en la casilla <span class="math inline">\(k\)</span>
del estrato <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(n_i^k\)</span> tamaño de la lista nominal en la <span class="math inline">\(k\)</span>-ésima casilla del <span class="math inline">\(i\)</span>-ésimo
estrato.</p></li>
<li><p><span class="math inline">\(\tau_{ij}/n_i^{k}\)</span> es la precisión para cada candidato.</p></li>
<li><p><span class="math inline">\(\theta_{ij}\)</span> es la proporción de las personas en la lista nominal del estrato
<span class="math inline">\(i\)</span> que favorecen al <span class="math inline">\(j\)</span>-ésimo partido.</p></li>
<li><p><span class="math inline">\(c_i\)</span> número de casillas del <span class="math inline">\(i\)</span>-ésimo estrato en la muestra.</p></li>
</ul>
<p>Los detalles del modelo los puedes encontrar en el <a href="https://drive.google.com/open?id=1lI5lUSqNcIYvlvxRyrbBD_IrzlWIzILY">artículo</a>.</p>
<p>Implementa el modelo y estima los resultados electorales de Guanajuato con la
muestra:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1">gto_muestra &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/muestra_gto_2012.csv&quot;</span>)</a></code></pre></div>
<p>Reporta estimaciones puntuales (media posterior) e intervalos del 95% de
credibilidad para cada candidato.</p>
</div>
<div id="modelos-jerárquicos-y-stan" class="section level3 unnumbered">
<h3>4. Modelos jerárquicos y Stan</h3>
<p><strong>Postestratificación</strong> es un método estándar que se utiliza para corregir las
estimaciones obtenidas de muestreo probabilístico cuando hay distintas
probabilidades de selección y para corregir no respuesta. A grandes rasgos, se
divide la población en categorías y se estima la distribución de las respuestas
en cada categoría, después se pondera cada categoría de acuerdo a su tamaño en
la población. Típicamente las categorías se crean con variables demográficas
(sexo, edad, …).</p>
<p>La dificultad que suele surgir en el proceso de postestratificación es que
por una parte se desea crear las celdas lo más finas posible, considerando
el cruce de muchas variables, con el objetivo de corregir en mayor medida
posibles sesgos en las estimaciones; sin embargo, conforme aumenta el número de
celdas el número de respondentes en cada una disminuye (muchas incluso quedan
vacías) y esto conlleva a que las estimaciones dentro de cada celda sean poco
precisas. Ante esta dificultad, la propuesta de MRP es modelar las respuestas
condicional a las variables de postestratificación, cuando las categorías de la
postestratificación siguen de manera natural estructuras jerárquicas (como
hogares en estados) se puede mejorar la eficiencia de la estimación ajustando
modelos multinivel.</p>
<p>Es así que MRP es una extensión a los ajustes de postestratificación clásicos
que permite usar más categorías y por tanto información más detallada de la
población. Una ventaja adicional es que además hace posible estimar la respuesta
en subcategorias demográficas o geográficas. En este ejercicio reproduciremos
el modelo que se ajusta en <span class="citation">Park, Gelman, and Bafumi (<a href="#ref-parkgelmanbafumi">2004</a>)</span> lo puedes descargar de <a href="http://www.stat.columbia.edu/~gelman/research/published/parkgelmanbafumi.pdf">esta liga</a>.</p>
<p>En esta aplicación se utilizan encuestas de opinión pública en EUA, en
particular modelamos la probabilidad de que un respondente prefiera al
candidato Republicano como presidente y usando los datos de encuestas de
<em>CBS News</em> levantadas previo a la elección presidencial de 1988.</p>
<p>Las variables demográficas que determinan las celdas de postestratificación son:
sexo, raza negra, edad (categórica), grado educativo y estado, si construyéramos
las celdas de postestratificación quedarían,</p>
<p>sexo(2) x raza negra(2) x edad(4) x educación(4) x estado(52) = 3264</p>
<p>celdas y tenemos únicamente 2193 entrevistas, por lo que un enfoque clásico
utilizando todas las variables demográficas disponibles queda descartado.</p>
<p>Ahora, definimos el modelo multinivel a usar, usaremos regresión logística
multinivel, en este planteamiento la variable <span class="math inline">\(y_i\)</span> indica si la
<span class="math inline">\(i\)</span>-ésima persona apoyaba al candidato republicano o no, y se agregan todas las
variables demográficas como covariables.</p>
<p><span class="math display">\[
\begin{aligned}
  P(y_i = 1) &amp;= logit^{-1}(\beta^0 + \beta^{mujer}\cdot mujer_i + \beta^{neg}\cdot neg_i+\beta^{mujer, neg}\cdot mujer_i \cdot neg_i+ \\
  &amp; \beta_{edad(i)}^{edad} +  \beta_{edad(i), edu(i)}^{edad,edu} + 
 \beta_{estado(i)}^{estado})
\end{aligned}
\]</span></p>
<p>En este ejemplo la estructura multinivel se reduce al coeficiente de
estado que se modela con indicadoras de región y una medida del apoyo
Republicano en el estado reportado en la elección previa.</p>
<p><span class="math display">\[ \beta_{j}\sim N(\beta_{region(j)}^{region}+\beta^{vprev}\cdot vprev_j, \sigma^2_{estado})\]</span></p>
<p>Ajustaremos este modelo usando el programa Stan, y
utilizamos las estimaciones para hacer predicciones a nivel estado (<span class="math inline">\(\theta_s\)</span>):</p>
<p><span class="math display">\[\theta_s=\frac{\sum_{j \in s}N_{j}\pi_j}{\sum_{j \in s}N_{j}}\]</span></p>
<p>donde <span class="math inline">\(N_j\)</span> indica el número de individuos en cada estado que
pertenecen a la <span class="math inline">\(j\)</span>-ésima celda, la información para determinar las <span class="math inline">\(N_j\)</span> se
obtendrá del censo de población.</p>
<div id="implementación" class="section level4 unnumbered">
<h4>Implementación</h4>
<p>Datos en <a href="http://www.stat.columbia.edu/~gelman/arm/examples/election88/">election88</a>,
o en la carpeta data.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="co"># preparación de los datos</span></a>
<a class="sourceLine" id="cb453-2" data-line-number="2"><span class="kw">library</span>(haven)</a>
<a class="sourceLine" id="cb453-3" data-line-number="3"><span class="co"># datos de encuestas</span></a>
<a class="sourceLine" id="cb453-4" data-line-number="4">polls &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/polls.dta&quot;</span>)</a>
<a class="sourceLine" id="cb453-5" data-line-number="5"><span class="co"># nos quedamos con la última encuesta y eliminamos faltantes</span></a>
<a class="sourceLine" id="cb453-6" data-line-number="6">last_poll &lt;-<span class="st"> </span>polls <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb453-7" data-line-number="7"><span class="st">    </span><span class="kw">filter</span>(survey <span class="op">==</span><span class="st"> </span><span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb453-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age_edu =</span> <span class="kw">paste0</span>(age, edu), </a>
<a class="sourceLine" id="cb453-9" data-line-number="9">      <span class="dt">age_edu_int =</span> <span class="kw">as.integer</span>(<span class="kw">as.factor</span>(age_edu))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb453-10" data-line-number="10"><span class="st">    </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb453-11" data-line-number="11"></a>
<a class="sourceLine" id="cb453-12" data-line-number="12"><span class="co"># datos de elecciones pasadas para utilizar como covariable y variable región</span></a>
<a class="sourceLine" id="cb453-13" data-line-number="13">presvote &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/presvote.dta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb453-14" data-line-number="14"><span class="st">    </span><span class="kw">cbind</span>(<span class="dt">region =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb453-15" data-line-number="15">        <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>))</a></code></pre></div>
<p>Los datos para el modelo serán:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" data-line-number="1">x_person &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span>black <span class="op">+</span><span class="st"> </span>female <span class="op">*</span><span class="st"> </span>black, <span class="dt">data =</span> last_poll)</a>
<a class="sourceLine" id="cb454-2" data-line-number="2">x_state &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(region) <span class="op">+</span><span class="st"> </span>g76_84pr, <span class="dt">data =</span> presvote) </a>
<a class="sourceLine" id="cb454-3" data-line-number="3"></a>
<a class="sourceLine" id="cb454-4" data-line-number="4">data_list &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb454-5" data-line-number="5">    <span class="dt">n =</span> <span class="kw">nrow</span>(last_poll), </a>
<a class="sourceLine" id="cb454-6" data-line-number="6">    <span class="dt">n_age =</span> <span class="kw">n_distinct</span>(last_poll<span class="op">$</span>age),</a>
<a class="sourceLine" id="cb454-7" data-line-number="7">    <span class="dt">n_age_edu =</span> <span class="kw">n_distinct</span>(last_poll<span class="op">$</span>age_edu_int),</a>
<a class="sourceLine" id="cb454-8" data-line-number="8">    <span class="dt">n_edu =</span> <span class="kw">n_distinct</span>(last_poll<span class="op">$</span>edu), </a>
<a class="sourceLine" id="cb454-9" data-line-number="9">    <span class="dt">n_state =</span> <span class="kw">max</span>(last_poll<span class="op">$</span>state), </a>
<a class="sourceLine" id="cb454-10" data-line-number="10">    <span class="dt">mh =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb454-11" data-line-number="11">    <span class="dt">mm =</span> <span class="dv">6</span>, </a>
<a class="sourceLine" id="cb454-12" data-line-number="12">    <span class="dt">age =</span> last_poll<span class="op">$</span>age,</a>
<a class="sourceLine" id="cb454-13" data-line-number="13">    <span class="dt">edu =</span> last_poll<span class="op">$</span>edu,</a>
<a class="sourceLine" id="cb454-14" data-line-number="14">    <span class="dt">age_edu =</span> last_poll<span class="op">$</span>age_edu_int,</a>
<a class="sourceLine" id="cb454-15" data-line-number="15">    <span class="dt">state =</span> last_poll<span class="op">$</span>state, </a>
<a class="sourceLine" id="cb454-16" data-line-number="16">    <span class="dt">y =</span> last_poll<span class="op">$</span>bush, </a>
<a class="sourceLine" id="cb454-17" data-line-number="17">    <span class="dt">x_person =</span> x_person[, <span class="dv">-1</span>],</a>
<a class="sourceLine" id="cb454-18" data-line-number="18">    <span class="dt">x_state =</span> x_state</a>
<a class="sourceLine" id="cb454-19" data-line-number="19">)</a></code></pre></div>
<p>Y el código en Stan:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1">model_mrp &lt;-<span class="st"> &quot;</span></a>
<a class="sourceLine" id="cb455-2" data-line-number="2"><span class="st">data {</span></a>
<a class="sourceLine" id="cb455-3" data-line-number="3"><span class="st">  int n; // número de observaciones</span></a>
<a class="sourceLine" id="cb455-4" data-line-number="4"><span class="st">  int n_state; // número de estados</span></a>
<a class="sourceLine" id="cb455-5" data-line-number="5"><span class="st">  int n_age;</span></a>
<a class="sourceLine" id="cb455-6" data-line-number="6"><span class="st">  int n_edu;</span></a>
<a class="sourceLine" id="cb455-7" data-line-number="7"><span class="st">  int n_age_edu;</span></a>
<a class="sourceLine" id="cb455-8" data-line-number="8"><span class="st">  int age[n];</span></a>
<a class="sourceLine" id="cb455-9" data-line-number="9"><span class="st">  int edu[n];</span></a>
<a class="sourceLine" id="cb455-10" data-line-number="10"><span class="st">  int age_edu[n];</span></a>
<a class="sourceLine" id="cb455-11" data-line-number="11"><span class="st">  int mh; //número de covariables nivel persona</span></a>
<a class="sourceLine" id="cb455-12" data-line-number="12"><span class="st">  int mm; //número de covariables nivel estado</span></a>
<a class="sourceLine" id="cb455-13" data-line-number="13"><span class="st">  int&lt;lower=0,upper=1&gt; y[n];</span></a>
<a class="sourceLine" id="cb455-14" data-line-number="14"><span class="st">  matrix[n, mh] x_person; // covariables a nivel persona</span></a>
<a class="sourceLine" id="cb455-15" data-line-number="15"><span class="st">  int state[n];</span></a>
<a class="sourceLine" id="cb455-16" data-line-number="16"><span class="st">  matrix[n_state, mm] x_state; // covariables a nivel estado</span></a>
<a class="sourceLine" id="cb455-17" data-line-number="17"><span class="st">} </span></a>
<a class="sourceLine" id="cb455-18" data-line-number="18"><span class="st">parameters {</span></a>
<a class="sourceLine" id="cb455-19" data-line-number="19"><span class="st">  real beta_0;</span></a>
<a class="sourceLine" id="cb455-20" data-line-number="20"><span class="st">  vector[mh] beta;</span></a>
<a class="sourceLine" id="cb455-21" data-line-number="21"><span class="st">  vector[n_state] beta_state_raw;</span></a>
<a class="sourceLine" id="cb455-22" data-line-number="22"><span class="st">  vector[n_age] beta_age_raw;</span></a>
<a class="sourceLine" id="cb455-23" data-line-number="23"><span class="st">  vector[n_edu] beta_edu_raw;</span></a>
<a class="sourceLine" id="cb455-24" data-line-number="24"><span class="st">  vector[n_age_edu] beta_age_edu_raw;</span></a>
<a class="sourceLine" id="cb455-25" data-line-number="25"><span class="st">  real&lt;lower=0&gt; sigma_age;</span></a>
<a class="sourceLine" id="cb455-26" data-line-number="26"><span class="st">  real&lt;lower=0&gt; sigma_edu;</span></a>
<a class="sourceLine" id="cb455-27" data-line-number="27"><span class="st">  real&lt;lower=0&gt; sigma_age_edu;</span></a>
<a class="sourceLine" id="cb455-28" data-line-number="28"><span class="st">  real&lt;lower=0&gt; sigma_state;</span></a>
<a class="sourceLine" id="cb455-29" data-line-number="29"><span class="st">  vector[mm] alpha;</span></a>
<a class="sourceLine" id="cb455-30" data-line-number="30"><span class="st">}</span></a>
<a class="sourceLine" id="cb455-31" data-line-number="31"><span class="st">transformed parameters {</span></a>
<a class="sourceLine" id="cb455-32" data-line-number="32"><span class="st">  vector[n] reg_pred;</span></a>
<a class="sourceLine" id="cb455-33" data-line-number="33"><span class="st">  vector[n_state] beta_state;</span></a>
<a class="sourceLine" id="cb455-34" data-line-number="34"><span class="st">  vector[n_age] beta_age;</span></a>
<a class="sourceLine" id="cb455-35" data-line-number="35"><span class="st">  vector[n_edu] beta_edu;</span></a>
<a class="sourceLine" id="cb455-36" data-line-number="36"><span class="st">  vector[n_age_edu] beta_age_edu;</span></a>
<a class="sourceLine" id="cb455-37" data-line-number="37"><span class="st">  // parametrización no centrada</span></a>
<a class="sourceLine" id="cb455-38" data-line-number="38"><span class="st">  beta_age = beta_age_raw * sigma_age; </span></a>
<a class="sourceLine" id="cb455-39" data-line-number="39"><span class="st">  beta_edu = beta_edu_raw * sigma_edu; </span></a>
<a class="sourceLine" id="cb455-40" data-line-number="40"><span class="st">  beta_age_edu =beta_age_edu_raw * sigma_age_edu; </span></a>
<a class="sourceLine" id="cb455-41" data-line-number="41"><span class="st">  beta_state = beta_state_raw * sigma_state + x_state * alpha; </span></a>
<a class="sourceLine" id="cb455-42" data-line-number="42"><span class="st">  reg_pred = beta_0 + x_person * beta + beta_state[state] + beta_age[age] + </span></a>
<a class="sourceLine" id="cb455-43" data-line-number="43"><span class="st">    beta_edu[edu] + beta_age_edu[age_edu];</span></a>
<a class="sourceLine" id="cb455-44" data-line-number="44"><span class="st">}</span></a>
<a class="sourceLine" id="cb455-45" data-line-number="45"><span class="st">model {  </span></a>
<a class="sourceLine" id="cb455-46" data-line-number="46"><span class="st">  y ~ bernoulli_logit(reg_pred);</span></a>
<a class="sourceLine" id="cb455-47" data-line-number="47"><span class="st">  beta_0 ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-48" data-line-number="48"><span class="st">  beta ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-49" data-line-number="49"><span class="st">  </span></a>
<a class="sourceLine" id="cb455-50" data-line-number="50"><span class="st">  beta_age_raw ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-51" data-line-number="51"><span class="st">  beta_edu_raw ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-52" data-line-number="52"><span class="st">  beta_age_edu_raw ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-53" data-line-number="53"><span class="st">  beta_state_raw ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-54" data-line-number="54"><span class="st">  </span></a>
<a class="sourceLine" id="cb455-55" data-line-number="55"><span class="st">  sigma_state ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-56" data-line-number="56"><span class="st">  sigma_age ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-57" data-line-number="57"><span class="st">  sigma_edu ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-58" data-line-number="58"><span class="st">  sigma_age_edu ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-59" data-line-number="59"><span class="st">  alpha ~ normal(0, 1);</span></a>
<a class="sourceLine" id="cb455-60" data-line-number="60"><span class="st">}</span></a>
<a class="sourceLine" id="cb455-61" data-line-number="61"></a>
<a class="sourceLine" id="cb455-62" data-line-number="62"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb455-63" data-line-number="63"><span class="kw">cat</span>(model_mrp, <span class="dt">file =</span> <span class="st">&#39;src/stan_files/model_mrp.stan&#39;</span>)</a></code></pre></div>
<ol style="list-style-type: decimal">
<li><strong>Modelo</strong>. Ajusta el modelo y revisa convergencia, describe
cuantas cadenas, iteraciones y etapa de calentamiento elegiste, además
escribe como determinaste convergencia.</li>
</ol>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">83933</span>)</a>
<a class="sourceLine" id="cb456-2" data-line-number="2">stan_fit &lt;-<span class="st"> </span><span class="kw">sampling</span>(<span class="dt">object =</span> stan_cpp, <span class="dt">data =</span> data_list, <span class="dt">chains =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb456-3" data-line-number="3">    <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Genera las simulaciones de <span class="math inline">\(\theta_s\)</span> para analizar las predicciones a nivel estado.
Realiza una gráfica con intervalos de credibilidad del 95%
para cada <span class="math inline">\(theta_s\)</span>.</li>
</ol>
<p>El siguiente código predice para cada celda de la tabla del censo, vale la
pena notar, que para cada celda tenemos una lista en el vector <code>pred</code> con las
simuaciones que le corresponden.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"> <span class="co"># construct the n.sims x 3264 matrix</span></a>
<a class="sourceLine" id="cb457-2" data-line-number="2">census88 &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/census88.dta&quot;</span>)</a>
<a class="sourceLine" id="cb457-3" data-line-number="3"></a>
<a class="sourceLine" id="cb457-4" data-line-number="4">params_sims &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(stan_fit, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;beta_0&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;beta_age&quot;</span>, </a>
<a class="sourceLine" id="cb457-5" data-line-number="5">    <span class="st">&quot;beta_edu&quot;</span>, <span class="st">&quot;beta_age_edu&quot;</span>, <span class="st">&quot;beta_state&quot;</span>))</a>
<a class="sourceLine" id="cb457-6" data-line-number="6">    <span class="er">))</span></a>
<a class="sourceLine" id="cb457-7" data-line-number="7"></a>
<a class="sourceLine" id="cb457-8" data-line-number="8">pred_cell &lt;-<span class="st"> </span>census88 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb457-9" data-line-number="9"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age_edu =</span> <span class="kw">paste0</span>(age, edu), </a>
<a class="sourceLine" id="cb457-10" data-line-number="10">        <span class="dt">age_edu_int =</span> <span class="kw">as.integer</span>(<span class="kw">as.factor</span>(age_edu))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb457-11" data-line-number="11"><span class="st">    </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb457-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb457-13" data-line-number="13">        <span class="dt">pred =</span> <span class="kw">list</span>(arm<span class="op">::</span><span class="kw">invlogit</span>(params_sims<span class="op">$</span>beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb457-14" data-line-number="14"><span class="st">                </span>params_sims<span class="op">$</span><span class="st">`</span><span class="dt">beta[1]</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span>female <span class="op">+</span></a>
<a class="sourceLine" id="cb457-15" data-line-number="15"><span class="st">                </span>params_sims<span class="op">$</span><span class="st">`</span><span class="dt">beta[2]</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span>black <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb457-16" data-line-number="16"><span class="st">                </span>params_sims<span class="op">$</span><span class="st">`</span><span class="dt">beta[3]</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span>female <span class="op">*</span><span class="st"> </span>black <span class="op">+</span></a>
<a class="sourceLine" id="cb457-17" data-line-number="17"><span class="st">                </span>params_sims[, <span class="kw">str_c</span>(<span class="st">&quot;beta_age[&quot;</span>, <span class="kw">round</span>(age), <span class="st">&quot;]&quot;</span>)] <span class="op">+</span></a>
<a class="sourceLine" id="cb457-18" data-line-number="18"><span class="st">                </span>params_sims[, <span class="kw">str_c</span>(<span class="st">&quot;beta_edu[&quot;</span>, <span class="kw">round</span>(edu), <span class="st">&quot;]&quot;</span>)] <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb457-19" data-line-number="19"><span class="st">                </span>params_sims[, <span class="kw">str_c</span>(<span class="st">&quot;beta_age_edu[&quot;</span>, age_edu_int, <span class="st">&quot;]&quot;</span>)] <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb457-20" data-line-number="20"><span class="st">                </span>params_sims[, <span class="kw">str_c</span>(<span class="st">&quot;beta_state[&quot;</span>, <span class="kw">round</span>(state), <span class="st">&quot;]&quot;</span>)]))</a>
<a class="sourceLine" id="cb457-21" data-line-number="21">    ) </a></code></pre></div>
<p>Para hacer las estimaciones por estado hace falta ponderar por el número de
casos en cada celda:</p>
<p><span class="math display">\[\theta_s=\frac{\sum_{j \in s}N_{j}\pi_j}{\sum_{j \in s}N_{j}}\]</span></p>
<p>Debarás calcular
una simulación de cada <span class="math inline">\(\theta_s\)</span> por cada simulación de <span class="math inline">\(\pi_j\)</span> obtenida con
el código de arriba.</p>

</div>
</div>
</div>
<!-- </div> -->
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-mendoza2016">
<p>Mendoza, Manuel, and Luis E. Nieto-Barajas. 2016. “Quick Counts in the Mexican Presidential Elections: A Bayesian Approach.” <em>Electoral Studies</em> 43 (C):124–32. <a href="https://doi.org/10.1016/j.electstud.2016.06.007" class="uri">https://doi.org/10.1016/j.electstud.2016.06.007</a>.</p>
</div>
<div id="ref-parkgelmanbafumi">
<p>Park, David K., Andrew Gelman, and Joseph Bafumi. 2004. “Bayesian Multilevel Estimation with Poststratification: State-Level Estimates from National Polls.” <em>Political Analysis</em> 12 (04):375–85. <a href="https://EconPapers.repec.org/RePEc:cup:polals:v:12:y:2004:i:04:p:375-385_00" class="uri">https://EconPapers.repec.org/RePEc:cup:polals:v:12:y:2004:i:04:p:375-385_00</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-jerárquicos-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/98-tareas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
