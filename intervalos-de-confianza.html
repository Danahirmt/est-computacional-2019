<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.3 Intervalos de confianza | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.14.1 and GitBook 2.6.7" />

  <meta property="og:title" content="6.3 Intervalos de confianza | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.3 Intervalos de confianza | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="el-estimador-bootstrap-del-error-estándar.html"/>
<link rel="next" href="más-alla-de-muestras-aleatorias-simples.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#noticias"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="examen-parcial.html"><a href="examen-parcial.html"><i class="fa fa-check"></i>EXAMEN PARCIAL</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intervalos-de-confianza" class="section level2">
<h2><span class="header-section-number">6.3</span> Intervalos de confianza</h2>
<p>Hasta ahora hemos discutido la idea detrás del bootstrap y como se puede usar
para estimar errores estándar. Comenzamos con el error estándar pues es la
manera más común para describir la precisión de una estadística.</p>
<ul>
<li><p>En términos generales, esperamos que <span class="math inline">\(\bar{x}\)</span> este a una distancia de <span class="math inline">\(\mu_P\)</span>
menor a un error estándar el 68% del tiempo, y a menos de 2 errores estándar el
95% del tiempo.</p></li>
<li><p>Estos porcentajes están basados el teorema central del límite que nos dice que
bajo ciertas condiciones (bastante generales) de <span class="math inline">\(P\)</span> la distribución de
<span class="math inline">\(\bar{x}\)</span> se aproximará a una distribución normal:</p></li>
</ul>
<p><span class="math display">\[\bar{x} \overset{\cdot}{\sim} N(\mu_P,\sigma_P^2/n)\]</span></p>
<p>Veamos algunos ejemplos de como funciona el Teorema del Límite
Central, buscamos ver como se aproxima la distribución muestral de la media
(cuando las observaciones provienen de distintas distribuciones) a una
Normal conforme aumenta el tamaño de muestra. Para esto, aproximamos la
distribución muestral de la media usando simulación de la población.</p>
<p>Vale la pena observar que hay distribuciones que requieren un mayor tamaño
de muestra <span class="math inline">\(n\)</span> para lograr una buena aproximación (por ejemplo la log-normal),
¿a qué se debe esto?</p>
<p>Para la opción de <em>Elecciones</em> tenemos una población de tamaño <span class="math inline">\(N=143,437\)</span> y el
objetivo es estimar la media del tamaño de la lista nominal de las casillas
(datos de las elecciones presidenciales de 2012). Podemos ver como mejora la
aproximación Normal de la distribución muestral conforme aumenta el tamaño de
muestra <span class="math inline">\(n\)</span>; sin embargo, también sobresale que no es necesario tomar una
muestra demasiado grande (<span class="math inline">\(n = 60\)</span> ya es razonable).</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">include_app</span>(<span class="st">&quot;https://tereom.shinyapps.io/15-TLC/&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;1000px&quot;</span>)</a></code></pre></div>
<iframe src="https://tereom.shinyapps.io/15-TLC/?showcase=0" width="672" height="1000px">
</iframe>
<p>En lo que sigue veremos distintas maneras de construir intervalos de confianza
usando bootstrap.</p>
<div class="caja">
<p>Un <strong>intervalo de confianza</strong> <span class="math inline">\((1-2\alpha)\)</span>% para un parámetro <span class="math inline">\(\theta\)</span> es un
intervalo <span class="math inline">\((a,b)\)</span> tal que <span class="math inline">\(P(a \le \theta \le b) = 1-2\alpha\)</span> para todo
<span class="math inline">\(\theta \in \Theta\)</span>.</p>
</div>
<p>Y comenzamos con la versión bootstrap del intervalo más popular.</p>
<div class="caja">
<ol style="list-style-type: decimal">
<li><strong>Intervalo Normal</strong> con error estándar bootstrap.
El intervalo para <span class="math inline">\(\hat{\theta}\)</span> con un nivel de confianza de
<span class="math inline">\(100\cdot(1-2\alpha)\%\)</span> se define como:</li>
</ol>
<p><span class="math display">\[(\hat{\theta}-z^{(1-\alpha)}\cdot \hat{se}_B, \hat{\theta}+z^{(1-\alpha)}\cdot \hat{se})\]</span>.</p>
<p>donde <span class="math inline">\(z^{(\alpha)}\)</span> denota el percentil <span class="math inline">\(100\cdot \alpha\)</span> de una
distribución <span class="math inline">\(N(0,1)\)</span>.</p>
</div>
<p>este intervalo está soportado por el Teorema Central del Límite, sin embargo,
no es adecuado cuando <span class="math inline">\(\hat{\theta}\)</span> no se distribuye aproximadamente Normal.</p>
<div id="ejemplo-kurtosis" class="section level4 unnumbered">
<h4>Ejemplo: kurtosis</h4>
<p>Supongamos que queremos estimar la kurtosis de una base de datos que consta de
799 tiempos de espera entre pulsasiones de un nervio (Cox, Lewis 1976).</p>
<p><span class="math display">\[\hat{\theta} = t(P_n) =\frac{1/n \sum_{i=1}^n(x_i-\hat{\mu})^3}{\hat{\sigma}^3}\]</span></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">library</span>(ACSWR)</a>
<a class="sourceLine" id="cb204-2" data-line-number="2"><span class="kw">data</span>(<span class="st">&quot;nerve&quot;</span>)</a>
<a class="sourceLine" id="cb204-3" data-line-number="3"><span class="kw">head</span>(nerve)</a>
<a class="sourceLine" id="cb204-4" data-line-number="4"><span class="co">#&gt; [1] 0.21 0.03 0.05 0.11 0.59 0.06</span></a>
<a class="sourceLine" id="cb204-5" data-line-number="5"></a>
<a class="sourceLine" id="cb204-6" data-line-number="6">kurtosis &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb204-7" data-line-number="7">    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb204-8" data-line-number="8">    <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">^</span><span class="st"> </span><span class="dv">3</span> </a>
<a class="sourceLine" id="cb204-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb204-10" data-line-number="10"></a>
<a class="sourceLine" id="cb204-11" data-line-number="11">theta_hat &lt;-<span class="st"> </span><span class="kw">kurtosis</span>(nerve)</a>
<a class="sourceLine" id="cb204-12" data-line-number="12">theta_hat</a>
<a class="sourceLine" id="cb204-13" data-line-number="13"><span class="co">#&gt; [1] 1.757943</span></a>
<a class="sourceLine" id="cb204-14" data-line-number="14"></a>
<a class="sourceLine" id="cb204-15" data-line-number="15">kurtosis_boot &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb204-16" data-line-number="16">  x_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb204-17" data-line-number="17">  <span class="kw">kurtosis</span>(x_boot)</a>
<a class="sourceLine" id="cb204-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb204-19" data-line-number="19">B &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb204-20" data-line-number="20">kurtosis &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">kurtosis_boot</span>(nerve)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-21" data-line-number="21"><span class="st">  </span><span class="kw">flatten_dbl</span>()</a></code></pre></div>
<p>Usando el intervalo normal tenemos:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">li_normal &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb205-2" data-line-number="2">ls_normal &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb205-3" data-line-number="3"><span class="kw">c</span>(li_normal, ls_normal)</a>
<a class="sourceLine" id="cb205-4" data-line-number="4"><span class="co">#&gt; [1] 1.44 2.08</span></a></code></pre></div>
<p>Una modificación común del intervalo normal es el intervalo t, estos intervalos
son mejores en caso de muestras pequeñas (<span class="math inline">\(n\)</span> chica).</p>
<div class="caja">
<ol start="2" style="list-style-type: decimal">
<li><strong>Intervalo <span class="math inline">\(t\)</span></strong> con error estándar bootstrap. Para una muestra de tamaño
<span class="math inline">\(n\)</span> el intervalo <span class="math inline">\(t\)</span> con un nivel de confianza de <span class="math inline">\(100\cdot(1-2\alpha)\%\)</span> se
define como:</li>
</ol>
<p><span class="math display">\[(\hat{\theta}-t^{(1-\alpha)}_{n-1}\cdot \hat{se}_B, \hat{\theta}+t^{(1-\alpha)}_{n-1}\cdot \hat{se}_B)\]</span>.</p>
<p>donde <span class="math inline">\(t^{(\alpha)}_{n-1}\)</span> denota denota el percentil <span class="math inline">\(100\cdot \alpha\)</span> de una
distribución <span class="math inline">\(t\)</span> con <span class="math inline">\(n-1\)</span> grados de libertad.</p>
</div>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1">n_nerve &lt;-<span class="st"> </span><span class="kw">length</span>(nerve)</a>
<a class="sourceLine" id="cb206-2" data-line-number="2">li_t &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.025</span>, n_nerve <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb206-3" data-line-number="3">ls_t &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.025</span>, n_nerve <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb206-4" data-line-number="4"><span class="kw">c</span>(li_t, ls_t)</a>
<a class="sourceLine" id="cb206-5" data-line-number="5"><span class="co">#&gt; [1] 1.44 2.08</span></a></code></pre></div>
<p>Los intervalos normales y <span class="math inline">\(t\)</span> se valen de la estimación bootstrap del error
estándar; sin embargo, el bootstrap se puede usar para estimar la función de
distribución de <span class="math inline">\(\hat{\theta}\)</span> por lo que no es necesario hacer supuestos
distribucionales para <span class="math inline">\(\hat{\theta}\)</span> sino que podemos estimarla como parte del
proceso de construir intervalos de confianza.</p>
<p>Veamos un histograma de las replicaciones bootstrap de <span class="math inline">\(\hat{\theta}^*\)</span></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb207-2" data-line-number="2">nerve_kurtosis &lt;-<span class="st"> </span><span class="kw">tibble</span>(kurtosis)</a>
<a class="sourceLine" id="cb207-3" data-line-number="3">hist_nerve &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nerve_kurtosis, <span class="kw">aes</span>(<span class="dt">x =</span> kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb207-4" data-line-number="4"><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-5" data-line-number="5"><span class="st">            </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(li_normal, ls_normal, theta_hat), </a>
<a class="sourceLine" id="cb207-6" data-line-number="6">            <span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb207-7" data-line-number="7"></a>
<a class="sourceLine" id="cb207-8" data-line-number="8">qq_nerve &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nerve_kurtosis) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-10" data-line-number="10"><span class="st">  </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> kurtosis), <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(kurtosis), <span class="dt">sd =</span> <span class="kw">sd</span>(kurtosis))) </a>
<a class="sourceLine" id="cb207-11" data-line-number="11"></a>
<a class="sourceLine" id="cb207-12" data-line-number="12"><span class="kw">grid.arrange</span>(hist_nerve, qq_nerve, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-19-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>En el ejemplo anterior el supuesto de normalidad parece razonable, veamos
como se comparan los cuantiles de la estimación de la distribución de
<span class="math inline">\(\hat{\theta}\)</span> con los cuantiles de una normal:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="kw">comma</span>(q_kurt &lt;-<span class="st"> </span><span class="kw">quantile</span>(kurtosis, </a>
<a class="sourceLine" id="cb208-2" data-line-number="2">  <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)))</a>
<a class="sourceLine" id="cb208-3" data-line-number="3"><span class="kw">comma</span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="dt">mean =</span> theta_hat, </a>
<a class="sourceLine" id="cb208-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(kurtosis)))</a>
<a class="sourceLine" id="cb208-5" data-line-number="5"><span class="co">#&gt;  2.5%    5%   10%   90%   95% 97.5% </span></a>
<a class="sourceLine" id="cb208-6" data-line-number="6"><span class="co">#&gt; &quot;1.4&quot; &quot;1.5&quot; &quot;1.5&quot; &quot;2.0&quot; &quot;2.0&quot; &quot;2.1&quot; </span></a>
<a class="sourceLine" id="cb208-7" data-line-number="7"><span class="co">#&gt; [1] &quot;1.4&quot; &quot;1.5&quot; &quot;1.5&quot; &quot;2.0&quot; &quot;2.0&quot; &quot;2.1&quot;</span></a></code></pre></div>
<p>Esto sugiere usar los cuantiles del histograma bootstrap para definir los
límites de los intervalos de confianza:</p>
<div class="caja">
<ol start="3" style="list-style-type: decimal">
<li><strong>Percentiles</strong>. Denotemos por <span class="math inline">\(G\)</span> la función de distribución acumulada de
<span class="math inline">\(\hat{\theta}^*\)</span> el intervalo percentil de <span class="math inline">\(1-2\alpha\)</span> se define por los
percentiles <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(1-\alpha\)</span> de <span class="math inline">\(G\)</span>
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup}) = (G^{-1}(\alpha), G^{-1}(1-\alpha))\]</span>
Por definición <span class="math inline">\(G^{-1}(\alpha)=\hat{\theta}^*(\alpha)\)</span>, esto es, el percentil
<span class="math inline">\(100\cdot \alpha\)</span> de la distribución bootstrap, por lo que podemos escribir el
intervalo bootstrap como
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup})=(\hat{\theta}^*(\alpha),\hat{\theta}^*(1-\alpha))\]</span></li>
</ol>
</div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">arrange</span>(nerve_kurtosis, kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-2" data-line-number="2"><span class="st">    </span><span class="kw">stat_ecdf</span>(<span class="kw">aes</span>(<span class="dt">x =</span> kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> <span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, q_kurt[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)]), </a>
<a class="sourceLine" id="cb209-4" data-line-number="4">        <span class="dt">xend =</span> q_kurt[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">6</span>)], <span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb209-5" data-line-number="5">        <span class="dt">yend =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, </a>
<a class="sourceLine" id="cb209-6" data-line-number="6">        <span class="dt">yend =</span> yend), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Cuantiles muestrales&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;ecdf&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-21-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Las expresiones de arriba hacen referencia a la situación bootstrap <em>ideal</em>
donde el número de replicaciones bootstrap es infinito, en la práctica usamos
aproximaciones. Y se procede como sigue:</p>
<div style="caja">
<p>Intervalo percentil:</p>
<ul>
<li><p>Generamos B muestras bootstrap independientes <span class="math inline">\(\textbf{x}^{*1},..., \textbf{x}^{*B}\)</span> y calculamos las replicaciones <span class="math inline">\(\hat{\theta}^{*b}=s(x^{*b}).\)</span></p></li>
<li>Sea <span class="math inline">\(\hat{\theta}^{*}_B(\alpha)\)</span> el percentil <span class="math inline">\(100\cdot\alpha\)</span> de la
distribución empírica de <span class="math inline">\(\hat{\theta}^{*}\)</span>, y <span class="math inline">\(\hat{\theta}^{*}_B(1-\alpha)\)</span>
el correspondiente al percentil <span class="math inline">\(100\cdot (1-\alpha)\)</span>, escribimos el intervalo
de percentil <span class="math inline">\(1-2\alpha\)</span> como
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup})\approx(\hat{\theta}^*_B(\alpha),\hat{\theta}^*_B(1-\alpha))\]</span></li>
</ul>
</div>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">ls_per &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">quantile</span>(kurtosis, <span class="dt">probs =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb210-2" data-line-number="2">li_per &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">quantile</span>(kurtosis, <span class="dt">probs =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb210-3" data-line-number="3">stringr<span class="op">::</span><span class="kw">str_c</span>(li_normal, ls_normal, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb210-4" data-line-number="4">stringr<span class="op">::</span><span class="kw">str_c</span>(li_per, ls_per, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb210-5" data-line-number="5"><span class="co">#&gt; [1] &quot;1.44,2.08&quot;</span></a>
<a class="sourceLine" id="cb210-6" data-line-number="6"><span class="co">#&gt; [1] &quot;1.43,2.07&quot;</span></a></code></pre></div>
<p>Si la distribución de <span class="math inline">\(\hat{\theta}^*\)</span> es aproximadamente normal, entonces
los intervalos normales y de percentiles serán similares.</p>
<p>Con el fin de comparar los intervalos creamos un ejemplo de simulación
(ejemplo tomado de <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>), generamos una muestra de tamaño 10 de una
distribución normal estándar, supongamos que el parámetro de interés es
<span class="math inline">\(e^{\mu}\)</span> donde <span class="math inline">\(\mu\)</span> es la media poblacional.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">137612</span>)</a>
<a class="sourceLine" id="cb211-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb211-3" data-line-number="3"></a>
<a class="sourceLine" id="cb211-4" data-line-number="4">boot_sim_exp &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb211-5" data-line-number="5">  x_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb211-6" data-line-number="6">  <span class="kw">exp</span>(<span class="kw">mean</span>(x_boot))</a>
<a class="sourceLine" id="cb211-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb211-8" data-line-number="8">theta_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">boot_sim_exp</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb211-9" data-line-number="9">theta_boot_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(theta_boot)</a>
<a class="sourceLine" id="cb211-10" data-line-number="10"></a>
<a class="sourceLine" id="cb211-11" data-line-number="11">hist_emu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(theta_boot_df, <span class="kw">aes</span>(<span class="dt">x =</span> theta_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">0.08</span>) </a>
<a class="sourceLine" id="cb211-13" data-line-number="13">qq_emu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(theta_boot_df) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-15" data-line-number="15"><span class="st">    </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> theta_boot), </a>
<a class="sourceLine" id="cb211-16" data-line-number="16">        <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(theta_boot), <span class="dt">sd =</span> <span class="kw">sd</span>(theta_boot))) </a>
<a class="sourceLine" id="cb211-17" data-line-number="17"></a>
<a class="sourceLine" id="cb211-18" data-line-number="18"><span class="kw">grid.arrange</span>(hist_emu, qq_emu, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-23-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>La distribución empírica de <span class="math inline">\(\hat{\theta}^*\)</span> es asimétrica, por lo que no
esperamos que coincidan los intervalos.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">exp</span>(<span class="kw">mean</span>(x)) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(theta_boot), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb212-3" data-line-number="3"><span class="co">#&gt; [1] 0.36</span></a>
<a class="sourceLine" id="cb212-4" data-line-number="4"><span class="kw">round</span>(<span class="kw">exp</span>(<span class="kw">mean</span>(x)) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(theta_boot), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb212-5" data-line-number="5"><span class="co">#&gt; [1] 1.6</span></a>
<a class="sourceLine" id="cb212-6" data-line-number="6"></a>
<a class="sourceLine" id="cb212-7" data-line-number="7"><span class="co">#Percentil</span></a>
<a class="sourceLine" id="cb212-8" data-line-number="8"><span class="kw">round</span>(<span class="kw">quantile</span>(theta_boot, <span class="dt">prob =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb212-9" data-line-number="9"><span class="co">#&gt; 2.5% </span></a>
<a class="sourceLine" id="cb212-10" data-line-number="10"><span class="co">#&gt; 0.53</span></a>
<a class="sourceLine" id="cb212-11" data-line-number="11"><span class="kw">round</span>(<span class="kw">quantile</span>(theta_boot, <span class="dt">prob =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb212-12" data-line-number="12"><span class="co">#&gt; 97.5% </span></a>
<a class="sourceLine" id="cb212-13" data-line-number="13"><span class="co">#&gt;  1.79</span></a></code></pre></div>
<p>La inspección del histograma deja claro que la aproximación normal no es
conveniente en este caso, veamos que ocurre cuando aplicamos la transformación
logarítmica.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1">hist_log &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(theta_boot), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(theta_boot))) <span class="op">+</span></a>
<a class="sourceLine" id="cb213-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">0.08</span>) </a>
<a class="sourceLine" id="cb213-3" data-line-number="3">qq_log &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(theta_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb213-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb213-5" data-line-number="5"><span class="st">    </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(theta_boot)), </a>
<a class="sourceLine" id="cb213-6" data-line-number="6">        <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(<span class="kw">log</span>(theta_boot)), <span class="dt">sd =</span> <span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)))) </a>
<a class="sourceLine" id="cb213-7" data-line-number="7"></a>
<a class="sourceLine" id="cb213-8" data-line-number="8"><span class="kw">grid.arrange</span>(hist_log, qq_log, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-25-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>Y los intervalos se comparan:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb214-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb214-3" data-line-number="3"><span class="co">#&gt; [1] -0.63</span></a>
<a class="sourceLine" id="cb214-4" data-line-number="4"><span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb214-5" data-line-number="5"><span class="co">#&gt; [1] 0.58</span></a>
<a class="sourceLine" id="cb214-6" data-line-number="6"></a>
<a class="sourceLine" id="cb214-7" data-line-number="7"><span class="co">#Percentil</span></a>
<a class="sourceLine" id="cb214-8" data-line-number="8"><span class="kw">round</span>(<span class="kw">quantile</span>(<span class="kw">log</span>(theta_boot), <span class="dt">prob =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb214-9" data-line-number="9"><span class="co">#&gt;  2.5% </span></a>
<a class="sourceLine" id="cb214-10" data-line-number="10"><span class="co">#&gt; -0.63</span></a>
<a class="sourceLine" id="cb214-11" data-line-number="11"><span class="kw">round</span>(<span class="kw">quantile</span>(<span class="kw">log</span>(theta_boot), <span class="dt">prob =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb214-12" data-line-number="12"><span class="co">#&gt; 97.5% </span></a>
<a class="sourceLine" id="cb214-13" data-line-number="13"><span class="co">#&gt;  0.58</span></a></code></pre></div>
<p>La transformación logarítmica convierte la distribución de <span class="math inline">\(\hat{\theta}\)</span> en
normal y por tanto los intervalos de <span class="math inline">\(\hat{\phi}^*=log(\hat{\theta}^*)\)</span> son
similares. La forma normal no es sorprendente pues <span class="math inline">\(\hat{\phi}^*=\bar{x}^*\)</span>.</p>
<p>Si mapeamos los intervalos normales calculados para <span class="math inline">\(log(\hat{\theta}^*)\)</span> de
regreso a la escala de <span class="math inline">\(\theta\)</span> obtenemos intervalos similares a los calculados
para <span class="math inline">\(\hat{\theta}^*\)</span> usando percentiles:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb215-2" data-line-number="2"><span class="co">#&gt; [1] 0.5325918</span></a>
<a class="sourceLine" id="cb215-3" data-line-number="3"><span class="kw">exp</span>(<span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb215-4" data-line-number="4"><span class="co">#&gt; [1] 1.786038</span></a></code></pre></div>
<p>Podemos ver que el método de aplicar una transformación, calcular intervalos
usando la normal y aplicar la transformación inversa para volver a la escala
original genera intervalos de confianza atractivos, el problema con este
método es que requiere que conozcamos la transformación adecuada para cada
parámetro.</p>
<p>Por otra parte, podemos pensar en el método del percentil como un
algoritmo que incorpora la transformación de manera automática.</p>
<div class="caja">
<p><strong>Lema</strong>. Supongamos que la transformación <span class="math inline">\(\hat{\phi}=m(\hat{\theta})\)</span>
normaliza la distribución de <span class="math inline">\(\hat{\theta}\)</span> de manera perfecta,
<span class="math display">\[\hat{\phi} \approx N(\phi, c^2)\]</span>
para alguna desviación estándar <span class="math inline">\(c\)</span>. Entonces el intervalo de percentil basado
en <span class="math inline">\(\hat{\theta}\)</span> es igual a
<span class="math display">\[(m^{-1} (\hat{\phi}-z^{(1-\alpha)}c), m^{-1}(\hat{\phi}-z^{(\alpha)}c))\]</span></p>
</div>
<p>Se dice que el intervalo de confianza de percentiles es <strong>invariante a transformaciones</strong>.</p>
<p>Existen otras alternativas al método del percentil y cubren otras fallas del
intervalo normal. Por ejemplo, hay ocasiones en que <span class="math inline">\(\hat{\theta}\)</span> tiene una
distribución normal sesgada:
<span class="math display">\[\hat{\theta} \approx N(\theta + sesgo, \hat{se}^2)\]</span></p>
<p>en este caso no existe una transformación <span class="math inline">\(m(\theta)\)</span> que <em>arregle</em> el
intervalo.</p>
<div class="caja">
<ol start="3" style="list-style-type: decimal">
<li><strong>Intervalos acelerados y corregidos por sesgo</strong>. Esta es una versión
mejorada del intervalo de percentil, la denotamos <span class="math inline">\(BC_{a}\)</span> (<em>bias-corrected and
accelerated</em>).</li>
</ol>
</div>
<p>Usaremos un ejemplo de <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>, los datos constan de los resultados
en dos pruebas espaciales de 26 niños con discapacidad neurológico. Supongamos
que queremos calcular un intervalo de confianza de 90% para <span class="math inline">\(\theta=var(A)\)</span>.</p>
<p>El estimador plugin es:
<span class="math display">\[\hat{\theta}=\sum_{i=1}^n(A_i-\bar{A})^2/n\]</span>
notemos que el estimador <em>plug-in</em> es ligeramente menor que el estimador
usual insesgado:
<span class="math display">\[\hat{\theta}=\sum_{i=1}^n(A_i-\bar{A})^2/(n-1)\]</span></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb216-2" data-line-number="2"></a>
<a class="sourceLine" id="cb216-3" data-line-number="3">spatial</a>
<a class="sourceLine" id="cb216-4" data-line-number="4"><span class="co">#&gt;      A  B</span></a>
<a class="sourceLine" id="cb216-5" data-line-number="5"><span class="co">#&gt; V1  48 42</span></a>
<a class="sourceLine" id="cb216-6" data-line-number="6"><span class="co">#&gt; V2  36 33</span></a>
<a class="sourceLine" id="cb216-7" data-line-number="7"><span class="co">#&gt; V3  20 16</span></a>
<a class="sourceLine" id="cb216-8" data-line-number="8"><span class="co">#&gt; V4  29 39</span></a>
<a class="sourceLine" id="cb216-9" data-line-number="9"><span class="co">#&gt; V5  42 38</span></a>
<a class="sourceLine" id="cb216-10" data-line-number="10"><span class="co">#&gt; V6  42 36</span></a>
<a class="sourceLine" id="cb216-11" data-line-number="11"><span class="co">#&gt; V7  20 15</span></a>
<a class="sourceLine" id="cb216-12" data-line-number="12"><span class="co">#&gt; V8  42 33</span></a>
<a class="sourceLine" id="cb216-13" data-line-number="13"><span class="co">#&gt; V9  22 20</span></a>
<a class="sourceLine" id="cb216-14" data-line-number="14"><span class="co">#&gt; V10 41 43</span></a>
<a class="sourceLine" id="cb216-15" data-line-number="15"><span class="co">#&gt; V11 45 34</span></a>
<a class="sourceLine" id="cb216-16" data-line-number="16"><span class="co">#&gt; V12 14 22</span></a>
<a class="sourceLine" id="cb216-17" data-line-number="17"><span class="co">#&gt; V13  6  7</span></a>
<a class="sourceLine" id="cb216-18" data-line-number="18"><span class="co">#&gt; V14  0 15</span></a>
<a class="sourceLine" id="cb216-19" data-line-number="19"><span class="co">#&gt; V15 33 34</span></a>
<a class="sourceLine" id="cb216-20" data-line-number="20"><span class="co">#&gt; V16 28 29</span></a>
<a class="sourceLine" id="cb216-21" data-line-number="21"><span class="co">#&gt; V17 34 41</span></a>
<a class="sourceLine" id="cb216-22" data-line-number="22"><span class="co">#&gt; V18  4 13</span></a>
<a class="sourceLine" id="cb216-23" data-line-number="23"><span class="co">#&gt; V19 32 38</span></a>
<a class="sourceLine" id="cb216-24" data-line-number="24"><span class="co">#&gt; V20 24 25</span></a>
<a class="sourceLine" id="cb216-25" data-line-number="25"><span class="co">#&gt; V21 47 27</span></a>
<a class="sourceLine" id="cb216-26" data-line-number="26"><span class="co">#&gt; V22 41 41</span></a>
<a class="sourceLine" id="cb216-27" data-line-number="27"><span class="co">#&gt; V23 24 28</span></a>
<a class="sourceLine" id="cb216-28" data-line-number="28"><span class="co">#&gt; V24 26 14</span></a>
<a class="sourceLine" id="cb216-29" data-line-number="29"><span class="co">#&gt; V25 30 28</span></a>
<a class="sourceLine" id="cb216-30" data-line-number="30"><span class="co">#&gt; V26 41 40</span></a>
<a class="sourceLine" id="cb216-31" data-line-number="31"></a>
<a class="sourceLine" id="cb216-32" data-line-number="32"><span class="kw">ggplot</span>(spatial) <span class="op">+</span></a>
<a class="sourceLine" id="cb216-33" data-line-number="33"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(A, B))</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/spatial-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>El estimador <em>plug-in</em> de <span class="math inline">\(\theta\)</span> es</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="kw">sum</span>((spatial<span class="op">$</span>A <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(spatial<span class="op">$</span>A)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(spatial)</a>
<a class="sourceLine" id="cb217-2" data-line-number="2"><span class="co">#&gt; [1] 171.534</span></a></code></pre></div>
<p>Notemos que es ligeramente menor que el estimador insesgado:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1"><span class="kw">sum</span>((spatial<span class="op">$</span>A <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(spatial<span class="op">$</span>A)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(spatial) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb218-2" data-line-number="2"><span class="co">#&gt; [1] 178.3954</span></a></code></pre></div>
<p>El método <span class="math inline">\(BC_{a}\)</span> corrige el sesgo de manera automática, lo cuál es una
de sus prinicipales ventajas comparado con el método del percentil.</p>
<p>Los extremos en los intervalos <span class="math inline">\(BC_{a}\)</span> están dados por percentiles de la
distribución bootstrap, los percentiles usados dependen de dos números <span class="math inline">\(\hat{a}\)</span>
y <span class="math inline">\(\hat{z}_0\)</span>, que se denominan la aceleración y la corrección del sesgo:
<span class="math display">\[BC_a : (\hat{\theta}_{inf}, \hat{\theta}_{sup})=(\hat{\theta}^*(\alpha_1), \hat{\theta}^*(\alpha_2))\]</span>
donde
<span class="math display">\[\alpha_1= \Phi\bigg(\hat{z}_0 + \frac{\hat{z}_0 + z^{(\alpha)}}{1- \hat{a}(\hat{z}_0 + z^{(\alpha)})}\bigg)\]</span>
<span class="math display">\[\alpha_2= \Phi\bigg(\hat{z}_0 + \frac{\hat{z}_0 + z^{(1-\alpha)}}{1- \hat{a}(\hat{z}_0 + z^{(1-\alpha)})}\bigg)\]</span>
y <span class="math inline">\(\Phi\)</span> es la función de distribución acumulada de la distribución normal estándar
y <span class="math inline">\(z^{\alpha}\)</span> es el percentil <span class="math inline">\(100 \cdot \alpha\)</span> de una distribución normal
estándar.</p>
<p>Notemos que si <span class="math inline">\(\hat{a}\)</span> y <span class="math inline">\(\hat{z}_0\)</span> son cero entonces <span class="math inline">\(\alpha_1=\alpha\)</span><br />
y <span class="math inline">\(\alpha_2=1-\alpha\)</span>, obteniendo así los intervalos de percentiles.
El valor de la corrección por sesgo <span class="math inline">\(\hat{z}_0\)</span> se obtiene de la
propoción de de replicaciones bootstrap menores a la estimación original
<span class="math inline">\(\hat{\theta}\)</span>,</p>
<p><span class="math display">\[z_0=\Phi^{-1}\bigg(\frac{\#\{\hat{\theta}^*(b) &lt; \hat{\theta} \} }{B} \bigg)\]</span></p>
<p>a grandes razgos <span class="math inline">\(\hat{z}_0\)</span> mide la mediana del sesgo de <span class="math inline">\(\hat{\theta}^*\)</span>, esto
es, la discrepancia entre la mediana de <span class="math inline">\(\hat{\theta}^*\)</span> y <span class="math inline">\(\hat{\theta}\)</span> en
unidades normales.</p>
<p>Por su parte la aceleración <span class="math inline">\(\hat{a}\)</span> se refiere a la tasa de cambio del error
estándar de <span class="math inline">\(\hat{\theta}\)</span> respecto al verdadero valor del parámetro <span class="math inline">\(\theta\)</span>.
La aproximación estándar usual <span class="math inline">\(\hat{\theta} \approx N(\theta, se^2)\)</span> supone que
el error estándar de <span class="math inline">\(\hat{\theta}\)</span> es el mismo para toda <span class="math inline">\(\hat{\theta}\)</span>, esto
puede ser poco realista, en nuestro ejemplo, donde <span class="math inline">\(\hat{\theta}\)</span> es la varianza
si los datos provienen de una normal <span class="math inline">\(se(\hat{\theta})\)</span> depende de <span class="math inline">\(\theta\)</span>.
Una manera de calcular <span class="math inline">\(\hat{a}\)</span> es</p>
<p><span class="math display">\[\hat{a}=\frac{\sum_{i=1}^n (\hat{\theta}(\cdot) - \hat{\theta}(i))^3}{6\{\sum_{i=1}^n (\hat{\theta}(\cdot) - \hat{\theta}(i))^2\}^{3/2}}\]</span></p>
<p>Los intervalos <span class="math inline">\(BC_{a}\)</span> tienen 2 ventajas teóricas:</p>
<ol style="list-style-type: decimal">
<li><p>Respetan transformaciones, esto nos dice que los extremos del intervalo se
transforman de manera adecuada si cambiamos el parámetro de interés por una
función del mismo.</p></li>
<li><p>Su exactitud, los intervalos <span class="math inline">\(BC_{a}\)</span> tienen precisión de segundo orden, esto
es, los errores de cobertura se van a cero a una tasa de 1/n.</p></li>
</ol>
<p>Los intervalos <span class="math inline">\(BC_{a}\)</span> están implementados en el paquete boot (<code>boot.ci()</code>) y
en el paquete bootstrap (<code>bcanon()</code>). La desventaja de los intervalos <span class="math inline">\(BC_{a}\)</span> es
que requieren intenso cómputo estadístico, de acuerdo a <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span> al
menos <span class="math inline">\(B= 1000\)</span> replicaciones son necesarias para reducir el error de muestreo.</p>
<p>Ante esto surgen los intervalos ABC (approximate bootstrap confidence
intervals), que es un método para aproximar <span class="math inline">\(BC_{a}\)</span> analíticamente (usando
expansiones de Taylor), estos intervalos requieren que la estadística
<span class="math inline">\(\hat{\theta} = s(x)\)</span> este definida de manera suave sobre x (la mediana, por
ejemplo, no es suave).</p>
<p>Usando la implementación del paquete bootstrap:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">var_sesgada &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb219-2" data-line-number="2"><span class="kw">bcanon</span>(<span class="dt">x =</span> spatial[, <span class="dv">1</span>], <span class="dt">nboot =</span> <span class="dv">2000</span>, <span class="dt">theta =</span> var_sesgada, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb219-3" data-line-number="3"><span class="co">#&gt; $confpoints</span></a>
<a class="sourceLine" id="cb219-4" data-line-number="4"><span class="co">#&gt;      alpha bca point</span></a>
<a class="sourceLine" id="cb219-5" data-line-number="5"><span class="co">#&gt; [1,] 0.025  103.8402</span></a>
<a class="sourceLine" id="cb219-6" data-line-number="6"><span class="co">#&gt; [2,] 0.975  274.0533</span></a>
<a class="sourceLine" id="cb219-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb219-8" data-line-number="8"><span class="co">#&gt; $z0</span></a>
<a class="sourceLine" id="cb219-9" data-line-number="9"><span class="co">#&gt; [1] 0.1383042</span></a>
<a class="sourceLine" id="cb219-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb219-11" data-line-number="11"><span class="co">#&gt; $acc</span></a>
<a class="sourceLine" id="cb219-12" data-line-number="12"><span class="co">#&gt; [1] 0.06124012</span></a>
<a class="sourceLine" id="cb219-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb219-14" data-line-number="14"><span class="co">#&gt; $u</span></a>
<a class="sourceLine" id="cb219-15" data-line-number="15"><span class="co">#&gt;  [1] 164.3936 176.7200 174.5184 178.3776 172.0544 172.0544 174.5184</span></a>
<a class="sourceLine" id="cb219-16" data-line-number="16"><span class="co">#&gt;  [8] 172.0544 175.9584 173.0400 168.5984 168.2016 155.1200 141.8144</span></a>
<a class="sourceLine" id="cb219-17" data-line-number="17"><span class="co">#&gt; [15] 177.9296 178.2816 177.6096 151.0176 178.1664 177.0656 165.8784</span></a>
<a class="sourceLine" id="cb219-18" data-line-number="18"><span class="co">#&gt; [22] 173.0400 177.0656 177.8400 178.3904 173.0400</span></a>
<a class="sourceLine" id="cb219-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb219-20" data-line-number="20"><span class="co">#&gt; $call</span></a>
<a class="sourceLine" id="cb219-21" data-line-number="21"><span class="co">#&gt; bcanon(x = spatial[, 1], nboot = 2000, theta = var_sesgada, alpha = c(0.025, </span></a>
<a class="sourceLine" id="cb219-22" data-line-number="22"><span class="co">#&gt;     0.975))</span></a></code></pre></div>
<p><img src="img/manicule2.jpg" /> Comapara el intervalo anterior con los intervalos
normal y de percentiles.</p>
<p>Otros intervalos basados en bootstrap incluyen los intervalos pivotales y los
intervalos bootstrap-t. Sin embargo, BC y ABC son mejores alternativas.</p>
<div class="caja">
<ol start="4" style="list-style-type: decimal">
<li><strong>Intervalos pivotales</strong>. Sea <span class="math inline">\(\theta=s(P)\)</span> y <span class="math inline">\(\hat{\theta}=s(P_n)\)</span> definimos
el pivote <span class="math inline">\(R=\hat{\theta}-\theta\)</span>. Sea <span class="math inline">\(H(r)\)</span> la función de distribución
acumulada del pivote:
<span class="math display">\[H(r) = P(R&lt;r)\]</span></li>
</ol>
<p>Definimos <span class="math inline">\(C_n^*=(a,b)\)</span> donde:
<span class="math display">\[a=\hat{\theta}-H^{-1}(1-\alpha), b=\hat{\theta}-H^{-1}(\alpha)\]</span>
<span class="math inline">\(C_n^*\)</span> es un intervalo de confianza de <span class="math inline">\(1-2\alpha\)</span> para <span class="math inline">\(\theta\)</span>; sin
embargo, <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> dependen de la distribución desconocida <span class="math inline">\(H\)</span>, la podemos
estimar usando bootstrap:
<span class="math display">\[\hat{H}(r)=\frac{1}{B}\sum_{b=1}^B I(R^*_b \le r)\]</span>
y obtenemos
<span class="math display">\[C_n=(2\hat{\theta} - \hat{\theta}^*_{1-\alpha}, 2\hat{\theta} + \hat{\theta}^*_{1-\alpha})\]</span></p>
</div>
<div class="caja">
<p><strong>Exactitud en intervalos de confianza.</strong> Un intervalo de <span class="math inline">\(95%\)</span> de confianza
exacto no captura el verdadero valor <span class="math inline">\(2.5%\)</span> de las veces, en cada lado.</p>
<p>Un intervalo que sub-cubre un lado y sobre-cubre el otro es <strong>sesgado</strong>.</p>
</div>
<ul>
<li><p>Los intervalos estándar y de percentiles tienen exactitud de primer
orden: los errores de cobertura se van a cero a una tasa de <span class="math inline">\(1/\sqrt{n}\)</span>. Suelen
ser demasido estrechos resultando en cobertura real menor a la nominal,
sobretodo con muestras chicas.</p></li>
<li><p>Los intervalos <span class="math inline">\(BC_a\)</span> tienen exactitud de segundo
orden: los errores de cobertura se van a cero a una tasa de <span class="math inline">\(1/n\)</span>.</p></li>
<li><p>A pesar de que los intervalos <span class="math inline">\(BC_a\)</span> pueden ser superiores a los intervalos
normales y de percentiles, en la práctica es más común utilizar intervalos
normales o de percentiles pues su implementación es más sencilla y son
adecuados para un gran número de casos.</p></li>
</ul>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-efron">
<p>Efron, Bradley, and Robert J. Tibshirani. 1993. <em>An Introduction to the Bootstrap</em>. Monographs on Statistics and Applied Probability 57. Boca Raton, Florida, USA: Chapman &amp; Hall/CRC.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="el-estimador-bootstrap-del-error-estándar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="más-alla-de-muestras-aleatorias-simples.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/05-bootstrap_no_parametrico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
