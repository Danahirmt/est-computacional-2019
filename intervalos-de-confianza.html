<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.3 Intervalos de confianza | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="6.3 Intervalos de confianza | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.3 Intervalos de confianza | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="el-estimador-bootstrap-del-error-estandar.html"/>
<link rel="next" href="mas-alla-de-muestras-aleatorias-simples.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificacion"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#noticias"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualizacion.html"><a href="principios-visualizacion.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-de-datos-en-la-estadistica"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#visualizacion-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoria-de-visualizacion-de-datos.html"><a href="teoria-de-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engano-y-chartjunk.html"><a href="factor-de-engano-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequenos-multiplos-y-densidad-grafica.html"><a href="pequenos-multiplos-y-densidad-grafica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoracion.html"><a href="decoracion.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepcion-de-escala.html"><a href="percepcion-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-grafica-de-minard.html"><a href="ejemplos-grafica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduccion-a-r-y-al-paquete-ggplot2.html"><a href="introduccion-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-analisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualizacion-con-ggplot2.html"><a href="visualizacion-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-agrupacion-de-datos.html"><a href="manipulacion-y-agrupacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#summarise-y-resumenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos.html"><a href="transformacion-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-mas-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteracion.html"><a href="funciones-e-iteracion.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteracion.html"><a href="funciones-e-iteracion.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteracion.html"><a href="iteracion.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeno"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
<li class="chapter" data-level="4.4.1" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#lecturas-y-recursos-recomendados-de-r"><i class="fa fa-check"></i><b>4.4.1</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-calculo-de-probabilidades.html"><a href="introduccion-a-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extension-de-proporcion.html"><a href="probabilidad-como-extension-de-proporcion.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretacion-frecuentista-de-probabilidad.html"><a href="interpretacion-frecuentista-de-probabilidad.html#resultados-empiricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulacion-para-el-calculo-de-probabilidades.html"><a href="simulacion-para-el-calculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definicion-general.html"><a href="modelos-de-probabilidad-definicion-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definicion-matematica.html"><a href="probabilidad-definicion-matematica.html#propiedades-de-la-funcion-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribucion-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-parametrico.html"><a href="bootstrap-no-parametrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#funcion-de-distribucion-empirica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parametros-y-estadisticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estandar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estandar.html"><a href="el-estimador-bootstrap-del-error-estandar.html#variacion-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="mas-alla-de-muestras-aleatorias-simples.html"><a href="mas-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalacion-y-visualizacion.html"><a href="instalacion-y-visualizacion.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformacion-de-datos-1.html"><a href="transformacion-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="union-de-tablas-y-limpieza-de-datos.html"><a href="union-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programacion-funcional-y-distribucion-muestral.html"><a href="programacion-funcional-y-distribucion-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intervalos-de-confianza" class="section level2">
<h2><span class="header-section-number">6.3</span> Intervalos de confianza</h2>
<p>Hasta ahora hemos discutido la idea detrás del bootstrap y como se puede usar
para estimar errores estándar. Comenzamos con el error estándar pues es la
manera más común para describir la precisión de una estadística.</p>
<ul>
<li><p>En términos generales, esperamos que <span class="math inline">\(\bar{x}\)</span> este a una distancia de <span class="math inline">\(\mu_P\)</span>
menor a un error estándar el 68% del tiempo, y a menos de 2 errores estándar el
95% del tiempo.</p></li>
<li><p>Estos porcentajes están basados el teorema central del límite que nos dice que
bajo ciertas condiciones (bastante generales) de <span class="math inline">\(P\)</span> la distribución de
<span class="math inline">\(\bar{x}\)</span> se aproximará a una distribución normal:</p></li>
</ul>
<p><span class="math display">\[\bar{x} \overset{\cdot}{\sim} N(\mu_P,\sigma_P^2/n)\]</span></p>
<p>Veamos algunos ejemplos de como funciona el Teorema del Límite
Central, buscamos ver como se aproxima la distribución muestral de la media
(cuando las observaciones provienen de distintas distribuciones) a una
Normal conforme aumenta el tamaño de muestra. Para esto, aproximamos la
distribución muestral de la media usando simulación de la población.</p>
<p>Vale la pena observar que hay distribuciones que requieren un mayor tamaño
de muestra <span class="math inline">\(n\)</span> para lograr una buena aproximación (por ejemplo la log-normal),
¿a qué se debe esto?</p>
<p>Para la opción de <em>Elecciones</em> tenemos una población de tamaño <span class="math inline">\(N=143,437\)</span> y el
objetivo es estimar la media del tamaño de la lista nominal de las casillas
(datos de las elecciones presidenciales de 2012). Podemos ver como mejora la
aproximación Normal de la distribución muestral conforme aumenta el tamaño de
muestra <span class="math inline">\(n\)</span>; sin embargo, también sobresale que no es necesario tomar una
muestra demasiado grande (<span class="math inline">\(n = 60\)</span> ya es razonable).</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">include_app</span>(<span class="st">&quot;https://tereom.shinyapps.io/15-TLC/&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;1000px&quot;</span>)</a></code></pre></div>
<iframe src="https://tereom.shinyapps.io/15-TLC/?showcase=0" width="672" height="1000px">
</iframe>
<p>En lo que sigue veremos distintas maneras de construir intervalos de confianza
usando bootstrap.</p>
<div class="caja">
<p>Un <strong>intervalo de confianza</strong> <span class="math inline">\((1-2\alpha)\)</span>% para un parámetro <span class="math inline">\(\theta\)</span> es un
intervalo <span class="math inline">\((a,b)\)</span> tal que <span class="math inline">\(P(a \le \theta \le b) = 1-2\alpha\)</span> para todo
<span class="math inline">\(\theta \in \Theta\)</span>.</p>
</div>
<p>Y comenzamos con la versión bootstrap del intervalo más popular.</p>
<div class="caja">
<ol style="list-style-type: decimal">
<li><strong>Intervalo Normal</strong> con error estándar bootstrap.
El intervalo para <span class="math inline">\(\hat{\theta}\)</span> con un nivel de confianza de
<span class="math inline">\(100\cdot(1-2\alpha)\%\)</span> se define como:</li>
</ol>
<p><span class="math display">\[(\hat{\theta}-z^{(1-\alpha)}\cdot \hat{se}_B, \hat{\theta}+z^{(1-\alpha)}\cdot \hat{se})\]</span>.</p>
<p>donde <span class="math inline">\(z^{(\alpha)}\)</span> denota el percentil <span class="math inline">\(100\cdot \alpha\)</span> de una
distribución <span class="math inline">\(N(0,1)\)</span>.</p>
</div>
<p>este intervalo está soportado por el Teorema Central del Límite, sin embargo,
no es adecuado cuando <span class="math inline">\(\hat{\theta}\)</span> no se distribuye aproximadamente Normal.</p>
<div id="ejemplo-kurtosis" class="section level4">
<h4><span class="header-section-number">6.3.0.1</span> Ejemplo: kurtosis</h4>
<p>Supongamos que queremos estimar la kurtosis de una base de datos que consta de
799 tiempos de espera entre pulsasiones de un nervio (Cox, Lewis 1976).</p>
<p><span class="math display">\[\hat{\theta} = t(P_n) =\frac{1/n \sum_{i=1}^n(x_i-\hat{\mu})^3}{\hat{\sigma}^3}\]</span></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="kw">library</span>(ACSWR)</a>
<a class="sourceLine" id="cb199-2" data-line-number="2"><span class="kw">data</span>(<span class="st">&quot;nerve&quot;</span>)</a>
<a class="sourceLine" id="cb199-3" data-line-number="3"><span class="kw">head</span>(nerve)</a>
<a class="sourceLine" id="cb199-4" data-line-number="4"><span class="co">#&gt; [1] 0.21 0.03 0.05 0.11 0.59 0.06</span></a>
<a class="sourceLine" id="cb199-5" data-line-number="5"></a>
<a class="sourceLine" id="cb199-6" data-line-number="6">kurtosis &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb199-7" data-line-number="7">    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb199-8" data-line-number="8">    <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">^</span><span class="st"> </span><span class="dv">3</span> </a>
<a class="sourceLine" id="cb199-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb199-10" data-line-number="10"></a>
<a class="sourceLine" id="cb199-11" data-line-number="11">theta_hat &lt;-<span class="st"> </span><span class="kw">kurtosis</span>(nerve)</a>
<a class="sourceLine" id="cb199-12" data-line-number="12">theta_hat</a>
<a class="sourceLine" id="cb199-13" data-line-number="13"><span class="co">#&gt; [1] 1.757943</span></a>
<a class="sourceLine" id="cb199-14" data-line-number="14"></a>
<a class="sourceLine" id="cb199-15" data-line-number="15">kurtosis_boot &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb199-16" data-line-number="16">  x_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb199-17" data-line-number="17">  <span class="kw">kurtosis</span>(x_boot)</a>
<a class="sourceLine" id="cb199-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb199-19" data-line-number="19">B &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb199-20" data-line-number="20">kurtosis &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">kurtosis_boot</span>(nerve)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb199-21" data-line-number="21"><span class="st">  </span><span class="kw">flatten_dbl</span>()</a></code></pre></div>
<p>Usando el intervalo normal tenemos:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">li_normal &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb200-2" data-line-number="2">ls_normal &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb200-3" data-line-number="3"><span class="kw">c</span>(li_normal, ls_normal)</a>
<a class="sourceLine" id="cb200-4" data-line-number="4"><span class="co">#&gt; [1] 1.44 2.08</span></a></code></pre></div>
<p>Una modificación común del intervalo normal es el intervalo t, estos intervalos
son mejores en caso de muestras pequeñas (<span class="math inline">\(n\)</span> chica).</p>
<div class="caja">
<ol start="2" style="list-style-type: decimal">
<li><strong>Intervalo <span class="math inline">\(t\)</span></strong> con error estándar bootstrap. Para una muestra de tamaño
<span class="math inline">\(n\)</span> el intervalo <span class="math inline">\(t\)</span> con un nivel de confianza de <span class="math inline">\(100\cdot(1-2\alpha)\%\)</span> se
define como:</li>
</ol>
<p><span class="math display">\[(\hat{\theta}-t^{(1-\alpha)}_{n-1}\cdot \hat{se}_B, \hat{\theta}+t^{(1-\alpha)}_{n-1}\cdot \hat{se}_B)\]</span>.</p>
<p>donde <span class="math inline">\(t^{(\alpha)}_{n-1}\)</span> denota denota el percentil <span class="math inline">\(100\cdot \alpha\)</span> de una
distribución <span class="math inline">\(t\)</span> con <span class="math inline">\(n-1\)</span> grados de libertad.</p>
</div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1">n_nerve &lt;-<span class="st"> </span><span class="kw">length</span>(nerve)</a>
<a class="sourceLine" id="cb201-2" data-line-number="2">li_t &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.025</span>, n_nerve <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb201-3" data-line-number="3">ls_t &lt;-<span class="st"> </span><span class="kw">round</span>(theta_hat <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.025</span>, n_nerve <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(kurtosis), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb201-4" data-line-number="4"><span class="kw">c</span>(li_t, ls_t)</a>
<a class="sourceLine" id="cb201-5" data-line-number="5"><span class="co">#&gt; [1] 1.44 2.08</span></a></code></pre></div>
<p>Los intervalos normales y <span class="math inline">\(t\)</span> se valen de la estimación bootstrap del error
estándar; sin embargo, el bootstrap se puede usar para estimar la función de
distribución de <span class="math inline">\(\hat{\theta}\)</span> por lo que no es necesario hacer supuestos
distribucionales para <span class="math inline">\(\hat{\theta}\)</span> sino que podemos estimarla como parte del
proceso de construir intervalos de confianza.</p>
<p>Veamos un histograma de las replicaciones bootstrap de <span class="math inline">\(\hat{\theta}^*\)</span></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb202-2" data-line-number="2">nerve_kurtosis &lt;-<span class="st"> </span><span class="kw">tibble</span>(kurtosis)</a>
<a class="sourceLine" id="cb202-3" data-line-number="3">hist_nerve &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nerve_kurtosis, <span class="kw">aes</span>(<span class="dt">x =</span> kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb202-4" data-line-number="4"><span class="st">        </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb202-5" data-line-number="5"><span class="st">            </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(li_normal, ls_normal, theta_hat), </a>
<a class="sourceLine" id="cb202-6" data-line-number="6">            <span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb202-7" data-line-number="7"></a>
<a class="sourceLine" id="cb202-8" data-line-number="8">qq_nerve &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nerve_kurtosis) <span class="op">+</span></a>
<a class="sourceLine" id="cb202-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb202-10" data-line-number="10"><span class="st">  </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> kurtosis), <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(kurtosis), <span class="dt">sd =</span> <span class="kw">sd</span>(kurtosis))) </a>
<a class="sourceLine" id="cb202-11" data-line-number="11"></a>
<a class="sourceLine" id="cb202-12" data-line-number="12"><span class="kw">grid.arrange</span>(hist_nerve, qq_nerve, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-11-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>En el ejemplo anterior el supuesto de normalidad parece razonable, veamos
como se comparan los cuantiles de la estimación de la distribución de
<span class="math inline">\(\hat{\theta}\)</span> con los cuantiles de una normal:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="kw">comma</span>(q_kurt &lt;-<span class="st"> </span><span class="kw">quantile</span>(kurtosis, </a>
<a class="sourceLine" id="cb203-2" data-line-number="2">  <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)))</a>
<a class="sourceLine" id="cb203-3" data-line-number="3"><span class="kw">comma</span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="dt">mean =</span> theta_hat, </a>
<a class="sourceLine" id="cb203-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(kurtosis)))</a>
<a class="sourceLine" id="cb203-5" data-line-number="5"><span class="co">#&gt;  2.5%    5%   10%   90%   95% 97.5% </span></a>
<a class="sourceLine" id="cb203-6" data-line-number="6"><span class="co">#&gt; &quot;1.4&quot; &quot;1.5&quot; &quot;1.5&quot; &quot;2.0&quot; &quot;2.0&quot; &quot;2.1&quot; </span></a>
<a class="sourceLine" id="cb203-7" data-line-number="7"><span class="co">#&gt; [1] &quot;1.4&quot; &quot;1.5&quot; &quot;1.5&quot; &quot;2.0&quot; &quot;2.0&quot; &quot;2.1&quot;</span></a></code></pre></div>
<p>Esto sugiere usar los cuantiles del histograma bootstrap para definir los
límites de los intervalos de confianza:</p>
<div class="caja">
<ol start="3" style="list-style-type: decimal">
<li><strong>Percentiles</strong>. Denotemos por <span class="math inline">\(G\)</span> la función de distribución acumulada de
<span class="math inline">\(\hat{\theta}^*\)</span> el intervalo percentil de <span class="math inline">\(1-2\alpha\)</span> se define por los
percentiles <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(1-\alpha\)</span> de <span class="math inline">\(G\)</span>
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup}) = (G^{-1}(\alpha), G^{-1}(1-\alpha))\]</span>
Por definición <span class="math inline">\(G^{-1}(\alpha)=\hat{\theta}^*(\alpha)\)</span>, esto es, el percentil
<span class="math inline">\(100\cdot \alpha\)</span> de la distribución bootstrap, por lo que podemos escribir el
intervalo bootstrap como
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup})=(\hat{\theta}^*(\alpha),\hat{\theta}^*(1-\alpha))\]</span></li>
</ol>
</div>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">arrange</span>(nerve_kurtosis, kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-2" data-line-number="2"><span class="st">    </span><span class="kw">stat_ecdf</span>(<span class="kw">aes</span>(<span class="dt">x =</span> kurtosis)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> <span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>, q_kurt[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)]), </a>
<a class="sourceLine" id="cb204-4" data-line-number="4">        <span class="dt">xend =</span> q_kurt[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">6</span>)], <span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb204-5" data-line-number="5">        <span class="dt">yend =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, </a>
<a class="sourceLine" id="cb204-6" data-line-number="6">        <span class="dt">yend =</span> yend), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">0.4</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Cuantiles muestrales&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;ecdf&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Las expresiones de arriba hacen referencia a la situación bootstrap <em>ideal</em>
donde el número de replicaciones bootstrap es infinito, en la práctica usamos
aproximaciones. Y se procede como sigue:</p>
<div style="caja">
<p>Intervalo percentil:</p>
<ul>
<li><p>Generamos B muestras bootstrap independientes <span class="math inline">\(\textbf{x}^{*1},..., \textbf{x}^{*B}\)</span> y calculamos las replicaciones <span class="math inline">\(\hat{\theta}^{*b}=s(x^{*b}).\)</span></p></li>
<li>Sea <span class="math inline">\(\hat{\theta}^{*}_B(\alpha)\)</span> el percentil <span class="math inline">\(100\cdot\alpha\)</span> de la
distribución empírica de <span class="math inline">\(\hat{\theta}^{*}\)</span>, y <span class="math inline">\(\hat{\theta}^{*}_B(1-\alpha)\)</span>
el correspondiente al percentil <span class="math inline">\(100\cdot (1-\alpha)\)</span>, escribimos el intervalo
de percentil <span class="math inline">\(1-2\alpha\)</span> como
<span class="math display">\[(\theta^*_{\%,inf}, \theta^*_{\%,sup})\approx(\hat{\theta}^*_B(\alpha),\hat{\theta}^*_B(1-\alpha))\]</span></li>
</ul>
</div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">ls_per &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">quantile</span>(kurtosis, <span class="dt">prob =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb205-2" data-line-number="2">li_per &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">quantile</span>(kurtosis, <span class="dt">prob =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb205-3" data-line-number="3">stringr<span class="op">::</span><span class="kw">str_c</span>(li_normal, ls_normal, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb205-4" data-line-number="4">stringr<span class="op">::</span><span class="kw">str_c</span>(li_per, ls_per, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb205-5" data-line-number="5"><span class="co">#&gt; [1] &quot;1.44,2.08&quot;</span></a>
<a class="sourceLine" id="cb205-6" data-line-number="6"><span class="co">#&gt; [1] &quot;1.42,2.07&quot;</span></a></code></pre></div>
<p>Si la distribución de <span class="math inline">\(\hat{\theta}^*\)</span> es aproximadamente normal, entonces
los intervalos normales y de percentiles serán similares.</p>
<p>Con el fin de comparar los intervalos creamos un ejemplo de simulación
(ejemplo tomado de <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>), generamos una muestra de tamaño 10 de una
distribución normal estándar, supongamos que el parámetro de interés es
<span class="math inline">\(e^{\mu}\)</span> donde <span class="math inline">\(\mu\)</span> es la media poblacional.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">137612</span>)</a>
<a class="sourceLine" id="cb206-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb206-3" data-line-number="3"></a>
<a class="sourceLine" id="cb206-4" data-line-number="4">boot_sim_exp &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb206-5" data-line-number="5">  x_boot &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb206-6" data-line-number="6">  <span class="kw">exp</span>(<span class="kw">mean</span>(x_boot))</a>
<a class="sourceLine" id="cb206-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb206-8" data-line-number="8">theta_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">boot_sim_exp</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb206-9" data-line-number="9">theta_boot_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(theta_boot)</a>
<a class="sourceLine" id="cb206-10" data-line-number="10"></a>
<a class="sourceLine" id="cb206-11" data-line-number="11">hist_emu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(theta_boot_df, <span class="kw">aes</span>(<span class="dt">x =</span> theta_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">0.08</span>) </a>
<a class="sourceLine" id="cb206-13" data-line-number="13">qq_emu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(theta_boot_df) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-15" data-line-number="15"><span class="st">    </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> theta_boot), </a>
<a class="sourceLine" id="cb206-16" data-line-number="16">        <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(theta_boot), <span class="dt">sd =</span> <span class="kw">sd</span>(theta_boot))) </a>
<a class="sourceLine" id="cb206-17" data-line-number="17"></a>
<a class="sourceLine" id="cb206-18" data-line-number="18"><span class="kw">grid.arrange</span>(hist_emu, qq_emu, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-15-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>La distribución empírica de <span class="math inline">\(\hat{\theta}^*\)</span> es asimétrica, por lo que no
esperamos que coincidan los intervalos.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb207-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">exp</span>(<span class="kw">mean</span>(x)) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(theta_boot), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb207-3" data-line-number="3"><span class="co">#&gt; [1] 0.36</span></a>
<a class="sourceLine" id="cb207-4" data-line-number="4"><span class="kw">round</span>(<span class="kw">exp</span>(<span class="kw">mean</span>(x)) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(theta_boot), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb207-5" data-line-number="5"><span class="co">#&gt; [1] 1.6</span></a>
<a class="sourceLine" id="cb207-6" data-line-number="6"></a>
<a class="sourceLine" id="cb207-7" data-line-number="7"><span class="co">#Percentil</span></a>
<a class="sourceLine" id="cb207-8" data-line-number="8"><span class="kw">round</span>(<span class="kw">quantile</span>(theta_boot, <span class="dt">prob =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb207-9" data-line-number="9"><span class="co">#&gt; 2.5% </span></a>
<a class="sourceLine" id="cb207-10" data-line-number="10"><span class="co">#&gt; 0.53</span></a>
<a class="sourceLine" id="cb207-11" data-line-number="11"><span class="kw">round</span>(<span class="kw">quantile</span>(theta_boot, <span class="dt">prob =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb207-12" data-line-number="12"><span class="co">#&gt; 97.5% </span></a>
<a class="sourceLine" id="cb207-13" data-line-number="13"><span class="co">#&gt;  1.79</span></a></code></pre></div>
<p>La inspección del histograma deja claro que la aproximación normal no es
conveniente en este caso, veamos que ocurre cuando aplicamos la transformación
logarítmica.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1">hist_log &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(theta_boot), <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(theta_boot))) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">0.08</span>) </a>
<a class="sourceLine" id="cb208-3" data-line-number="3">qq_log &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(theta_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-5" data-line-number="5"><span class="st">    </span><span class="kw">stat_qq</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(theta_boot)), </a>
<a class="sourceLine" id="cb208-6" data-line-number="6">        <span class="dt">dparams =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(<span class="kw">log</span>(theta_boot)), <span class="dt">sd =</span> <span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)))) </a>
<a class="sourceLine" id="cb208-7" data-line-number="7"></a>
<a class="sourceLine" id="cb208-8" data-line-number="8"><span class="kw">grid.arrange</span>(hist_log, qq_log, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">newpage =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-17-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>Y los intervalos se comparan:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb209-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb209-3" data-line-number="3"><span class="co">#&gt; [1] -0.63</span></a>
<a class="sourceLine" id="cb209-4" data-line-number="4"><span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb209-5" data-line-number="5"><span class="co">#&gt; [1] 0.58</span></a>
<a class="sourceLine" id="cb209-6" data-line-number="6"></a>
<a class="sourceLine" id="cb209-7" data-line-number="7"><span class="co">#Percentil</span></a>
<a class="sourceLine" id="cb209-8" data-line-number="8"><span class="kw">round</span>(<span class="kw">quantile</span>(<span class="kw">log</span>(theta_boot), <span class="dt">prob =</span> <span class="fl">0.025</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb209-9" data-line-number="9"><span class="co">#&gt;  2.5% </span></a>
<a class="sourceLine" id="cb209-10" data-line-number="10"><span class="co">#&gt; -0.63</span></a>
<a class="sourceLine" id="cb209-11" data-line-number="11"><span class="kw">round</span>(<span class="kw">quantile</span>(<span class="kw">log</span>(theta_boot), <span class="dt">prob =</span> <span class="fl">0.975</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb209-12" data-line-number="12"><span class="co">#&gt; 97.5% </span></a>
<a class="sourceLine" id="cb209-13" data-line-number="13"><span class="co">#&gt;  0.58</span></a></code></pre></div>
<p>La transformación logarítmica convierte la distribución de <span class="math inline">\(\hat{\theta}\)</span> en
normal y por tanto los intervalos de <span class="math inline">\(\hat{\phi}^*=log(\hat{\theta}^*)\)</span> son
similares. La forma normal no es sorprendente pues <span class="math inline">\(\hat{\phi}^*=\bar{x}^*\)</span>.</p>
<p>Si mapeamos los intervalos normales calculados para <span class="math inline">\(log(\hat{\theta}^*)\)</span> de
regreso a la escala de <span class="math inline">\(\theta\)</span> obtenemos intervalos similares a los calculados
para <span class="math inline">\(\hat{\theta}^*\)</span> usando percentiles:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb210-2" data-line-number="2"><span class="co">#&gt; [1] 0.5325918</span></a>
<a class="sourceLine" id="cb210-3" data-line-number="3"><span class="kw">exp</span>(<span class="kw">round</span>(<span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(theta_boot)), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb210-4" data-line-number="4"><span class="co">#&gt; [1] 1.786038</span></a></code></pre></div>
<p>Podemos ver que el método de aplicar una transformación, calcular intervalos
usando la normal y aplicar la transformación inversa para volver a la escala
original genera intervalos de confianza atractivos, el problema con este
método es que requiere que conozcamos la transformación adecuada para cada
parámetro.</p>
<p>Por otra parte, podemos pensar en el método del percentil como un
algoritmo que incorpora la transformación de manera automática.</p>
<div class="caja">
<p><strong>Lema</strong>. Supongamos que la transformación <span class="math inline">\(\hat{\phi}=m(\hat{\theta})\)</span>
normaliza la distribución de <span class="math inline">\(\hat{\theta}\)</span> de manera perfecta,
<span class="math display">\[\hat{\phi} \approx N(\phi, c^2)\]</span>
para alguna desviación estándar <span class="math inline">\(c\)</span>. Entonces el intervalo de percentil basado
en <span class="math inline">\(\hat{\theta}\)</span> es igual a
<span class="math display">\[(m^{-1} (\hat{\phi}-z^{(1-\alpha)}c), m^{-1}(\hat{\phi}-z^{(\alpha)}c))\]</span></p>
</div>
<p>Se dice que el intervalo de confianza de percentiles es <strong>invariante a transformaciones</strong>.</p>
<p>Existen otras alternativas al método del percentil y cubren otras fallas del
intervalo normal. Por ejemplo, hay ocasiones en que <span class="math inline">\(\hat{\theta}\)</span> tiene una
distribución normal sesgada:
<span class="math display">\[\hat{\theta} \approx N(\theta + sesgo, \hat{se}^2)\]</span></p>
<p>en este caso no existe una transformación <span class="math inline">\(m(\theta)\)</span> que <em>arregle</em> el
intervalo.</p>
<div class="caja">
<ol start="3" style="list-style-type: decimal">
<li><strong>Intervalos acelerados y corregidos por sesgo</strong>. Esta es una versión
mejorada del intervalo de percentil, la denotamos <span class="math inline">\(BC_{a}\)</span> (<em>bias-corrected and
accelerated</em>).</li>
</ol>
<p>Usaremos un ejemplo de <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span>, los datos constan de los resultados
en dos pruebas espaciales de 26 niños con algún problema neurológico. Supongamos
que queremos calcular un intervalo de confianza de 90% para <span class="math inline">\(\theta=var(A)\)</span>.
El estimador plugin es:
<span class="math display">\[\hat{\theta}=\sum_{i=1}^n(A_i-\bar{A})^2/n\]</span>
notemos que el estimador <em>plug-in</em> es ligeramente menor que el estimador
usual insesgado:
<span class="math display">\[\hat{\theta}=\sum_{i=1}^n(A_i-\bar{A})^2/(n-1)\]</span></p>
</div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb211-2" data-line-number="2"></a>
<a class="sourceLine" id="cb211-3" data-line-number="3"><span class="kw">ggplot</span>(spatial) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(A, B))</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/spatial-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1"></a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="kw">sum</span>((spatial<span class="op">$</span>A <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(spatial<span class="op">$</span>A)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(spatial)</a>
<a class="sourceLine" id="cb212-3" data-line-number="3"><span class="co">#&gt; [1] 171.534</span></a>
<a class="sourceLine" id="cb212-4" data-line-number="4"><span class="kw">sum</span>((spatial<span class="op">$</span>A <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(spatial<span class="op">$</span>A)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(spatial) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb212-5" data-line-number="5"><span class="co">#&gt; [1] 178.3954</span></a></code></pre></div>
<p>El método <span class="math inline">\(BC_{a}\)</span> corrige el sesgo de manera automática, lo cuál es una
de sus prinicipales ventajas comparado con el método del percentil.</p>
<p>Los extremos en los intervalos <span class="math inline">\(BC_{a}\)</span> están dados por percentiles de la
distribución bootstrap, los percentiles usados dependen de dos números <span class="math inline">\(\hat{a}\)</span>
y <span class="math inline">\(\hat{z}_0\)</span>, que se denominan la aceleración y la corrección del sesgo:
<span class="math display">\[BC_a : (\hat{\theta}_{inf}, \hat{\theta}_{sup})=(\hat{\theta}^*(\alpha_1), \hat{\theta}^*(\alpha_2))\]</span>
donde
<span class="math display">\[\alpha_1= \Phi\bigg(\hat{z}_0 + \frac{\hat{z}_0 + z^{(\alpha)}}{1- \hat{a}(\hat{z}_0 + z^{(\alpha)})}\bigg)\]</span>
<span class="math display">\[\alpha_2= \Phi\bigg(\hat{z}_0 + \frac{\hat{z}_0 + z^{(1-\alpha)}}{1- \hat{a}(\hat{z}_0 + z^{(1-\alpha)})}\bigg)\]</span>
y <span class="math inline">\(\Phi\)</span> es la función de distribución acumulada de la distribución normal estándar
y <span class="math inline">\(z^{\alpha}\)</span> es el percentil <span class="math inline">\(100 \cdot \alpha\)</span> de una distribución normal
estándar.</p>
<p>Notemos que si <span class="math inline">\(\hat{a}\)</span> y <span class="math inline">\(\hat{z}_0\)</span> son cero entonces <span class="math inline">\(\alpha_1=\alpha\)</span><br />
y <span class="math inline">\(\alpha_2=1-\alpha\)</span>, obteniendo así los intervalos de percentiles.
El valor de la corrección por sesgo <span class="math inline">\(\hat{z}_0\)</span> se obtiene de la
propoción de de replicaciones bootstrap menores a la estimación original
<span class="math inline">\(\hat{\theta}\)</span>,</p>
<p><span class="math display">\[z_0=\Phi^{-1}\bigg(\frac{\#\{\hat{\theta}^*(b) &lt; \hat{\theta} \} }{B} \bigg)\]</span></p>
<p>a grandes razgos <span class="math inline">\(\hat{z}_0\)</span> mide la mediana del sesgo de <span class="math inline">\(\hat{\theta}^*\)</span>, esto
es, la discrepancia entre la mediana de <span class="math inline">\(\hat{\theta}^*\)</span> y <span class="math inline">\(\hat{\theta}\)</span> en
unidades normales.</p>
<p>Por su parte la aceleración <span class="math inline">\(\hat{a}\)</span> se refiere a la tasa de cambio del error
estándar de <span class="math inline">\(\hat{\theta}\)</span> respecto al verdadero valor del parámetro <span class="math inline">\(\theta\)</span>.
La aproximación estándar usual <span class="math inline">\(\hat{\theta} \approx N(\theta, se^2)\)</span> supone que
el error estándar de <span class="math inline">\(\hat{\theta}\)</span> es el mismo para toda <span class="math inline">\(\hat{\theta}\)</span>, esto
puede ser poco realista, en nuestro ejemplo, donde <span class="math inline">\(\hat{\theta}\)</span> es la varianza
si los datos provienen de una normal <span class="math inline">\(se(\hat{\theta})\)</span> depende de <span class="math inline">\(\theta\)</span>.
Una manera de calcular <span class="math inline">\(\hat{a}\)</span> es</p>
<p><span class="math display">\[\hat{a}=\frac{\sum_{i=1}^n (\hat{\theta}(\cdot) - \hat{\theta}(i))^3}{6\{\sum_{i=1}^n (\hat{\theta}(\cdot) - \hat{\theta}(i))^2\}^{3/2}}\]</span></p>
<p>Los intervalos <span class="math inline">\(BC_{a}\)</span> tienen 2 ventajas teóricas:</p>
<ol style="list-style-type: decimal">
<li><p>Respetan transformaciones, esto nos dice que los extremos del intervalo se
transforman de manera adecuada si cambiamos el parámetro de interés por una
función del mismo.</p></li>
<li><p>Su exactitud, los intervalos <span class="math inline">\(BC_{a}\)</span> tienen precisión de segundo orden, esto
es, los errores de cobertura se van a cero a una tasa de 1/n.</p></li>
</ol>
<p>Los intervalos <span class="math inline">\(BC_{a}\)</span> están implementados en el paquete boot (<code>boot.ci()</code>) y
en el paquete bootstrap (<code>bcanon()</code>). La desventaja de los intervalos <span class="math inline">\(BC_{a}\)</span> es
que requieren intenso cómputo estadístico, de acuerdo a <span class="citation">Efron and Tibshirani (<a href="#ref-efron">1993</a>)</span> al
menos <span class="math inline">\(B= 1000\)</span> replicaciones son necesairas para reducir el error de muestreo.</p>
<p>Ante esto surgen los intervalos ABC (approximate bootstrap confidence
intervals), que es un método para aproximar <span class="math inline">\(BC_{a}\)</span> analíticamente (usando
expansiones de Taylor).</p>
<p>Usando la implementación del paquete bootstrap:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb213-2" data-line-number="2">var_sesgada &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb213-3" data-line-number="3"><span class="kw">bcanon</span>(<span class="dt">x =</span> spatial[, <span class="dv">1</span>], <span class="dt">nboot =</span> <span class="dv">2000</span>, <span class="dt">theta =</span> var_sesgada, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb213-4" data-line-number="4"><span class="co">#&gt; $confpoints</span></a>
<a class="sourceLine" id="cb213-5" data-line-number="5"><span class="co">#&gt;      alpha bca point</span></a>
<a class="sourceLine" id="cb213-6" data-line-number="6"><span class="co">#&gt; [1,] 0.025  103.8402</span></a>
<a class="sourceLine" id="cb213-7" data-line-number="7"><span class="co">#&gt; [2,] 0.975  274.0533</span></a>
<a class="sourceLine" id="cb213-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb213-9" data-line-number="9"><span class="co">#&gt; $z0</span></a>
<a class="sourceLine" id="cb213-10" data-line-number="10"><span class="co">#&gt; [1] 0.1383042</span></a>
<a class="sourceLine" id="cb213-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb213-12" data-line-number="12"><span class="co">#&gt; $acc</span></a>
<a class="sourceLine" id="cb213-13" data-line-number="13"><span class="co">#&gt; [1] 0.06124012</span></a>
<a class="sourceLine" id="cb213-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb213-15" data-line-number="15"><span class="co">#&gt; $u</span></a>
<a class="sourceLine" id="cb213-16" data-line-number="16"><span class="co">#&gt;  [1] 164.3936 176.7200 174.5184 178.3776 172.0544 172.0544 174.5184</span></a>
<a class="sourceLine" id="cb213-17" data-line-number="17"><span class="co">#&gt;  [8] 172.0544 175.9584 173.0400 168.5984 168.2016 155.1200 141.8144</span></a>
<a class="sourceLine" id="cb213-18" data-line-number="18"><span class="co">#&gt; [15] 177.9296 178.2816 177.6096 151.0176 178.1664 177.0656 165.8784</span></a>
<a class="sourceLine" id="cb213-19" data-line-number="19"><span class="co">#&gt; [22] 173.0400 177.0656 177.8400 178.3904 173.0400</span></a>
<a class="sourceLine" id="cb213-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb213-21" data-line-number="21"><span class="co">#&gt; $call</span></a>
<a class="sourceLine" id="cb213-22" data-line-number="22"><span class="co">#&gt; bcanon(x = spatial[, 1], nboot = 2000, theta = var_sesgada, alpha = c(0.025, </span></a>
<a class="sourceLine" id="cb213-23" data-line-number="23"><span class="co">#&gt;     0.975))</span></a></code></pre></div>
<p><img src="img/manicule2.jpg" /> Comapara el intervalo anterior con los intervalos
normal y de percentiles.</p>
<p>Otros intervalos basados en bootstrap incluyen los intervalos pivotales y los
intervalos bootstrap-t. Sin embargo, BC y ABC son mejores alternativas.</p>
<div class="caja">
<ol start="4" style="list-style-type: decimal">
<li><strong>Intervalos pivotales</strong>. Sea <span class="math inline">\(\theta=s(P)\)</span> y <span class="math inline">\(\hat{\theta}=s(P_n)\)</span> definimos
el pivote <span class="math inline">\(R=\hat{\theta}-\theta\)</span>. Sea <span class="math inline">\(H(r)\)</span> la función de distribución
acumulada del pivote:
<span class="math display">\[H(r) = P(R&lt;r)\]</span></li>
</ol>
<p>Definimos <span class="math inline">\(C_n^*=(a,b)\)</span> donde:
<span class="math display">\[a=\hat{\theta}-H^{-1}(1-\alpha), b=\hat{\theta}-H^{-1}(\alpha)\]</span>
<span class="math inline">\(C_n^*\)</span> es un intervalo de confianza de <span class="math inline">\(1-2\alpha\)</span> para <span class="math inline">\(\theta\)</span>; sin
embargo, <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> dependen de la distribución desconocida <span class="math inline">\(H\)</span>, la podemos
estimar usando bootstrap:
<span class="math display">\[\hat{H}(r)=\frac{1}{B}\sum_{b=1}^B I(R^*_b \le r)\]</span>
y obtenemos
<span class="math display">\[C_n=(2\hat{\theta} - \hat{\theta}^*_{1-\alpha}, 2\hat{\theta} + \hat{\theta}^*_{1-\alpha})\]</span></p>
</div>
<div class="caja">
<p><strong>Exactitud en intervalos de confianza.</strong> Un intervalo de <span class="math inline">\(95%\)</span> de confianza
exacto no captura el verdadero valor <span class="math inline">\(2.5%\)</span> de las veces, en cada lado.</p>
<p>Un intervalo que sub-cubre un lado y sobre-cubre el otro es <strong>sesgado</strong>.</p>
</div>
<ul>
<li><p>Los intervalos estándar y de percentiles tienen exactitud de primer
orden: los errores de cobertura se van a cero a una tasa de <span class="math inline">\(1/\sqrt{n}\)</span>.</p></li>
<li><p>Los intervalos <span class="math inline">\(BC_a\)</span> tienen exactitud de segundo
orden: los errores de cobertura se van a cero a una tasa de <span class="math inline">\(1/n\)</span>.</p></li>
<li><p>A pesar de que los intervalos <span class="math inline">\(BC_a\)</span> pueden ser superiores a los intervalos
normales y de percentiles, en la práctica es más común utilizar intervalos
normales o de percentiles pues su implementación es más sencilla y son
adecuados para un gran número de casos.</p></li>
</ul>
</div>
<div id="ejemplo-componentes-principales-calificaciones-en-examenes" class="section level4 unnumbered">
<h4>Ejemplo componentes principales: calificaciones en exámenes</h4>
<p>Los datos <em>marks</em> (Mardia, Kent y Bibby, 1979) contienen los puntajes de 88
estudiantes en 5 pruebas: mecánica, vectores, álgebra, análisis y estadística.
Cada renglón corresponde a la calificación de un estudiante en cada prueba.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="kw">data</span>(marks, <span class="dt">package =</span> <span class="st">&quot;ggm&quot;</span>)</a>
<a class="sourceLine" id="cb214-2" data-line-number="2"><span class="kw">glimpse</span>(marks)</a>
<a class="sourceLine" id="cb214-3" data-line-number="3"><span class="co">#&gt; Observations: 88</span></a>
<a class="sourceLine" id="cb214-4" data-line-number="4"><span class="co">#&gt; Variables: 5</span></a>
<a class="sourceLine" id="cb214-5" data-line-number="5"><span class="co">#&gt; $ mechanics  &lt;dbl&gt; 77, 63, 75, 55, 63, 53, 51, 59, 62, 64, 52, 55, 50, 6…</span></a>
<a class="sourceLine" id="cb214-6" data-line-number="6"><span class="co">#&gt; $ vectors    &lt;dbl&gt; 82, 78, 73, 72, 63, 61, 67, 70, 60, 72, 64, 67, 50, 6…</span></a>
<a class="sourceLine" id="cb214-7" data-line-number="7"><span class="co">#&gt; $ algebra    &lt;dbl&gt; 67, 80, 71, 63, 65, 72, 65, 68, 58, 60, 60, 59, 64, 5…</span></a>
<a class="sourceLine" id="cb214-8" data-line-number="8"><span class="co">#&gt; $ analysis   &lt;dbl&gt; 67, 70, 66, 70, 70, 64, 65, 62, 62, 62, 63, 62, 55, 5…</span></a>
<a class="sourceLine" id="cb214-9" data-line-number="9"><span class="co">#&gt; $ statistics &lt;dbl&gt; 81, 81, 81, 68, 63, 73, 68, 56, 70, 45, 54, 44, 63, 3…</span></a></code></pre></div>
<p>Entonces un análisis de componentes principales proseguiría como sigue:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1">pc_marks &lt;-<span class="st"> </span><span class="kw">princomp</span>(marks)</a>
<a class="sourceLine" id="cb215-2" data-line-number="2"><span class="kw">summary</span>(pc_marks)</a>
<a class="sourceLine" id="cb215-3" data-line-number="3"><span class="co">#&gt; Importance of components:</span></a>
<a class="sourceLine" id="cb215-4" data-line-number="4"><span class="co">#&gt;                            Comp.1     Comp.2      Comp.3     Comp.4</span></a>
<a class="sourceLine" id="cb215-5" data-line-number="5"><span class="co">#&gt; Standard deviation     26.0600955 14.1291852 10.13060363 9.15149631</span></a>
<a class="sourceLine" id="cb215-6" data-line-number="6"><span class="co">#&gt; Proportion of Variance  0.6191097  0.1819910  0.09355915 0.07634838</span></a>
<a class="sourceLine" id="cb215-7" data-line-number="7"><span class="co">#&gt; Cumulative Proportion   0.6191097  0.8011007  0.89465983 0.97100821</span></a>
<a class="sourceLine" id="cb215-8" data-line-number="8"><span class="co">#&gt;                            Comp.5</span></a>
<a class="sourceLine" id="cb215-9" data-line-number="9"><span class="co">#&gt; Standard deviation     5.63935825</span></a>
<a class="sourceLine" id="cb215-10" data-line-number="10"><span class="co">#&gt; Proportion of Variance 0.02899179</span></a>
<a class="sourceLine" id="cb215-11" data-line-number="11"><span class="co">#&gt; Cumulative Proportion  1.00000000</span></a>
<a class="sourceLine" id="cb215-12" data-line-number="12"><span class="kw">loadings</span>(pc_marks)</a>
<a class="sourceLine" id="cb215-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-14" data-line-number="14"><span class="co">#&gt; Loadings:</span></a>
<a class="sourceLine" id="cb215-15" data-line-number="15"><span class="co">#&gt;            Comp.1 Comp.2 Comp.3 Comp.4 Comp.5</span></a>
<a class="sourceLine" id="cb215-16" data-line-number="16"><span class="co">#&gt; mechanics   0.505  0.749  0.301  0.295       </span></a>
<a class="sourceLine" id="cb215-17" data-line-number="17"><span class="co">#&gt; vectors     0.368  0.207 -0.419 -0.781  0.190</span></a>
<a class="sourceLine" id="cb215-18" data-line-number="18"><span class="co">#&gt; algebra     0.346        -0.146        -0.924</span></a>
<a class="sourceLine" id="cb215-19" data-line-number="19"><span class="co">#&gt; analysis    0.451 -0.301 -0.594  0.521  0.286</span></a>
<a class="sourceLine" id="cb215-20" data-line-number="20"><span class="co">#&gt; statistics  0.535 -0.547  0.600 -0.178  0.151</span></a>
<a class="sourceLine" id="cb215-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-22" data-line-number="22"><span class="co">#&gt;                Comp.1 Comp.2 Comp.3 Comp.4 Comp.5</span></a>
<a class="sourceLine" id="cb215-23" data-line-number="23"><span class="co">#&gt; SS loadings       1.0    1.0    1.0    1.0    1.0</span></a>
<a class="sourceLine" id="cb215-24" data-line-number="24"><span class="co">#&gt; Proportion Var    0.2    0.2    0.2    0.2    0.2</span></a>
<a class="sourceLine" id="cb215-25" data-line-number="25"><span class="co">#&gt; Cumulative Var    0.2    0.4    0.6    0.8    1.0</span></a>
<a class="sourceLine" id="cb215-26" data-line-number="26"><span class="kw">plot</span>(pc_marks, <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/pc-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">biplot</span>(pc_marks)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Los cálculos de un análisis de componentes principales involucran la matriz de
covarianzas empírica <span class="math inline">\(G\)</span> (estimaciones <em>plug-in</em>)</p>
<p><span class="math display">\[G_{jk} = \frac{1}{88}\sum_{i=1}^88(x_{ij}-\bar{x_j})(x_{ik}-\bar{x_k})\]</span></p>
<p>para <span class="math inline">\(j,k=1,2,3,4,5\)</span>, y donde <span class="math inline">\(\bar{x_j} = \sum_{i=1}^88 x_{ij} / 88\)</span> (la media
de la i-ésima columna).</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">G &lt;-<span class="st"> </span><span class="kw">cov</span>(marks) <span class="op">*</span><span class="st"> </span><span class="dv">87</span> <span class="op">/</span><span class="st"> </span><span class="dv">88</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2">G</a>
<a class="sourceLine" id="cb217-3" data-line-number="3"><span class="co">#&gt;            mechanics   vectors   algebra  analysis statistics</span></a>
<a class="sourceLine" id="cb217-4" data-line-number="4"><span class="co">#&gt; mechanics   302.2147 125.59969 100.31599 105.11415  116.15819</span></a>
<a class="sourceLine" id="cb217-5" data-line-number="5"><span class="co">#&gt; vectors     125.5997 170.87810  84.18957  93.59711   97.88688</span></a>
<a class="sourceLine" id="cb217-6" data-line-number="6"><span class="co">#&gt; algebra     100.3160  84.18957 111.60318 110.83936  120.48567</span></a>
<a class="sourceLine" id="cb217-7" data-line-number="7"><span class="co">#&gt; analysis    105.1142  93.59711 110.83936 217.87603  153.76808</span></a>
<a class="sourceLine" id="cb217-8" data-line-number="8"><span class="co">#&gt; statistics  116.1582  97.88688 120.48567 153.76808  294.37177</span></a></code></pre></div>
<p>Los <em>pesos</em> y las <em>componentes principales</em> no son mas que los eigenvalores y
eigenvectores de la matriz de covarianzas <span class="math inline">\(G\)</span>, estos se calculan a través de una
serie de de manipulaciones algebraicas que requieren cálculos del orden de p^3
(cuando G es una matriz de tamaño p<span class="math inline">\(\times\)</span>p).</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1">eigen_G &lt;-<span class="st"> </span><span class="kw">eigen</span>(G)</a>
<a class="sourceLine" id="cb218-2" data-line-number="2">lambda &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>values</a>
<a class="sourceLine" id="cb218-3" data-line-number="3">v &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb218-4" data-line-number="4">lambda</a>
<a class="sourceLine" id="cb218-5" data-line-number="5"><span class="co">#&gt; [1] 679.12858 199.63388 102.62913  83.74988  31.80236</span></a>
<a class="sourceLine" id="cb218-6" data-line-number="6">v</a>
<a class="sourceLine" id="cb218-7" data-line-number="7"><span class="co">#&gt;           [,1]        [,2]       [,3]         [,4]        [,5]</span></a>
<a class="sourceLine" id="cb218-8" data-line-number="8"><span class="co">#&gt; [1,] 0.5053373  0.74917585  0.3006046  0.294631757 -0.07873256</span></a>
<a class="sourceLine" id="cb218-9" data-line-number="9"><span class="co">#&gt; [2,] 0.3682215  0.20692361 -0.4185473 -0.781332853 -0.18955902</span></a>
<a class="sourceLine" id="cb218-10" data-line-number="10"><span class="co">#&gt; [3,] 0.3456083 -0.07622065 -0.1457830 -0.003348995  0.92384059</span></a>
<a class="sourceLine" id="cb218-11" data-line-number="11"><span class="co">#&gt; [4,] 0.4512152 -0.30063472 -0.5944322  0.520724416 -0.28551729</span></a>
<a class="sourceLine" id="cb218-12" data-line-number="12"><span class="co">#&gt; [5,] 0.5347961 -0.54747360  0.5998773 -0.177611847 -0.15121842</span></a></code></pre></div>
<ol style="list-style-type: decimal">
<li>Proponemos el siguiente modelo simple para puntajes correlacionados:</li>
</ol>
<p><span class="math display">\[\textbf{x}_i = Q_i \textbf{v}\]</span></p>
<p>donde <span class="math inline">\(\textbf{x}_i\)</span> es la tupla de calificaciones del i-ésimo estudiante,
<span class="math inline">\(Q_i\)</span> es un número que representa la habilidad del estudiante y <span class="math inline">\(\textbf{v}\)</span> es
un vector fijo con 5 números que aplica a todos los estudiantes. Si este modelo
simple fuera cierto, entonces únicamente el <span class="math inline">\(\hat{\lambda}_1\)</span> sería positivo
y <span class="math inline">\(\textbf{v} = \hat{v}_1\)</span>.
Sea <span class="math display">\[\hat{\theta}=\sum_{i=1}^5\hat{\lambda}_i\]</span>
el modelo propuesto es equivalente a <span class="math inline">\(\hat{\theta}=1\)</span>, inculso si el modelo es
correcto, no esperamos que <span class="math inline">\(\hat{\theta}\)</span> sea exactamente uno pues hay ruido en
los datos.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">theta_hat &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb219-2" data-line-number="2">theta_hat</a>
<a class="sourceLine" id="cb219-3" data-line-number="3"><span class="co">#&gt; [1] 0.6191097</span></a></code></pre></div>
<p>El valor de <span class="math inline">\(\hat{\theta}\)</span> mide el porcentaje de la varianza explicada en la
primer componente principal, ¿qué tan preciso es <span class="math inline">\(\hat{\theta}\)</span>? La complejidad
matemática en el cálculo de <span class="math inline">\(\hat{\theta}\)</span> es irrelevante siempre y cuando
podamos calcular <span class="math inline">\(\hat{\theta}^*\)</span> para una muestra bootstrap, en esta caso una
muestra bootsrtap es una base de datos de 88$$5 <span class="math inline">\(\textbf{X}^*\)</span>, donde las
filas <span class="math inline">\(\textbf{x_i}^*\)</span> de <span class="math inline">\(\textbf{X}^*\)</span> son una muestra aleatoria de tamaño
88 de la verdadera matriz de datos.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1">pc_boot &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb220-2" data-line-number="2">    muestra_boot &lt;-<span class="st"> </span><span class="kw">sample_n</span>(marks, <span class="dt">size =</span> <span class="dv">88</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb220-3" data-line-number="3">    G &lt;-<span class="st"> </span><span class="kw">cov</span>(muestra_boot) <span class="op">*</span><span class="st"> </span><span class="dv">87</span> <span class="op">/</span><span class="st"> </span><span class="dv">88</span> </a>
<a class="sourceLine" id="cb220-4" data-line-number="4">    eigen_G &lt;-<span class="st"> </span><span class="kw">eigen</span>(G)</a>
<a class="sourceLine" id="cb220-5" data-line-number="5">    theta_hat &lt;-<span class="st"> </span>eigen_G<span class="op">$</span>values[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigen_G<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb220-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb220-7" data-line-number="7">B &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb220-8" data-line-number="8">thetas_boot &lt;-<span class="st"> </span><span class="kw">rerun</span>(B, <span class="kw">pc_boot</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a></code></pre></div>
<p>Veamos un histograma de las replicaciones de <span class="math inline">\(\hat{\theta}\)</span>:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(<span class="dt">theta =</span> thetas_boot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb221-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="fl">0.02</span>, </a>
<a class="sourceLine" id="cb221-3" data-line-number="3">        <span class="dt">fill =</span> <span class="st">&quot;gray40&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb221-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(theta)), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb221-5" data-line-number="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">hat</span>(theta)<span class="op">^</span><span class="st">&quot;*&quot;</span>), <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="05-bootstrap_no_parametrico_files/figure-html/pc_hist-1.png" width="300px" style="display: block; margin: auto;" /></p>
<p>Estas tienen un error estándar</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1">theta_se &lt;-<span class="st"> </span><span class="kw">sd</span>(thetas_boot)</a>
<a class="sourceLine" id="cb222-2" data-line-number="2">theta_se</a>
<a class="sourceLine" id="cb222-3" data-line-number="3"><span class="co">#&gt; [1] 0.04689286</span></a></code></pre></div>
<p>y media</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1"><span class="kw">mean</span>(thetas_boot)</a>
<a class="sourceLine" id="cb223-2" data-line-number="2"><span class="co">#&gt; [1] 0.6193033</span></a></code></pre></div>
<p>la media de las replicaciones es muy similar a la estimación <span class="math inline">\(\hat{\theta}\)</span>,
esto indica que <span class="math inline">\(\hat{\theta}\)</span> es cercano a insesgado.</p>
<ol start="2" style="list-style-type: decimal">
<li>El eigenvetor <span class="math inline">\(\hat{v}_1\)</span> correspondiente al mayor eigenvalor se conoce
como primera componente de <span class="math inline">\(G\)</span>, supongamos que deseamos resumir la calificación
de los estudiantes mediante un único número, entonces la mejor combinación
lineal de los puntajes es</li>
</ol>
<p><span class="math display">\[y_i = \sum_{k = 1}^5 \hat{v}_{1k}x_{ik}\]</span></p>
<p>esto es, la combinación lineal que utiliza las componentes de <span class="math inline">\(\hat{v}_1\)</span> como
ponderadores. Si queremos un resumen compuesto por dos números <span class="math inline">\((y_i,z_i)\)</span>, la
segunda combinación lineal debería ser:</p>
<p><span class="math display">\[z_i = \sum_{k = 1}^5 \hat{v}_{2k}x_{ik}\]</span></p>
<p><img src="img/manicule2.jpg" /> Las componentes principales <span class="math inline">\(\hat{v}_1\)</span> y
<span class="math inline">\(\hat{v}_2\)</span> son estadísticos, usa bootstrap para dar una medición de su
variabilidad calculando el error estándar de cada una.</p>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-efron">
<p>Efron, Bradley, and Robert J. Tibshirani. 1993. <em>An Introduction to the Bootstrap</em>. Monographs on Statistics and Applied Probability 57. Boca Raton, Florida, USA: Chapman &amp; Hall/CRC.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="el-estimador-bootstrap-del-error-estandar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mas-alla-de-muestras-aleatorias-simples.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/05-bootstrap_no_parametrico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
