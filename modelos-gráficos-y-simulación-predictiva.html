<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.2 Modelos gráficos y simulación predictiva | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="8.2 Modelos gráficos y simulación predictiva | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.2 Modelos gráficos y simulación predictiva | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distribuciones-multivariadas.html"/>
<link rel="next" href="inferencia-visual.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#ejemplo-estimación-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html"><i class="fa fa-check"></i><b>10.11</b> Inicialesy Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html#iniciales-en-stan"><i class="fa fa-check"></i>Iniciales en Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="reparametrización.html"><a href="reparametrización.html"><i class="fa fa-check"></i><b>10.12</b> Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#ejemplo-el-embudo-de-neal"><i class="fa fa-check"></i>Ejemplo: El embudo de Neal</a></li>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#modelos-jerárquicos-y-parametrización-no-centrada"><i class="fa fa-check"></i>Modelos jerárquicos y parametrización no centrada</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="recursos-de-stan-y-paquetes-con-r.html"><a href="recursos-de-stan-y-paquetes-con-r.html"><i class="fa fa-check"></i><b>10.13</b> Recursos de Stan y paquetes con R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i>Final</a><ul>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#inferencia-gráfica"><i class="fa fa-check"></i>1. Inferencia gráfica</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#simulación-para-el-cálculo-de-tamaños-de-muestra"><i class="fa fa-check"></i>2. Simulación para el cálculo de tamaños de muestra</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#mcmc-1"><i class="fa fa-check"></i>3. MCMC</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#modelos-jerárquicos-y-stan"><i class="fa fa-check"></i>4. Modelos jerárquicos y Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-gráficos-y-simulación-predictiva" class="section level2">
<h2><span class="header-section-number">8.2</span> Modelos gráficos y simulación predictiva</h2>
<p>El objetivo de esta sección es la simulación de modelos, una manera conveniente
de simular de un modelo probabilístico es a partir del modelo gráfico
asociado. Un modelo gráfico representa todas las cantidades involucradas en el
modelo mediante nodos de una gráfica dirigida, el modelo representa el supuesto
que dados los nodos padres <span class="math inline">\(padres(v)\)</span> cada nodo es independiente del resto de
los nodos a excepción de sus descendientes.</p>
<p>Los nodos en las gráficas se clasifican en 3 tipos:</p>
<ul>
<li><p><strong>Constantes</strong> fijas por el diseño del estudio, siempre son nodos sin padres.</p></li>
<li><p><strong>Estocásticos</strong> son variables a los que se les asigna una distribución.</p></li>
<li><p><strong>Determinísticos</strong> son funciones lógicas de otros nodos.</p></li>
</ul>
<p>Los supuestos de independencia condicional que representa la gráfica implican
que la distribución conjunta de todas las cantidades V tiene una factorización
en términos de la distribución condicional <span class="math inline">\(p(v|padres(v))\)</span> de tal manera que:
<span class="math display">\[p(V) = \prod p(v|padres(v))\]</span></p>
<p>Veamos como usar las gráficas para simular de modelos probabilísticos. Los
siguientes ejemplos están escritos con base en <span class="citation">Gelman and Hill (<a href="#ref-gelman-hill">2007</a>)</span>.</p>
<div id="ejemplo-de-simulación-discreta-predictiva" class="section level4 unnumbered">
<h4>Ejemplo de simulación discreta predictiva</h4>
<p>La probabilidad de que un bebé sea niña o niño es <span class="math inline">\(48.8\%\)</span> y <span class="math inline">\(51.2\%\)</span>
respectivamente. Supongamos que hay 400 nacimientos en un hospital en un año
dado. ¿Cuántas niñas nacerán?</p>
<p>Comencemos viendo el modelo gráfico asociado.</p>
<p><img src="img/ninas_1.png" /></p>
<p>La gráfica superior muestra todas las variables relevantes en el problema, y las
dependencias entre ellas. En este caso <span class="math inline">\(n\)</span> es una constante que representa el
número de nacimientos, (<span class="math inline">\(n=400\)</span>), <span class="math inline">\(p=48.8\)</span> es la probabilidad de que un nacimiento
resulte en niña y <span class="math inline">\(k \sim Binomial(p, n)\)</span>. Debido a que el número de éxitos
(nacimientos que resultan en niña) depende de la tasa <span class="math inline">\(p\)</span> y el número de
experimentos <span class="math inline">\(n\)</span>, los nodos que representan a éstas dos últimas variables están
dirigidos al nodo que representa <span class="math inline">\(k\)</span>.</p>
<p>Una vez que tenemos la gráfica es fácil simular del modelo:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb259-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb259-3" data-line-number="3"><span class="kw">library</span>(arm)</a>
<a class="sourceLine" id="cb259-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb259-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">918739837</span>)</a>
<a class="sourceLine" id="cb259-6" data-line-number="6">n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">400</span>, <span class="fl">0.488</span>)</a></code></pre></div>
<p>esto nos muestra algo que podría ocurrir en <span class="math inline">\(400\)</span> nacimientos. Ahora, para tener
una noción de la distribución simulamos el proceso <span class="math inline">\(1000\)</span> veces:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1">sims_ninas &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">400</span>, <span class="fl">0.488</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb260-2" data-line-number="2"><span class="kw">mean</span>(sims_ninas)</a>
<a class="sourceLine" id="cb260-3" data-line-number="3"><span class="co">#&gt; [1] 195.773</span></a>
<a class="sourceLine" id="cb260-4" data-line-number="4"><span class="kw">sd</span>(sims_ninas)</a>
<a class="sourceLine" id="cb260-5" data-line-number="5"><span class="co">#&gt; [1] 10.11582</span></a>
<a class="sourceLine" id="cb260-6" data-line-number="6"></a>
<a class="sourceLine" id="cb260-7" data-line-number="7"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_ninas), <span class="dt">binwidth =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-4-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>El histograma de arriba representa la distribución de probabilidad para el
número de niñas y refleja la incertidumbre en los nacimientos.</p>
<p>Podemos agregar complejidad al modelo, por ejemplo con probabilidad <span class="math inline">\(1/125\)</span> un
nacimiento resulta en gemelos fraternales, y para cada uno de los bebés hay una
posibilidad de aproximadamente <span class="math inline">\(49.5\%\)</span> de ser niña. Además la probabilidad de
gemelos idénticos es de <span class="math inline">\(1/300\)</span> y estos a su vez resultan en niñas en
aproximadamente <span class="math inline">\(40.5\%\)</span> de los casos.</p>
<p><img src="img/ninas_2.png" /></p>
<p>Podemos simular 400 nacimientos bajo este
modelo como sigue:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" data-line-number="1">tipo_nacimiento &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;unico&quot;</span>, <span class="st">&quot;fraternal&quot;</span>, <span class="st">&quot;identicos&quot;</span>), </a>
<a class="sourceLine" id="cb261-2" data-line-number="2">  <span class="dt">size =</span> <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>))</a>
<a class="sourceLine" id="cb261-3" data-line-number="3">n_unico &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;unico&quot;</span>)  <span class="co"># número de nacimientos únicos</span></a>
<a class="sourceLine" id="cb261-4" data-line-number="4">n_fraternal &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;fraternal&quot;</span>)</a>
<a class="sourceLine" id="cb261-5" data-line-number="5">n_identicos &lt;-<span class="st"> </span><span class="dv">400</span> <span class="op">-</span><span class="st"> </span>n_unico <span class="op">-</span><span class="st"> </span>n_fraternal</a>
<a class="sourceLine" id="cb261-6" data-line-number="6">n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_unico, <span class="fl">0.488</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb261-7" data-line-number="7"><span class="st">           </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n_fraternal, <span class="fl">0.495</span>) <span class="op">+</span><span class="st"> </span><span class="co"># en cada nacimiento hay 2 bebés</span></a>
<a class="sourceLine" id="cb261-8" data-line-number="8"><span class="st">           </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_identicos, <span class="fl">0.405</span>)</a>
<a class="sourceLine" id="cb261-9" data-line-number="9">n_ninas</a>
<a class="sourceLine" id="cb261-10" data-line-number="10"><span class="co">#&gt; [1] 183</span></a></code></pre></div>
<p>Repetimos la simulación 1000 veces para aproximar la distribución de número de
niñas en 400 nacimientos.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1">modelo2 &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb262-2" data-line-number="2">    tipo_nacimiento &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;unico&quot;</span>, <span class="st">&quot;fraternal&quot;</span>, <span class="st">&quot;identicos&quot;</span>), </a>
<a class="sourceLine" id="cb262-3" data-line-number="3">        <span class="dt">size =</span> <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">125</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">300</span>))</a>
<a class="sourceLine" id="cb262-4" data-line-number="4">    <span class="co"># número de nacimientos de cada tipo</span></a>
<a class="sourceLine" id="cb262-5" data-line-number="5">    n_unico &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;unico&quot;</span>)  <span class="co"># número de nacimientos únicos</span></a>
<a class="sourceLine" id="cb262-6" data-line-number="6">    n_fraternal &lt;-<span class="st"> </span><span class="kw">sum</span>(tipo_nacimiento <span class="op">==</span><span class="st"> &quot;fraternal&quot;</span>)</a>
<a class="sourceLine" id="cb262-7" data-line-number="7">    n_identicos &lt;-<span class="st"> </span><span class="dv">400</span> <span class="op">-</span><span class="st"> </span>n_unico <span class="op">-</span><span class="st"> </span>n_fraternal</a>
<a class="sourceLine" id="cb262-8" data-line-number="8">    <span class="co"># simulamos para cada tipo de nacimiento</span></a>
<a class="sourceLine" id="cb262-9" data-line-number="9">    n_ninas &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_unico, <span class="fl">0.488</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb262-10" data-line-number="10"><span class="st">        </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n_fraternal, <span class="fl">0.495</span>) <span class="op">+</span><span class="st"> </span><span class="co"># en cada nacimiento hay 2 bebés</span></a>
<a class="sourceLine" id="cb262-11" data-line-number="11"><span class="st">    </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n_identicos, <span class="fl">0.405</span>)</a>
<a class="sourceLine" id="cb262-12" data-line-number="12">  n_ninas</a>
<a class="sourceLine" id="cb262-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb262-14" data-line-number="14"></a>
<a class="sourceLine" id="cb262-15" data-line-number="15">sims_ninas_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">modelo2</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb262-16" data-line-number="16"><span class="kw">mean</span>(sims_ninas_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb262-17" data-line-number="17"><span class="co">#&gt; [1] 197.511</span></a>
<a class="sourceLine" id="cb262-18" data-line-number="18"><span class="kw">sd</span>(sims_ninas_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb262-19" data-line-number="19"><span class="co">#&gt; [1] 10.2152</span></a>
<a class="sourceLine" id="cb262-20" data-line-number="20"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_ninas_<span class="dv">2</span>), <span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-7-1.png" width="350px" style="display: block; margin: auto;" /></p>
</div>
<div id="ejemplo-de-simulación-continua-predictiva" class="section level4">
<h4><span class="header-section-number">8.2.0.1</span> Ejemplo de simulación continua predictiva</h4>
<p>El 52% de los adultos en EUA son mujeres y el 48% hombres, las estaturas de
los hombres se distribuyen aproximadamente normal con media 175 cm y desviación
estándar de 7.37 cm, en el caso de las mujeres la distribución es
aproximadamente normal con media 161.80 cm y desviación estándar de 6.86 cm.
Supongamos que seleccionamos 10 adultos al azar, ¿cuál es el modelo gráfico
asociado? ¿qué podemos decir del promedio de estatura?</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" data-line-number="1">sexo &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.52</span>)</a>
<a class="sourceLine" id="cb263-2" data-line-number="2">altura &lt;-<span class="st"> </span><span class="kw">rnorm</span>(sexo, <span class="dt">mean =</span> <span class="fl">161.8</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">175</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), </a>
<a class="sourceLine" id="cb263-3" data-line-number="3">  <span class="dt">sd =</span> <span class="fl">6.86</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">7.37</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb263-4" data-line-number="4"><span class="kw">mean</span>(altura)</a>
<a class="sourceLine" id="cb263-5" data-line-number="5"><span class="co">#&gt; [1] 172.2232</span></a></code></pre></div>
<p>Simulamos la distribución de la altura promedio:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1">mediaAltura &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb264-2" data-line-number="2">  sexo &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="fl">0.52</span>)</a>
<a class="sourceLine" id="cb264-3" data-line-number="3">  altura &lt;-<span class="st"> </span><span class="kw">rnorm</span>(sexo, <span class="dt">mean =</span> <span class="fl">161.8</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">175</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>), </a>
<a class="sourceLine" id="cb264-4" data-line-number="4">    <span class="dt">sd =</span> <span class="fl">6.86</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">7.37</span> <span class="op">*</span><span class="st"> </span>(sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb264-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb264-6" data-line-number="6">sims_alturas &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">mediaAltura</span>()) </a>
<a class="sourceLine" id="cb264-7" data-line-number="7">media_alturas &lt;-<span class="st"> </span>sims_alturas <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)</a>
<a class="sourceLine" id="cb264-8" data-line-number="8"><span class="kw">mean</span>(media_alturas)</a>
<a class="sourceLine" id="cb264-9" data-line-number="9"><span class="co">#&gt; [1] 168.0653</span></a>
<a class="sourceLine" id="cb264-10" data-line-number="10"><span class="kw">sd</span>(media_alturas)</a>
<a class="sourceLine" id="cb264-11" data-line-number="11"><span class="co">#&gt; [1] 3.045816</span></a>
<a class="sourceLine" id="cb264-12" data-line-number="12"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> media_alturas), <span class="dt">binwidth =</span> <span class="fl">1.2</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-9-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>¿Y que podemos decir de la altura máxima?</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" data-line-number="1">alt_max &lt;-<span class="st"> </span>sims_alturas <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(max)</a>
<a class="sourceLine" id="cb265-2" data-line-number="2"><span class="kw">qplot</span>(alt_max, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-10-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p><img src="img/manicule2.jpg" /> Supongamos que una compañía cambia la tecnología
usada para producir una cámara, un estudio estima que el ahorro en la producción
es de $5 por unidad con un error estándar de $4. Más aún, una proyección
estima que el tamaño del mercado (esto es, el número de cámaras que se venderá)
es de 40,000 con un error estándar de 10,000. Suponiendo que las dos fuentes de
incertidumbre son independientes, usa simulación de variables aleatorias
normales para estimar el total de dinero que ahorrará la compañía, calcula un
intervalo de confianza.</p>
</div>
<div id="ejemplo-de-simulación-de-un-modelo-de-regresión" class="section level4 unnumbered">
<h4>Ejemplo de simulación de un modelo de regresión</h4>
<p>En regresión podemos utilizar simulación para capturar tanto la incertidumbre en
la predicción (término de error en el modelo) como la incertidumbre en la
inferencia (errores estándar de los coeficientes e incertidumbre del error
residual).</p>
<p>Comenzamos con un ejemplo en el que simulamos únicamente <strong>incertidumbre en la
predicción</strong>.</p>
<p>Supongamos que el puntaje de un niño de tres años en una prueba cognitiva esta
relacionado con las características de la madre, el siguiente modelo resume la
diferencia en los puntajes promedio de los niños cuyas madres se graduaron
de preparatoria y los que no.</p>
<p><span class="math display">\[y_i= \beta_0 + \beta_1 X_{i1} + \epsilon_i\]</span></p>
<ul>
<li>donde <span class="math inline">\(y_i\)</span> es el puntaje del <span class="math inline">\(i\)</span>-ésimo niño,</li>
<li><span class="math inline">\(X_{i1}\)</span> es una variable binaria que indica si la madre se graduó de
preparatoria (codificado como <span class="math inline">\(1\)</span>) o no (codificado como <span class="math inline">\(0\)</span>), y</li>
<li><span class="math inline">\(\epsilon_i\)</span> son los error aleatorios, estos son
independientes con distribución normal <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>.</li>
</ul>
<p>Ahora consideremos el problema de simular el puntaje de <span class="math inline">\(50\)</span> niños <span class="math inline">\(30\)</span> con
madres que terminaron la preparatoria y <span class="math inline">\(20\)</span> cuyas madres no terminaron. Los
coeficientes que usaremos son:</p>
<p><span class="math display">\[\beta_0 = 78\]</span>
<span class="math display">\[\beta_1 = 12\]</span>
<span class="math display">\[\sigma = 20\]</span></p>
<p>El modelo gráfico asociado sería como sigue:</p>
<p><img src="img/regresion.png" /></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1">vector_mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">78</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span>, <span class="dv">30</span>), <span class="kw">rep</span>(<span class="dv">78</span>, <span class="dv">20</span>)) <span class="co"># beta_0 + beta_1 X</span></a>
<a class="sourceLine" id="cb266-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb266-3" data-line-number="3">sims_y &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">2000</span>, <span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, <span class="dv">20</span>))</a></code></pre></div>
<p>Podemos calcular la media y su intervalo de confianza:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1">medias &lt;-<span class="st"> </span>sims_y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)</a>
<a class="sourceLine" id="cb267-2" data-line-number="2"><span class="kw">quantile</span>(medias, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb267-3" data-line-number="3"><span class="co">#&gt;     2.5%    97.5% </span></a>
<a class="sourceLine" id="cb267-4" data-line-number="4"><span class="co">#&gt; 79.66242 90.82172</span></a>
<a class="sourceLine" id="cb267-5" data-line-number="5"></a>
<a class="sourceLine" id="cb267-6" data-line-number="6"><span class="kw">qplot</span>(medias, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-13-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>Supongamos ahora que nos interesa incorporar <strong>incertidumbre en los
coeficientes de regresión</strong>, y expresamos nuestra incertidumbre a través de
distribuciones de probabilidad, ¿cómo sería el modelo gráfico asociado?</p>
<p>Primero, suponemos que <span class="math inline">\(\sigma^2\)</span> tiene una distribución centrada en <span class="math inline">\(20^2\)</span>,
proporcional a una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(432\)</span> grados de libertad.</p>
<p><span class="math display">\[
\begin{eqnarray*}
\begin{pmatrix}\beta_{0}\\
\beta_{1}
\end{pmatrix} &amp; \sim &amp; N\left[\left(\begin{array}{c}
78\\
12
\end{array}\right), \sigma^2 \left(\begin{array}{cc}
0.01 &amp; -0.01\\
-0.01 &amp; 0.01
\end{array}\right)\right]
\end{eqnarray*}
\]</span></p>
<p>Ahora, simulamos del modelo incorporando tanto la incertidumbre
correpondiente a la predicción como la incertidumbre en los coeficientes de
regresión, para los coeficientes:</p>
<ol style="list-style-type: decimal">
<li><p>Simula <span class="math inline">\(\sigma=20\sqrt{(432)/X}\)</span> donde <span class="math inline">\(X\)</span> es una generación de una
distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(432\)</span> grados de libertad.</p></li>
<li><p>Dado <span class="math inline">\(\sigma\)</span> (obtenido del paso anterior), simula <span class="math inline">\(\beta\)</span> de una distribución
normal multivariada con media <span class="math inline">\((77,12)\)</span> y matriz de covarianzas <span class="math inline">\(\sigma^2 V\)</span>.</p></li>
<li><p>Simula <span class="math inline">\(y\)</span> el vector de observaciones usando los parámetros de <span class="math inline">\(1\)</span> y <span class="math inline">\(2\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" data-line-number="1">simula_parametros &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb268-2" data-line-number="2">    <span class="co"># empezamos simulando sigma</span></a>
<a class="sourceLine" id="cb268-3" data-line-number="3">    sigma &lt;-<span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">432</span>) <span class="op">/</span><span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>, <span class="dv">432</span>))</a>
<a class="sourceLine" id="cb268-4" data-line-number="4">    <span class="co"># la usamos para simular betas</span></a>
<a class="sourceLine" id="cb268-5" data-line-number="5">    beta &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">78</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb268-6" data-line-number="6">        <span class="dt">Sigma =</span> sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.011</span>, <span class="fl">-0.011</span>, <span class="fl">-0.011</span>, <span class="fl">0.013</span>), <span class="dt">nrow =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb268-7" data-line-number="7">    <span class="co"># Simulamos parámetros</span></a>
<a class="sourceLine" id="cb268-8" data-line-number="8">    <span class="kw">list</span>(<span class="dt">sigma =</span> sigma, <span class="dt">beta =</span> beta)</a>
<a class="sourceLine" id="cb268-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb268-10" data-line-number="10"></a>
<a class="sourceLine" id="cb268-11" data-line-number="11">sims_parametros &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">simula_parametros</span>()) </a>
<a class="sourceLine" id="cb268-12" data-line-number="12"></a>
<a class="sourceLine" id="cb268-13" data-line-number="13"><span class="co"># simulamos los puntajes</span></a>
<a class="sourceLine" id="cb268-14" data-line-number="14">simula_puntajes &lt;-<span class="st"> </span><span class="cf">function</span>(beta, sigma, <span class="dt">n_hs =</span> <span class="dv">30</span>, <span class="dt">n_nhs =</span> <span class="dv">20</span>){</a>
<a class="sourceLine" id="cb268-15" data-line-number="15">    vector_mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(beta[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>beta[<span class="dv">2</span>], n_hs), <span class="kw">rep</span>(beta[<span class="dv">1</span>], n_nhs)) <span class="co"># beta_0 + beta_1 X</span></a>
<a class="sourceLine" id="cb268-16" data-line-number="16">    obs =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, vector_mu, sigma)</a>
<a class="sourceLine" id="cb268-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb268-18" data-line-number="18"></a>
<a class="sourceLine" id="cb268-19" data-line-number="19">sims_puntajes &lt;-<span class="st"> </span><span class="kw">map</span>(sims_parametros, <span class="op">~</span><span class="kw">simula_puntajes</span>(<span class="dt">beta =</span> .[[<span class="st">&quot;beta&quot;</span>]], </a>
<a class="sourceLine" id="cb268-20" data-line-number="20">  <span class="dt">sigma =</span> .[[<span class="st">&quot;sigma&quot;</span>]]))</a>
<a class="sourceLine" id="cb268-21" data-line-number="21">medias_incert &lt;-<span class="st"> </span>sims_puntajes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(mean)</a>
<a class="sourceLine" id="cb268-22" data-line-number="22"></a>
<a class="sourceLine" id="cb268-23" data-line-number="23"><span class="kw">quantile</span>(medias_incert, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb268-24" data-line-number="24"><span class="co">#&gt;     2.5%    97.5% </span></a>
<a class="sourceLine" id="cb268-25" data-line-number="25"><span class="co">#&gt; 79.22699 90.89105</span></a>
<a class="sourceLine" id="cb268-26" data-line-number="26"><span class="kw">qplot</span>(medias_incert, <span class="dt">geom =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-14-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p><img src="img/manicule2.jpg" /> Si nos interesara la mediana de los puntajes, ¿qué
cambio tendríamos que hacer en el código?</p>
<p>Los parametros se obtuvieron de ajustar el modelo de regresión lineal a un
conjunto de 434 observaciones de puntajes de niños.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" data-line-number="1"><span class="kw">library</span>(usethis)</a>
<a class="sourceLine" id="cb269-2" data-line-number="2"><span class="kw">use_directory</span>(<span class="st">&quot;data&quot;</span>) <span class="co"># crea carpeta en caso de que no exista ya</span></a>
<a class="sourceLine" id="cb269-3" data-line-number="3">usethis<span class="op">::</span><span class="kw">use_zip</span>(<span class="st">&quot;https://github.com/tereom/estcomp/raw/master/data-raw/data_sim.zip&quot;</span>, </a>
<a class="sourceLine" id="cb269-4" data-line-number="4">    <span class="st">&quot;data&quot;</span>) <span class="co"># descargar y descomprimir zip</span></a></code></pre></div>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" data-line-number="1"><span class="kw">library</span>(foreign)</a>
<a class="sourceLine" id="cb270-2" data-line-number="2">kids_iq &lt;-<span class="st"> </span><span class="kw">read.dta</span>(<span class="st">&quot;data/data_sim/kidiq.dta&quot;</span>)</a>
<a class="sourceLine" id="cb270-3" data-line-number="3">lm_kid &lt;-<span class="st"> </span><span class="kw">lm</span>(kid_score <span class="op">~</span><span class="st"> </span>mom_hs, kids_iq)</a>
<a class="sourceLine" id="cb270-4" data-line-number="4"><span class="kw">summary</span>(lm_kid)</a>
<a class="sourceLine" id="cb270-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb270-6" data-line-number="6"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb270-7" data-line-number="7"><span class="co">#&gt; lm(formula = kid_score ~ mom_hs, data = kids_iq)</span></a>
<a class="sourceLine" id="cb270-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb270-9" data-line-number="9"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb270-10" data-line-number="10"><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></a>
<a class="sourceLine" id="cb270-11" data-line-number="11"><span class="co">#&gt; -57.55 -13.32   2.68  14.68  58.45 </span></a>
<a class="sourceLine" id="cb270-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb270-13" data-line-number="13"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb270-14" data-line-number="14"><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb270-15" data-line-number="15"><span class="co">#&gt; (Intercept)   77.548      2.059  37.670  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb270-16" data-line-number="16"><span class="co">#&gt; mom_hs        11.771      2.322   5.069 5.96e-07 ***</span></a>
<a class="sourceLine" id="cb270-17" data-line-number="17"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb270-18" data-line-number="18"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb270-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb270-20" data-line-number="20"><span class="co">#&gt; Residual standard error: 19.85 on 432 degrees of freedom</span></a>
<a class="sourceLine" id="cb270-21" data-line-number="21"><span class="co">#&gt; Multiple R-squared:  0.05613,    Adjusted R-squared:  0.05394 </span></a>
<a class="sourceLine" id="cb270-22" data-line-number="22"><span class="co">#&gt; F-statistic: 25.69 on 1 and 432 DF,  p-value: 5.957e-07</span></a>
<a class="sourceLine" id="cb270-23" data-line-number="23"><span class="kw">summary</span>(lm_kid)<span class="op">$</span>cov.unscaled</a>
<a class="sourceLine" id="cb270-24" data-line-number="24"><span class="co">#&gt;             (Intercept)      mom_hs</span></a>
<a class="sourceLine" id="cb270-25" data-line-number="25"><span class="co">#&gt; (Intercept)  0.01075269 -0.01075269</span></a>
<a class="sourceLine" id="cb270-26" data-line-number="26"><span class="co">#&gt; mom_hs      -0.01075269  0.01368524</span></a>
<a class="sourceLine" id="cb270-27" data-line-number="27"><span class="kw">summary</span>(lm_kid)<span class="op">$</span>sigma</a>
<a class="sourceLine" id="cb270-28" data-line-number="28"><span class="co">#&gt; [1] 19.85253</span></a></code></pre></div>
<p>Podemos usar simulación para calcular intervalos de confianza para
<span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>,</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1">sims_parametros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(<span class="op">~</span>(.<span class="op">$</span>beta[<span class="dv">1</span>])) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sd</span>()</a>
<a class="sourceLine" id="cb271-2" data-line-number="2"><span class="co">#&gt; [1] 2.114737</span></a>
<a class="sourceLine" id="cb271-3" data-line-number="3">sims_parametros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(<span class="op">~</span>(.<span class="op">$</span>beta[<span class="dv">2</span>])) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sd</span>()</a>
<a class="sourceLine" id="cb271-4" data-line-number="4"><span class="co">#&gt; [1] 2.303523</span></a></code></pre></div>
<p>No parece que valga la pena el esfuerzo cuando podemos calcular los intervalos
analíticamente, sin embargo con simulación podemos responder fácilmente otras
preguntas, por ejemplo, la pregunta inicial: ¿cuál es la media esperada para un
conjunto de <span class="math inline">\(50\)</span> niños, <span class="math inline">\(30\)</span> con madres que hicieron preparatoria y <span class="math inline">\(20\)</span> que no?
es fácil de responder con simulación.</p>
<p>Podríamos usar <code>predict()</code> para calcular el estimador puntual de la media en el
examen para los niños:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">pred_mi_pob &lt;-<span class="st"> </span><span class="kw">predict</span>(lm_kid, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">mom_hs =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb272-2" data-line-number="2">    <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>))), <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb272-3" data-line-number="3"><span class="kw">mean</span>(pred_mi_pob<span class="op">$</span>fit)</a>
<a class="sourceLine" id="cb272-4" data-line-number="4"><span class="co">#&gt; [1] 84.61114</span></a></code></pre></div>
<p>¿Cómo calculas el error estándar? En este caso se puede resolver pues es una
combinación lineal de los coeficientes del modelo, pero en muchos casos nuestro
objetivo es más complicado que coeficientes o combinaciones lineales de estos.</p>
</div>
<div id="simulación-de-predicciones-no-lineales" class="section level4">
<h4><span class="header-section-number">8.2.0.2</span> Simulación de predicciones no lineales</h4>
<p>Veamos un ejemplo de las elecciones en el congreso de EUA. Tenemos un modelo
que usaremos para predecir la elección de <span class="math inline">\(1990\)</span> basados en la de <span class="math inline">\(1988\)</span>.</p>
<p><strong>Explicación del problema</strong>. EUA está dividido en <span class="math inline">\(435\)</span> distritos congresionales,
definimos la variable de interés <span class="math inline">\(y_i\)</span> con <span class="math inline">\(i=1,...,n\)</span>, como la participación
del partido Demócrata en el distrito <span class="math inline">\(i\)</span> en <span class="math inline">\(1988\)</span>. La participación se calcula
como el porcentaje de los votos correspondientes a los demócratas del total de
votos que recibieron los demócratas y republicanos, esto es, se excluyen los
votos a otros partidos.</p>
<p>El modelo del que simularemos se construyó usando datos de <span class="math inline">\(1986\)</span> y <span class="math inline">\(1988\)</span>.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="co"># Los datos están almacenados en 3 archivos correspondientes al año</span></a>
<a class="sourceLine" id="cb273-2" data-line-number="2">paths &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw">dir_ls</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;data_sim&quot;</span>, <span class="st">&quot;congress&quot;</span>))</a>
<a class="sourceLine" id="cb273-3" data-line-number="3">paths &lt;-<span class="st"> </span><span class="kw">set_names</span>(paths, <span class="kw">basename</span>(paths))</a>
<a class="sourceLine" id="cb273-4" data-line-number="4"></a>
<a class="sourceLine" id="cb273-5" data-line-number="5"><span class="co"># Leemos los datos y recodificamos variables</span></a>
<a class="sourceLine" id="cb273-6" data-line-number="6">congress &lt;-<span class="st"> </span><span class="kw">map_dfr</span>(paths, read.table, <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb273-7" data-line-number="7">  <span class="dt">.id =</span> <span class="st">&quot;year&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb273-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">435</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb273-9" data-line-number="9">         <span class="dt">year =</span> <span class="kw">parse_number</span>(year),          <span class="co"># año de la elección</span></a>
<a class="sourceLine" id="cb273-10" data-line-number="10">         <span class="dt">incumbency =</span> <span class="kw">ifelse</span>(V3 <span class="op">==</span><span class="st"> </span><span class="dv">-9</span>, <span class="ot">NA</span>, V3), <span class="co"># codificar NAs     </span></a>
<a class="sourceLine" id="cb273-11" data-line-number="11">         <span class="dt">dem_share =</span> V4 <span class="op">/</span><span class="st"> </span>(V4 <span class="op">+</span><span class="st"> </span>V5)) <span class="op">%&gt;%</span><span class="st">       </span><span class="co"># participación demócrata</span></a>
<a class="sourceLine" id="cb273-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(id, year, incumbency, dem_share)</a>
<a class="sourceLine" id="cb273-13" data-line-number="13"></a>
<a class="sourceLine" id="cb273-14" data-line-number="14"><span class="kw">glimpse</span>(congress)</a>
<a class="sourceLine" id="cb273-15" data-line-number="15"><span class="co">#&gt; Observations: 1,305</span></a>
<a class="sourceLine" id="cb273-16" data-line-number="16"><span class="co">#&gt; Variables: 4</span></a>
<a class="sourceLine" id="cb273-17" data-line-number="17"><span class="co">#&gt; $ id         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…</span></a>
<a class="sourceLine" id="cb273-18" data-line-number="18"><span class="co">#&gt; $ year       &lt;dbl&gt; 1986, 1986, 1986, 1986, 1986, 1986, 1986, 1986, 1986, 1986…</span></a>
<a class="sourceLine" id="cb273-19" data-line-number="19"><span class="co">#&gt; $ incumbency &lt;int&gt; 1, 1, 1, -1, 1, -1, 0, -1, -1, 1, 1, 1, 1, 1, 1, 0, 1, 1, …</span></a>
<a class="sourceLine" id="cb273-20" data-line-number="20"><span class="co">#&gt; $ dem_share  &lt;dbl&gt; 0.7450362, 0.6738455, 0.6964566, 0.4645901, 0.3910945, 0.3…</span></a>
<a class="sourceLine" id="cb273-21" data-line-number="21"></a>
<a class="sourceLine" id="cb273-22" data-line-number="22"><span class="co"># datos en forma horizontal</span></a>
<a class="sourceLine" id="cb273-23" data-line-number="23">congress_w &lt;-<span class="st"> </span><span class="kw">pivot_wider</span>(congress, <span class="dt">names_from =</span> year, </a>
<a class="sourceLine" id="cb273-24" data-line-number="24">  <span class="dt">values_from =</span> <span class="kw">c</span>(incumbency, dem_share))</a>
<a class="sourceLine" id="cb273-25" data-line-number="25"></a>
<a class="sourceLine" id="cb273-26" data-line-number="26"><span class="co"># quitamos NAs</span></a>
<a class="sourceLine" id="cb273-27" data-line-number="27">congress_w &lt;-<span class="st"> </span>congress_w <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb273-28" data-line-number="28"><span class="st">  </span><span class="kw">drop_na</span>()</a>
<a class="sourceLine" id="cb273-29" data-line-number="29"></a>
<a class="sourceLine" id="cb273-30" data-line-number="30"><span class="kw">ggplot</span>(congress_w, <span class="kw">aes</span>(<span class="dt">x =</span> dem_share_<span class="dv">1986</span>, <span class="dt">y =</span> dem_share_<span class="dv">1988</span>, </a>
<a class="sourceLine" id="cb273-31" data-line-number="31">  <span class="dt">color =</span> <span class="kw">factor</span>(incumbency_<span class="dv">1986</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb273-32" data-line-number="32"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb273-33" data-line-number="33"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb273-34" data-line-number="34"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-19-1.png" width="528" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" data-line-number="1"><span class="co"># quitamos las elecciones que no se compitieron</span></a>
<a class="sourceLine" id="cb274-2" data-line-number="2">congress_<span class="dv">88</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(congress_w, dem_share_<span class="dv">1988</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>dem_share_<span class="dv">1988</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>,   </a>
<a class="sourceLine" id="cb274-3" data-line-number="3">    incumbency_<span class="dv">1988</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb274-4" data-line-number="4"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb274-5" data-line-number="5">      <span class="dt">dem_share_1986 =</span> <span class="kw">case_when</span>(dem_share_<span class="dv">1986</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.25</span>, </a>
<a class="sourceLine" id="cb274-6" data-line-number="6">        dem_share_<span class="dv">1986</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb274-7" data-line-number="7">        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>dem_share_<span class="dv">1986</span>))</a>
<a class="sourceLine" id="cb274-8" data-line-number="8"></a>
<a class="sourceLine" id="cb274-9" data-line-number="9">fit_<span class="dv">88</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(dem_share_<span class="dv">1988</span> <span class="op">~</span><span class="st"> </span>dem_share_<span class="dv">1986</span> <span class="op">+</span><span class="st"> </span>incumbency_<span class="dv">1988</span>, </a>
<a class="sourceLine" id="cb274-10" data-line-number="10">  <span class="dt">data =</span> congress_<span class="dv">88</span>)</a>
<a class="sourceLine" id="cb274-11" data-line-number="11"><span class="kw">summary</span>(fit_<span class="dv">88</span>)</a>
<a class="sourceLine" id="cb274-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-13" data-line-number="13"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb274-14" data-line-number="14"><span class="co">#&gt; lm(formula = dem_share_1988 ~ dem_share_1986 + incumbency_1988, </span></a>
<a class="sourceLine" id="cb274-15" data-line-number="15"><span class="co">#&gt;     data = congress_88)</span></a>
<a class="sourceLine" id="cb274-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-17" data-line-number="17"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb274-18" data-line-number="18"><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></a>
<a class="sourceLine" id="cb274-19" data-line-number="19"><span class="co">#&gt; -0.170533 -0.035497 -0.000485  0.038853  0.215279 </span></a>
<a class="sourceLine" id="cb274-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-21" data-line-number="21"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb274-22" data-line-number="22"><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb274-23" data-line-number="23"><span class="co">#&gt; (Intercept)      0.16729    0.02016   8.298  2.8e-15 ***</span></a>
<a class="sourceLine" id="cb274-24" data-line-number="24"><span class="co">#&gt; dem_share_1986   0.65174    0.03846  16.947  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb274-25" data-line-number="25"><span class="co">#&gt; incumbency_1988  0.06809    0.00754   9.031  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb274-26" data-line-number="26"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb274-27" data-line-number="27"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb274-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb274-29" data-line-number="29"><span class="co">#&gt; Residual standard error: 0.06749 on 328 degrees of freedom</span></a>
<a class="sourceLine" id="cb274-30" data-line-number="30"><span class="co">#&gt; Multiple R-squared:  0.8865, Adjusted R-squared:  0.8858 </span></a>
<a class="sourceLine" id="cb274-31" data-line-number="31"><span class="co">#&gt; F-statistic:  1281 on 2 and 328 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<p>Simulemos del modelo:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" data-line-number="1">congress_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(congress_w, dem_share_<span class="dv">1990</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>dem_share_<span class="dv">1990</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb275-2" data-line-number="2">    incumbency_<span class="dv">1990</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb275-4" data-line-number="4">      <span class="dt">dem_share_1990 =</span> <span class="kw">case_when</span>(dem_share_<span class="dv">1988</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.25</span>, </a>
<a class="sourceLine" id="cb275-5" data-line-number="5">        dem_share_<span class="dv">1988</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb275-6" data-line-number="6">        <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>dem_share_<span class="dv">1988</span>))</a>
<a class="sourceLine" id="cb275-7" data-line-number="7"><span class="co"># Matriz X</span></a>
<a class="sourceLine" id="cb275-8" data-line-number="8">X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, congress_w<span class="op">$</span>dem_share_<span class="dv">1988</span>, congress_w<span class="op">$</span>incumbency_<span class="dv">1990</span>)</a>
<a class="sourceLine" id="cb275-9" data-line-number="9"></a>
<a class="sourceLine" id="cb275-10" data-line-number="10">df &lt;-<span class="st"> </span><span class="kw">df.residual</span>(fit_<span class="dv">88</span>)</a>
<a class="sourceLine" id="cb275-11" data-line-number="11">s &lt;-<span class="st"> </span><span class="kw">summary</span>(fit_<span class="dv">88</span>)<span class="op">$</span>sigma</a>
<a class="sourceLine" id="cb275-12" data-line-number="12">V &lt;-<span class="st"> </span><span class="kw">summary</span>(fit_<span class="dv">88</span>)<span class="op">$</span>cov.unscaled</a>
<a class="sourceLine" id="cb275-13" data-line-number="13">coef_mod &lt;-<span class="st"> </span><span class="kw">summary</span>(fit_<span class="dv">88</span>)<span class="op">$</span>coefficients[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb275-14" data-line-number="14">simula_modelo &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb275-15" data-line-number="15">    sigma &lt;-<span class="st"> </span>s <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(df <span class="op">/</span><span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>, df))</a>
<a class="sourceLine" id="cb275-16" data-line-number="16">    beta &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="dt">mu =</span> coef_mod, <span class="dt">Sigma =</span> sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>V)</a>
<a class="sourceLine" id="cb275-17" data-line-number="17">    mu &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta</a>
<a class="sourceLine" id="cb275-18" data-line-number="18">    <span class="kw">tibble</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mu), <span class="dt">dem_share =</span> <span class="kw">rnorm</span>(<span class="kw">length</span>(mu), mu, sigma))</a>
<a class="sourceLine" id="cb275-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb275-20" data-line-number="20"></a>
<a class="sourceLine" id="cb275-21" data-line-number="21">sims_congress &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">simula_modelo</span>()) </a>
<a class="sourceLine" id="cb275-22" data-line-number="22">sims_congress_df &lt;-<span class="st"> </span>sims_congress <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-23" data-line-number="23"><span class="st">  </span><span class="kw">bind_rows</span>(<span class="dt">.id =</span> <span class="st">&quot;sim&quot;</span>) </a>
<a class="sourceLine" id="cb275-24" data-line-number="24"></a>
<a class="sourceLine" id="cb275-25" data-line-number="25"><span class="kw">ggplot</span>(sims_congress_df, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(id, dem_share), <span class="dt">y =</span> dem_share)) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-26" data-line-number="26"><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb275-27" data-line-number="27"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">yintercept =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-21-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Podemos preguntarnos cuántas elecciones ganaron los demócratas en <span class="math inline">\(1990\)</span>:
<span class="math inline">\(\sum I(\tilde{y} &gt; 0.5)\)</span></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" data-line-number="1">sims_congress_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-2" data-line-number="2"><span class="st">    </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">wins =</span> <span class="kw">sum</span>(dem_share <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-4" data-line-number="4"><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-5" data-line-number="5"><span class="st">    </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb276-6" data-line-number="6">        <span class="dt">mean_wins =</span> <span class="kw">mean</span>(wins),</a>
<a class="sourceLine" id="cb276-7" data-line-number="7">        <span class="dt">median_wins =</span> <span class="kw">median</span>(wins), </a>
<a class="sourceLine" id="cb276-8" data-line-number="8">        <span class="dt">sd_wins =</span> <span class="kw">sd</span>(wins)</a>
<a class="sourceLine" id="cb276-9" data-line-number="9">      )</a>
<a class="sourceLine" id="cb276-10" data-line-number="10"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb276-11" data-line-number="11"><span class="co">#&gt;   mean_wins median_wins sd_wins</span></a>
<a class="sourceLine" id="cb276-12" data-line-number="12"><span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb276-13" data-line-number="13"><span class="co">#&gt; 1      257.         257    2.97</span></a>
<a class="sourceLine" id="cb276-14" data-line-number="14">sims_congress_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-15" data-line-number="15"><span class="st">    </span><span class="kw">group_by</span>(sim) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-16" data-line-number="16"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">wins =</span> <span class="kw">sum</span>(dem_share <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb276-17" data-line-number="17"><span class="st">    </span><span class="kw">pull</span>(wins) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb276-18" data-line-number="18"><span class="st">    </span><span class="kw">qplot</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Veamos lo que ocurrió realmente</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1"><span class="kw">sum</span>(congress_w<span class="op">$</span>dem_share_<span class="dv">1990</span> <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb277-2" data-line-number="2"><span class="co">#&gt; [1] 265</span></a></code></pre></div>
<p>La función <code>sim()</code> del paquete <code>arm</code> permite simular de modelos
lineales y lineales generalizados.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" data-line-number="1">sim_fit_<span class="dv">88</span> &lt;-<span class="st"> </span>arm<span class="op">::</span><span class="kw">sim</span>(fit_<span class="dv">88</span>, <span class="dt">n.sims =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb278-2" data-line-number="2">sim_fit_<span class="dv">88</span><span class="op">@</span>coef[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</a>
<a class="sourceLine" id="cb278-3" data-line-number="3"><span class="co">#&gt;       (Intercept) dem_share_1986 incumbency_1988</span></a>
<a class="sourceLine" id="cb278-4" data-line-number="4"><span class="co">#&gt;  [1,]   0.1790449      0.6435951      0.06845862</span></a>
<a class="sourceLine" id="cb278-5" data-line-number="5"><span class="co">#&gt;  [2,]   0.1591542      0.6682493      0.07115940</span></a>
<a class="sourceLine" id="cb278-6" data-line-number="6"><span class="co">#&gt;  [3,]   0.1215345      0.7285898      0.05552796</span></a>
<a class="sourceLine" id="cb278-7" data-line-number="7"><span class="co">#&gt;  [4,]   0.2003955      0.5966258      0.07670371</span></a>
<a class="sourceLine" id="cb278-8" data-line-number="8"><span class="co">#&gt;  [5,]   0.1670941      0.6609347      0.06537666</span></a>
<a class="sourceLine" id="cb278-9" data-line-number="9"><span class="co">#&gt;  [6,]   0.1669521      0.6451482      0.06956311</span></a>
<a class="sourceLine" id="cb278-10" data-line-number="10"><span class="co">#&gt;  [7,]   0.1328750      0.7088040      0.06084818</span></a>
<a class="sourceLine" id="cb278-11" data-line-number="11"><span class="co">#&gt;  [8,]   0.1570452      0.6686808      0.06762329</span></a>
<a class="sourceLine" id="cb278-12" data-line-number="12"><span class="co">#&gt;  [9,]   0.1735274      0.6488581      0.06723601</span></a>
<a class="sourceLine" id="cb278-13" data-line-number="13"><span class="co">#&gt; [10,]   0.1976371      0.6030459      0.08171117</span></a>
<a class="sourceLine" id="cb278-14" data-line-number="14">sim_fit_<span class="dv">88</span><span class="op">@</span>sigma[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb278-15" data-line-number="15"><span class="co">#&gt;  [1] 0.06857743 0.06694072 0.06671788 0.06556664 0.06812829 0.06757501</span></a>
<a class="sourceLine" id="cb278-16" data-line-number="16"><span class="co">#&gt;  [7] 0.06298298 0.06899185 0.06584510 0.07016688</span></a></code></pre></div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-gelman-hill">
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Vol. Analytical methods for social research. New York: Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distribuciones-multivariadas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferencia-visual.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/07-simulacion_modelos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
