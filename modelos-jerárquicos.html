<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10.10 Modelos jerárquicos | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="10.10 Modelos jerárquicos | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10.10 Modelos jerárquicos | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="diagnósticos-generales.html"/>
<link rel="next" href="tareas.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
<li class="chapter" data-level="10.9.1" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#iniciales-en-stan"><i class="fa fa-check"></i><b>10.9.1</b> Iniciales en Stan</a></li>
<li class="chapter" data-level="10.9.2" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recursos-de-stan-y-paquetes-con-r"><i class="fa fa-check"></i><b>10.9.2</b> Recursos de Stan y paquetes con R:</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-jerárquicos" class="section level2">
<h2><span class="header-section-number">10.10</span> Modelos jerárquicos</h2>
<p>Los modelos jerárquicos involucran varios parámetros de tal manera que las
creencias de unos de los parámetros dependen de manera significativa de los
valores de otros parámetros. Por ejemplo, consideremos el caso en el que tenemos
varias monedas acuñadas en la misma casa de monedas, es razonable pensar que una
fábrica sesgada a águilas tenderá a producir monedas con sesgo hacia águilas.
La estimación del sesgo de una moneda depende de la estimación del sesgo de la
fábrica que a su vez está influido por los datos de todas las monedas. Veremos
que la estructura de dependenica a lo largo de los parámetros generan
estimaciones mejor informadas para todos los parámetros.</p>
<p>Si pensamos únicamente en dos monedas que provienen de la misma casa de moneda
tenemos:</p>
<ol style="list-style-type: decimal">
<li><p>Conocimientos iniciales de los posibles valores de los parámetros (sesgos
de las monedas).</p></li>
<li><p>Tenemos conocimiento inicial de la dependencia de los parámetros por provenir
de la misma fábrica.</p></li>
</ol>
<p>Cuando observamos lanzamientos de las monedas actualizamos nuestras creencias
relativas a los sesgos de las monedas y también actualizamos nuestras
creencias acerca de la dependencia de los sesgos.</p>
<p>Recordemos el caso de lanzamientos de una moneda, le asignamos una inicial beta,
recordemos que la distribución beta tienen dos parámetors <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>:</p>
<p><span class="math display">\[p(\theta)=\frac{1}{B(a,b)}\theta^{a-1}(1-\theta)^{b-1}\]</span></p>
<p>Con el fin de hacer los parámetros más intuitivos los podemos expresar en
términos de la media <span class="math inline">\(\mu\)</span> y el tamaño de muestra <span class="math inline">\(K\)</span>, donde <span class="math inline">\(\mu\)</span> es la media
de nuestro conocimiento inicial y la confianza está reflejada en el tamaño de
muestra <span class="math inline">\(K\)</span>. Entonces los parámetros correspondientes en la distribución
beta son:</p>
<p><span class="math display">\[a=\mu K, b = (1-\mu)K\]</span></p>
<p>Ahora introducimos el modelo jerárquico. En lugar de especificar un valor
particular para <span class="math inline">\(\mu\)</span>, consideramos que <span class="math inline">\(\mu\)</span> puede tomar distintos valores
(entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>), y definimos una distribución de probabilidad sobre esos
valores.
Podemos pensar que esta distribución describe nuestra incertidumbre acerca de la
construcción de la máquina que manufactura las monedas.</p>
<p>Veamos que en el caso de más de una moneda el modelo permite que cada moneda
tenga un sesgo distinto pero ambas
tenderán a tener un sesgo cercano a <span class="math inline">\(\mu\)</span>, algunas aleatoriamente tendrán un
valor de <span class="math inline">\(\theta\)</span> mayor a <span class="math inline">\(\mu\)</span> y otras menor. Entre más grande <span class="math inline">\(K\)</span> mayor será
la consistencia de la acuñadora y los valores <span class="math inline">\(\theta\)</span> serán más cercanos a <span class="math inline">\(\mu\)</span>.
Si observamos varios lanzamientos de una moneda tendremos información tanto de
<span class="math inline">\(\theta\)</span> como de <span class="math inline">\(\mu\)</span>.</p>
<p>Para hacer un análisis bayesiano aún nos hace falta definir la distribución
inicial sobre los parámetros <span class="math inline">\(\mu\)</span>, usemos una distribución Beta:</p>
<p><span class="math display">\[p(\mu)=beta(\mu|A_{\mu}, B_{\mu})\]</span></p>
<p>donde <span class="math inline">\(A_{\mu}\)</span> y <span class="math inline">\(B_{\mu}\)</span> se conocen como hiperparámetros y son constantes. En
este caso, consideramos que <span class="math inline">\(\mu\)</span> se ubica típicamente cerca de
<span class="math inline">\(A_{\mu}/(A_{\mu} + B_{\mu})\)</span> y <span class="math inline">\(K\)</span> se considera constante.</p>
<div id="modelo-jerárquico-una-moneda" class="section level3 unnumbered">
<h3>Modelo jerárquico una moneda</h3>
<p>Recordemos que en el ejemplo de una moneda teníamos que la verosimilitud era
Bernoulli:</p>
<p><span class="math display">\[p(x|theta) = \theta^x(1-\theta)^{1-x}\]</span></p>
<p>Y si utilizamos las iniciales Beta para <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\theta\)</span> como discutimos arriba,
solo nos resta aplicar la regla de Bayes con nuestros dos parámetros
desconocidos <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[p(\theta, \mu|x)=\frac{p(x|\theta,\mu)p(\theta,\mu)}{p(x)}\]</span></p>
<p>Hay dos aspectos a considerar en el problema:</p>
<ol style="list-style-type: decimal">
<li><p>La verosimilitud no depende de <span class="math inline">\(\mu\)</span> por lo que
<span class="math display">\[p(x|\theta, \mu)=p(x|\theta)\]</span></p></li>
<li><p>La distribución inicial en el espacio de parámetros bivariado se puede
factorizar:</p></li>
</ol>
<p><span class="math display">\[p(\theta,\mu)=p(\theta|\mu)p(\mu)\]</span></p>
<p>Por lo tanto
<span class="math display">\[p(\theta,\mu|x)=\frac{p(x|\theta,\mu)p(\theta,\mu)}{p(x)}\]</span>
<span class="math display">\[=\frac{p(x|\theta)p(\theta|\mu)p(\mu)}{p(x)}\]</span>
El siguiente modelo gráfico resume las independencias condicionales
de la última ecuación:</p>
<div id="aproximación-por-cuadrícula-1" class="section level4 unnumbered">
<h4>Aproximación por cuadrícula</h4>
<p>En el caso jerárquico, no se puede derivar la distribución posterior de manera
analítica pero si los parámetros e hiperparámetros toman un número finito de<br />
valores y no hay muchos de ellos, podemos aproximar la posterior usando
aproximación por cuadrícula.</p>
<p>A continuación graficamos las distribuciones correspondientes al caso en que
la distribución del hiperparámetro <span class="math inline">\(\mu\)</span> tiene la forma de una distribución
<span class="math inline">\(Beta(2, 2)\)</span>, es decir creemos que la media de la acuñadora <span class="math inline">\(\mu\)</span> es <span class="math inline">\(0.5\)</span>, pero
existe bastante incertidumbre acerca del valor.</p>
<p>La distribución de <span class="math inline">\(\theta\)</span>, esto es la distribución inicial que refleja la
dependencia entre <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\mu\)</span> se expresa por medio de otra distribución
beta, en el ejemplo usamos <span class="math inline">\(K=100\)</span>:</p>
<p><span class="math display">\[\theta|\mu \sim beta(\mu 100, (1-\mu)100)\]</span></p>
<p>Esta inicial expresa un alto grado de certeza que una acuñadora con
hiperparámetro <span class="math inline">\(\mu\)</span> genera monedas con sesgo cercano a <span class="math inline">\(\mu\)</span></p>
<p><img src="09-analisis_bayesiano_files/figure-html/inicial_jer-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>Verosimilitud.</p>
<p><img src="09-analisis_bayesiano_files/figure-html/verosimilitud_jer-1.png" width="259.2" style="display: block; margin: auto;" /></p>
<p>Posterior.</p>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-67-1.png" width="528" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" data-line-number="1">A_mu &lt;-<span class="st"> </span><span class="dv">2</span>; B_mu &lt;-<span class="st"> </span><span class="dv">2</span>; K &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb387-2" data-line-number="2"><span class="co"># Distribución inicial conjunta p(theta, mu)</span></a>
<a class="sourceLine" id="cb387-3" data-line-number="3">p_conjunta &lt;-<span class="st"> </span><span class="cf">function</span>(mu, theta, A_mu, B_mu, K){</a>
<a class="sourceLine" id="cb387-4" data-line-number="4">  <span class="co"># marginal p(mu)</span></a>
<a class="sourceLine" id="cb387-5" data-line-number="5">  p_mu &lt;-<span class="st"> </span><span class="kw">dbeta</span>(mu, A_mu, B_mu)</a>
<a class="sourceLine" id="cb387-6" data-line-number="6">  <span class="co"># condicional p(theta | mu)</span></a>
<a class="sourceLine" id="cb387-7" data-line-number="7">  p_theta_mu &lt;-<span class="st"> </span><span class="kw">dbeta</span>(theta, mu <span class="op">*</span><span class="st"> </span>K, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu) <span class="op">*</span><span class="st"> </span>K)</a>
<a class="sourceLine" id="cb387-8" data-line-number="8">  p_mu <span class="op">*</span><span class="st"> </span>p_theta_mu</a>
<a class="sourceLine" id="cb387-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb387-10" data-line-number="10"></a>
<a class="sourceLine" id="cb387-11" data-line-number="11">grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.005</span>), </a>
<a class="sourceLine" id="cb387-12" data-line-number="12">  <span class="dt">mu =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.005</span>))</a>
<a class="sourceLine" id="cb387-13" data-line-number="13"></a>
<a class="sourceLine" id="cb387-14" data-line-number="14">grid_inicial &lt;-<span class="st"> </span>grid <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_inicial =</span> <span class="kw">p_conjunta</span>(mu, theta, A_mu, B_mu, K))</a>
<a class="sourceLine" id="cb387-16" data-line-number="16"></a>
<a class="sourceLine" id="cb387-17" data-line-number="17">plot_conj &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_inicial, <span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> mu, <span class="dt">z =</span> p_inicial)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-18" data-line-number="18"><span class="st">  </span><span class="kw">stat_contour</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">color =</span> ..level..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(mu), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="kw">expression</span>(<span class="kw">p</span>(theta,mu)), <span class="dt">guide =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb387-22" data-line-number="22"></a>
<a class="sourceLine" id="cb387-23" data-line-number="23">grid_mu &lt;-<span class="st"> </span>grid_inicial <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-24" data-line-number="24"><span class="st">  </span><span class="kw">group_by</span>(mu) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-25" data-line-number="25"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p_mu =</span> <span class="kw">sum</span>(p_inicial)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-26" data-line-number="26"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-27" data-line-number="27"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_mu =</span> p_mu <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(p_mu))</a>
<a class="sourceLine" id="cb387-28" data-line-number="28"></a>
<a class="sourceLine" id="cb387-29" data-line-number="29">plot_mu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_mu, <span class="kw">aes</span>(<span class="dt">x =</span> mu, <span class="dt">y =</span> p_mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb387-31" data-line-number="31"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(mu)), </a>
<a class="sourceLine" id="cb387-32" data-line-number="32">       <span class="dt">x =</span> <span class="kw">expression</span>(mu)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-33" data-line-number="33"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="fl">0.015</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb387-34" data-line-number="34"></a>
<a class="sourceLine" id="cb387-35" data-line-number="35">mus &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">5000</span>, A_mu, B_mu)</a>
<a class="sourceLine" id="cb387-36" data-line-number="36">sims_marg &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>, </a>
<a class="sourceLine" id="cb387-37" data-line-number="37">  <span class="dt">sims_marg =</span> <span class="kw">rbeta</span>(<span class="dv">5000</span>, mus <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mus) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb387-38" data-line-number="38"></a>
<a class="sourceLine" id="cb387-39" data-line-number="39">plot_theta &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sims_marg, <span class="kw">aes</span>(<span class="dt">x =</span> sims_marg)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-40" data-line-number="40"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-41" data-line-number="41"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(theta)), </a>
<a class="sourceLine" id="cb387-42" data-line-number="42">       <span class="dt">x =</span> <span class="kw">expression</span>(theta))</a>
<a class="sourceLine" id="cb387-43" data-line-number="43"></a>
<a class="sourceLine" id="cb387-44" data-line-number="44"><span class="co"># p(theta|mu=0.75)</span></a>
<a class="sourceLine" id="cb387-45" data-line-number="45">sims_cond_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">5000</span>, <span class="fl">0.75</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb387-46" data-line-number="46"><span class="co"># p(theta|mu=0.25)</span></a>
<a class="sourceLine" id="cb387-47" data-line-number="47">sims_cond_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">5000</span>, <span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb387-48" data-line-number="48"></a>
<a class="sourceLine" id="cb387-49" data-line-number="49"><span class="co"># marginal = sims_marg</span></a>
<a class="sourceLine" id="cb387-50" data-line-number="50"></a>
<a class="sourceLine" id="cb387-51" data-line-number="51">sims &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>, </a>
<a class="sourceLine" id="cb387-52" data-line-number="52">  <span class="dt">cond_1 =</span> sims_cond_<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb387-53" data-line-number="53">  <span class="dt">cond_2 =</span> sims_cond_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-54" data-line-number="54"><span class="st">  </span><span class="kw">gather</span>(dist, values, <span class="op">-</span>sim) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb387-55" data-line-number="55"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> <span class="kw">ifelse</span>(dist <span class="op">==</span><span class="st"> &quot;cond_1&quot;</span>, <span class="fl">0.75</span>, <span class="fl">0.25</span>))</a>
<a class="sourceLine" id="cb387-56" data-line-number="56"></a>
<a class="sourceLine" id="cb387-57" data-line-number="57"></a>
<a class="sourceLine" id="cb387-58" data-line-number="58">plots_marginales &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sims, <span class="kw">aes</span>(<span class="dt">x =</span> values)) <span class="op">+</span></a>
<a class="sourceLine" id="cb387-59" data-line-number="59"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">paste</span>(theta, l, mu))), </a>
<a class="sourceLine" id="cb387-60" data-line-number="60">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-61" data-line-number="61"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb387-62" data-line-number="62"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>mu, <span class="dt">ncol =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb387-63" data-line-number="63"></a>
<a class="sourceLine" id="cb387-64" data-line-number="64"><span class="kw">grid.arrange</span>(plot_conj, plot_mu, plot_theta, plots_marginales, <span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-68-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" data-line-number="1"></a>
<a class="sourceLine" id="cb388-2" data-line-number="2"></a>
<a class="sourceLine" id="cb388-3" data-line-number="3">likeBern &lt;-<span class="st"> </span><span class="cf">function</span>(z, N){</a>
<a class="sourceLine" id="cb388-4" data-line-number="4">  <span class="cf">function</span>(theta){</a>
<a class="sourceLine" id="cb388-5" data-line-number="5">    theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(N <span class="op">-</span><span class="st"> </span>z)</a>
<a class="sourceLine" id="cb388-6" data-line-number="6">  }</a>
<a class="sourceLine" id="cb388-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb388-8" data-line-number="8"></a>
<a class="sourceLine" id="cb388-9" data-line-number="9"><span class="co"># Valores observados</span></a>
<a class="sourceLine" id="cb388-10" data-line-number="10">z &lt;-<span class="st"> </span><span class="dv">9</span>; N &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb388-11" data-line-number="11">mi_like &lt;-<span class="st"> </span><span class="kw">likeBern</span>(z, N)</a>
<a class="sourceLine" id="cb388-12" data-line-number="12"></a>
<a class="sourceLine" id="cb388-13" data-line-number="13">grid_like &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="fl">0.05</span>), <span class="dt">y =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb388-14" data-line-number="14">grid_like &lt;-<span class="st"> </span>grid_like <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb388-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">mi_like</span>(x))</a>
<a class="sourceLine" id="cb388-16" data-line-number="16"></a>
<a class="sourceLine" id="cb388-17" data-line-number="17"><span class="kw">ggplot</span>(grid_like, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb388-18" data-line-number="18"><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">color =</span> ..level..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(mu), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="kw">expression</span>(<span class="kw">L</span>(theta,mu)), <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-22" data-line-number="22"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-68-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" data-line-number="1"></a>
<a class="sourceLine" id="cb389-2" data-line-number="2"><span class="co"># cuadrícula</span></a>
<a class="sourceLine" id="cb389-3" data-line-number="3">grid_post &lt;-<span class="st"> </span>grid_inicial <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb389-5" data-line-number="5">    <span class="dt">prior =</span> p_inicial <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(p_inicial),</a>
<a class="sourceLine" id="cb389-6" data-line-number="6">    <span class="dt">Like =</span> theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(N <span class="op">-</span><span class="st"> </span>z), <span class="co"># verosimilitud </span></a>
<a class="sourceLine" id="cb389-7" data-line-number="7">    <span class="dt">posterior =</span> (Like <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Like <span class="op">*</span><span class="st"> </span>prior)</a>
<a class="sourceLine" id="cb389-8" data-line-number="8">  )  </a>
<a class="sourceLine" id="cb389-9" data-line-number="9"></a>
<a class="sourceLine" id="cb389-10" data-line-number="10">post_conj &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_post, <span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> mu, <span class="dt">z =</span> posterior)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb389-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">color =</span> ..level..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(mu), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="kw">expression</span>(<span class="kw">p</span>(theta,mu)), <span class="dt">guide =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb389-15" data-line-number="15"><span class="co"># head(grid_post)</span></a>
<a class="sourceLine" id="cb389-16" data-line-number="16"></a>
<a class="sourceLine" id="cb389-17" data-line-number="17">grid_mu &lt;-<span class="st"> </span>grid_post <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-18" data-line-number="18"><span class="st">  </span><span class="kw">group_by</span>(mu) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-19" data-line-number="19"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">post_mu =</span> <span class="kw">sum</span>(posterior)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-20" data-line-number="20"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">post_mu =</span> post_mu <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(post_mu))</a>
<a class="sourceLine" id="cb389-22" data-line-number="22"></a>
<a class="sourceLine" id="cb389-23" data-line-number="23">post_mu &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_mu, <span class="kw">aes</span>(<span class="dt">x =</span> mu, <span class="dt">y =</span> post_mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb389-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">paste</span>(mu, l, x))), </a>
<a class="sourceLine" id="cb389-26" data-line-number="26">       <span class="dt">x =</span> <span class="kw">expression</span>(mu)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb389-27" data-line-number="27"></a>
<a class="sourceLine" id="cb389-28" data-line-number="28">grid_theta &lt;-<span class="st"> </span>grid_post <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-29" data-line-number="29"><span class="st">  </span><span class="kw">group_by</span>(theta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-30" data-line-number="30"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">post_theta =</span> <span class="kw">sum</span>(posterior)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-31" data-line-number="31"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-32" data-line-number="32"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">post_theta =</span> post_theta <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(post_theta))</a>
<a class="sourceLine" id="cb389-33" data-line-number="33"></a>
<a class="sourceLine" id="cb389-34" data-line-number="34">post_theta &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_theta, <span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> post_theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb389-36" data-line-number="36"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">paste</span>(theta, l, x))), </a>
<a class="sourceLine" id="cb389-37" data-line-number="37">       <span class="dt">x =</span> <span class="kw">expression</span>(theta))</a>
<a class="sourceLine" id="cb389-38" data-line-number="38"></a>
<a class="sourceLine" id="cb389-39" data-line-number="39">grid_theta_m &lt;-<span class="st"> </span>grid_post <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-40" data-line-number="40"><span class="st">  </span><span class="kw">filter</span>(mu <span class="op">==</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">|</span><span class="st"> </span>mu <span class="op">==</span><span class="st"> </span><span class="fl">0.25</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-41" data-line-number="41"><span class="st">  </span><span class="kw">group_by</span>(theta, mu) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-42" data-line-number="42"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">post_theta =</span> <span class="kw">sum</span>(posterior)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-43" data-line-number="43"><span class="st">  </span><span class="kw">group_by</span>(mu) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb389-44" data-line-number="44"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">post_theta =</span> post_theta <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(post_theta))</a>
<a class="sourceLine" id="cb389-45" data-line-number="45"></a>
<a class="sourceLine" id="cb389-46" data-line-number="46">post_marginales &lt;-<span class="st"> </span><span class="kw">ggplot</span>(grid_theta_m, <span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> post_theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-47" data-line-number="47"><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb389-48" data-line-number="48"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>mu, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb389-49" data-line-number="49"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">paste</span>(theta, l, x, mu))), </a>
<a class="sourceLine" id="cb389-50" data-line-number="50">       <span class="dt">x =</span> <span class="kw">expression</span>(theta))</a></code></pre></div>
</div>
</div>
<div id="multiples-monedas-de-una-misma-fábrica" class="section level3 unnumbered">
<h3>Multiples monedas de una misma fábrica</h3>
<p>La sección anterior considera el escenario en que lanzamos una moneda y hacemos
inferencia del parámetro de sesgo <span class="math inline">\(\theta\)</span> y del hiperparámetro <span class="math inline">\(\mu\)</span>. Ahora
consideramos recolectar información de múltiples monedas, si cada moneda tiene
su propio sesgo <span class="math inline">\(\theta_j\)</span> entonces debemos estimar un parámetro distinto para
cada moneda.</p>
<p>Suponemos que todas las monedas provienen de la misma fábrica, esto implica
que tenemos la misma información inicial <span class="math inline">\(\mu\)</span> para todas las monedas. Suponemos
también que cada moneda se acuña de manera independiente, esto es, que
condicional al parámetro <span class="math inline">\(\mu\)</span> los parámetros <span class="math inline">\(\theta_j\)</span> son independientes
en nuestros conocimientos iniciales.</p>
<div id="posterior-vía-aproximación-por-cuadrícula" class="section level4 unnumbered">
<h4>Posterior vía aproximación por cuadrícula</h4>
<p>Supongamosque tenemos dos monedas de la misma fábrica. El objetivo es estimar
los sesgos <span class="math inline">\(\theta_1\)</span>, <span class="math inline">\(\theta_2\)</span> de las dos monedas y estimar simultáneamente
el parámetro <span class="math inline">\(\mu\)</span> correspondiente a la casa de moneda que las fabricó.</p>
<p>Inicial.</p>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-69-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Verosimilitud.</p>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-70-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Posterior.</p>
<p><img src="09-analisis_bayesiano_files/figure-html/unnamed-chunk-71-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="diagnósticos-generales.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tareas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/09-analisis_bayesiano.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
