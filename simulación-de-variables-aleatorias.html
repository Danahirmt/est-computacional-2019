<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Simulación de variables aleatorias | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Simulación de variables aleatorias | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Simulación de variables aleatorias | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variables-aleatorias-1.html"/>
<link rel="next" href="simulación-de-modelos.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
<li class="chapter" data-level="10.9.1" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#iniciales-en-stan"><i class="fa fa-check"></i><b>10.9.1</b> Iniciales en Stan</a></li>
<li class="chapter" data-level="10.9.2" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recursos-de-stan-y-paquetes-con-r"><i class="fa fa-check"></i><b>10.9.2</b> Recursos de Stan y paquetes con R:</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulación-de-variables-aleatorias" class="section level2">
<h2><span class="header-section-number">7.3</span> Simulación de variables aleatorias</h2>
<p>Veremos métodos generales para simular muestras de distribuciones univariadas,
generales se refiere a que se pueden utilizar independientemente de la forma
de la función de densidad.</p>
<p>Para utilizar estos métodos debemos tener un generador de números aleatorios
confiable, pues la mayoría de los métodos consisten en una transformación
de números aleatorios.</p>
<div id="variables-aletaorias-discretas" class="section level3 unnumbered">
<h3>Variables aletaorias discretas</h3>
<div id="método-de-inversión" class="section level4 unnumbered">
<h4>Método de Inversión</h4>
<p>Supongamos que deseamos generar el valor de una variable aleatoria discreta <span class="math inline">\(X\)</span>
con función de probabilidad:
<span class="math display">\[P(X=x_j) = p_j\]</span>
con <span class="math inline">\(j=0,1,2,..\)</span>.</p>
<p>Para lograr esto generamos un número aleatorio <span class="math inline">\(U\)</span>, esto es
<span class="math inline">\(U\sim Uniforme(0,1)\)</span> y definimos</p>
<p><span class="math display">\[
X = \left\{
  \begin{array}{lr}
    x_0   &amp;  U &lt; p_0\\
    x_1 &amp;  p_0 \leq U &lt; p_0 + p_1\\
    \vdots &amp;\\
    x_j &amp; \sum_{i=0}^{j-1}p_i \leq U &lt; \sum_{i=0}^j p_i \\
    \vdots &amp; \\
  \end{array}
\right.
\]</span></p>
<p>Como para <span class="math inline">\(0&lt;a&lt;b&lt;1\)</span> tenemos que <span class="math inline">\(P(a\leq U &lt; b)=b-a\)</span>, tenemos que
<span class="math display">\[P(X=x_j)=P\bigg\{\sum_{i=0}^{j-1}p_i \leq U &lt; \sum_{i=0}^{j}p_i \bigg \}=p_j\]</span>
y por tanto <span class="math inline">\(X\)</span> tiene la distribución deseada.</p>
<div class="caja">
<p><strong>Método de inversión</strong></p>
<ol style="list-style-type: decimal">
<li><p>Genera un número aleatorio <span class="math inline">\(U\)</span>, tal que <span class="math inline">\(U \in (0,1)\)</span>.<br />
Si <span class="math inline">\(U&lt;p_0\)</span> define <span class="math inline">\(X=x_0\)</span> y para.<br />
Si <span class="math inline">\(U&lt; p_0+p_1\)</span> define <span class="math inline">\(X = x_1\)</span> y para.<br />
Si <span class="math inline">\(U &lt; p_0 + p_1 + p_2\)</span> define <span class="math inline">\(X=x_2\)</span> y para.<br />
<span class="math inline">\(\vdots\)</span></p></li>
<li><p>Si las <span class="math inline">\(x_i\)</span>, están ordenadas de tal manera que <span class="math inline">\(x_0&lt;x_1&lt;x_2&lt;\cdots\)</span> y si
denotamos por <span class="math inline">\(P\)</span> la función de distribución acumulada de <span class="math inline">\(X\)</span>, entonces
<span class="math inline">\(P(x_k)=\sum_{i=0}^kp_i\)</span> y por tanto, <span class="math inline">\(X\)</span> será igual a <span class="math inline">\(x_j\)</span> si
<span class="math display">\[P(x_{j-1}) \leq U \leq P(x_j)\]</span></p></li>
</ol>
<p>En otras palabras, tras generar un número aleatorio <span class="math inline">\(U\)</span> determinamos el valor de
<span class="math inline">\(X\)</span> encontrando el intervalo <span class="math inline">\([P(x_{j-1}),P(x_j))\)</span> en el que cae <span class="math inline">\(U\)</span>, esto es
equivalente a encontrar la inversa de <span class="math inline">\(P(U)\)</span>.</p>
</div>
<p>El tiempo que uno tarda en generar una variable aleatoria discreta usando el
método de arriba es proporcional al número de intervalos que uno debe buscar,
es por esto que en ocasiones vale la pena considerar los posibles valores
<span class="math inline">\(x_j\)</span> en orden decreciente de <span class="math inline">\(p_j\)</span>.</p>
<p><img src="img/manicule2.jpg" /> Utiliza la función runif de R y el método de
inversión para generar 1000 simulaciones de una variable aleatoria <span class="math inline">\(X\)</span> tal que
<span class="math inline">\(p_1=0.20, p_2= 0.15, p_3=0.25, p_4=0.40\)</span> donde <span class="math inline">\(p_j=P(X=j)\)</span>.</p>
</div>
<div id="ejemplos-1" class="section level4 unnumbered">
<h4>Ejemplos</h4>
<p><strong>Uniforme discreta</strong>. Supongamos que deseamos simular de una variable aleatoria
uniforme discreta que toma valores <span class="math inline">\(1,...,k\)</span>, usando los resultados anteriores
tenemos que:</p>
<p><span class="math inline">\(X=j\)</span> si <span class="math inline">\(\frac{j-1}{n} \leq U &lt; \frac{j}{n}\)</span></p>
<p>Entonces <span class="math inline">\(X=[kU] + 1\)</span>, donde <span class="math inline">\([x]\)</span> representa la parte entera de x.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1"><span class="co"># uniforme discreta: donde n es el número de simulaciones y k el número de elementos</span></a>
<a class="sourceLine" id="cb250-2" data-line-number="2">runifD &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">1</span>, k) <span class="kw">floor</span>(k <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(n)) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb250-3" data-line-number="3"><span class="co"># veamos un histograma de 1000 simulaciones de una distribución Uniforme</span></a>
<a class="sourceLine" id="cb250-4" data-line-number="4"><span class="co"># discreta con parámetro k = 20</span></a>
<a class="sourceLine" id="cb250-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw">runifD</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">k =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb250-6" data-line-number="6"><span class="kw">qplot</span>(x, <span class="dt">binwidth =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="06-v_aleatorias_y_simualcion_files/figure-html/unnamed-chunk-10-1.png" width="300px" style="display: block; margin: auto;" /></p>
<p>También podmeos usar la función sample de R:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" data-line-number="1"><span class="kw">qplot</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace=</span> <span class="ot">TRUE</span>), <span class="dt">binwidth =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="06-v_aleatorias_y_simualcion_files/figure-html/unnamed-chunk-11-1.png" width="300px" style="display: block; margin: auto;" /></p>
<p><strong>Poisson</strong>: la clave para usar el método de la transformación inversa en este
ejemplo es notar que:
<span class="math display">\[p_{i+1}=\frac{\lambda}{i+1}p_i\]</span></p>
<p>donde <span class="math inline">\(p_i=P(X=i) = e^{-\lambda} \cdot \lambda^i/i!\)</span>, con <span class="math inline">\(i=0,1,...\)</span>. Ahora,
la cantidad <span class="math inline">\(i\)</span> se refiere al valor que estamos considerando, <span class="math inline">\(p=p_i\)</span> es la
probabilidad de <span class="math inline">\(X = i\)</span> y <span class="math inline">\(P=P(i)\)</span> es la probabilidad de <span class="math inline">\(X\leq i\)</span>. Entonces,
para generar una observación sequimos los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>Generar un número aleatorio <span class="math inline">\(U\)</span>, tal que <span class="math inline">\(U \in (0,1)\)</span>.<br />
</li>
<li>Inicializar: <span class="math inline">\(i=0\)</span>, <span class="math inline">\(p=e^{-\lambda}\)</span>, <span class="math inline">\(F=p\)</span>.<br />
</li>
<li>Si <span class="math inline">\(U&lt;F\)</span>, definir <span class="math inline">\(X=i\)</span> y parar.<br />
</li>
<li><span class="math inline">\(p=\lambda p/(i+1)\)</span>, <span class="math inline">\(F=F+p\)</span>, <span class="math inline">\(i=i+1\)</span>.<br />
</li>
<li>Volver a 3.</li>
</ol>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1"><span class="co"># Poisson usando Inversión</span></a>
<a class="sourceLine" id="cb252-2" data-line-number="2">rpoisI &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">lambda =</span> <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb252-3" data-line-number="3">  U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb252-4" data-line-number="4">  i &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb252-5" data-line-number="5">  p &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda)</a>
<a class="sourceLine" id="cb252-6" data-line-number="6">  P &lt;-<span class="st"> </span>p</a>
<a class="sourceLine" id="cb252-7" data-line-number="7">  <span class="cf">while</span>(U <span class="op">&gt;=</span><span class="st"> </span>P){</a>
<a class="sourceLine" id="cb252-8" data-line-number="8">    p &lt;-<span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span>p <span class="op">/</span><span class="st"> </span>(i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb252-9" data-line-number="9">    P &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>p</a>
<a class="sourceLine" id="cb252-10" data-line-number="10">    i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb252-11" data-line-number="11">  }</a>
<a class="sourceLine" id="cb252-12" data-line-number="12">  i</a>
<a class="sourceLine" id="cb252-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb252-14" data-line-number="14">sims_pois &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">rpoisI</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</a>
<a class="sourceLine" id="cb252-15" data-line-number="15"></a>
<a class="sourceLine" id="cb252-16" data-line-number="16"><span class="kw">qplot</span>(sims_pois, <span class="dt">binwidth =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="06-v_aleatorias_y_simualcion_files/figure-html/unnamed-chunk-12-1.png" width="300px" style="display: block; margin: auto;" /></p>
<p>El algoritmo que propusimos verifica de manera sucesiva si el valor es 0, 1, etc.
por lo que el número de comparaciones necesarias será uno más que el valor de
la variable. Ahora, el valor esperado de una variable aleatoria Poisson es
<span class="math inline">\(\lambda\)</span> por lo que en promedio se harían <span class="math inline">\(1+\lambda\)</span> busquedas. Cuando <span class="math inline">\(\lambda\)</span>
es grande se puede mejorar el algoritmo buscando primero en valores cercanos a
<span class="math inline">\(\lambda\)</span>.</p>
<p><img src="img/manicule2.jpg" /> Escribe una función en R que genere simulaciones
de una variable aleatoria Poisson de la siguiente manera: define <span class="math inline">\(I=[\lambda]\)</span>,
y usa que <span class="math inline">\(p_{i+1}=\lambda p_i /(i+1)\)</span> para determinar <span class="math inline">\(F\)</span> de manera recursiva.
Genera un número aleatorio <span class="math inline">\(U\)</span>, determina si <span class="math inline">\(X \leq I\)</span> comparando si
<span class="math inline">\(U \leq F(I)\)</span>. Si <span class="math inline">\(X \leq I\)</span> busca hacia abajo comenzando en <span class="math inline">\(I\)</span>, de lo contrario
busca hacia arriba comenzando por <span class="math inline">\(I+1\)</span>. Compara el tiempo que tardan los dos
algoritmos en 5000 simulaciones de una variable aleatoria Poisson con
parámetro <span class="math inline">\(\lambda=10, 200, 500\)</span>.</p>
</div>
</div>
<div id="aceptación-y-rechazo" class="section level3 unnumbered">
<h3>Aceptación y rechazo</h3>
<p>Supongamos que tenemos un método eficiente para generar simulaciones de una
variable aleatoria con función de probabilidad masa <span class="math inline">\(\{q_j, j\geq 0\}\)</span>, podemos
usarla como la base para simular de una distribución que tiene función de
probabilidad masa <span class="math inline">\(\{p_j, j \geq 0\}\)</span>, para hacer esto comenzamos simulando
una variable aleatoria <span class="math inline">\(Y\)</span> con función <span class="math inline">\(\{q_j\}\)</span> y después aceptamos o
rechazamos el valor simulado con una probabilidad proporcional a <span class="math inline">\(p_Y/q_Y\)</span>.
En particular, sea <span class="math inline">\(c\)</span> una constante tal que
<span class="math display">\[\frac{p_j}{q_j}\leq c\]</span>
para toda <span class="math inline">\(j\)</span> con <span class="math inline">\(p_j &gt; 0\)</span>. Entonces el método de aceptación y rechazo para
simular una variable aleatoria <span class="math inline">\(X\)</span> con función masa de probabilidad <span class="math inline">\(p_j=P(x=j)\)</span>
es como sigue:</p>
<div class="caja">
<p><strong>Método de aceptación y rechazo</strong></p>
<ol style="list-style-type: decimal">
<li>Simula el valor de <span class="math inline">\(Y\)</span>, con función de probabilidad masa <span class="math inline">\(q_j\)</span>.<br />
</li>
<li>Genera un número aleatorio <span class="math inline">\(U\)</span>, tal que <span class="math inline">\(U \in (0,1)\)</span>.<br />
</li>
<li>Si <span class="math inline">\(U &lt; p_y/(cq_y)\)</span> definimos <span class="math inline">\(X=Y\)</span> y paramos, en otro caso regresamos a 1.</li>
</ol>
<p>En promedio este algoritmo requiere <span class="math inline">\(c\)</span> iteraciones para obtener un valor
generado para <span class="math inline">\(X\)</span>.</p>
</div>
<p><img src="img/manicule2.jpg" />. Supongamos que queremos simular el valor de una
variable aleatoria <span class="math inline">\(X\)</span> que toma uno de los valores <span class="math inline">\(1,2,3,4\)</span> con probabilidades
<span class="math inline">\(p_1=0.20, p_2= 0.15, p_3=0.25, p_4=0.40\)</span> donde <span class="math inline">\(p_j=P(X=j)\)</span>. Usemos el método
de aceptación y rechazo con <span class="math inline">\(q\)</span> la densidad uniforme en <span class="math inline">\(1,...,4\)</span>. ¿Cómo se
compara en velocidad con la función que implementaste usando el método de la
transformación inversa?</p>
</div>
<div id="variables-aleatorias-continuas-2" class="section level3 unnumbered">
<h3>Variables aleatorias continuas</h3>
<div id="método-de-inversión-1" class="section level4 unnumbered">
<h4>Método de inversión</h4>
<div class="caja">
<p>Sea <span class="math inline">\(U\)</span> una variable aleatoria con ditribución <span class="math inline">\(U(0,1)\)</span>. Para cualquier
función de distribución <span class="math inline">\(F_X\)</span> (<span class="math inline">\(F_X\)</span> es creciente y continua entonces existe
<span class="math inline">\(F_X^{-1}\)</span>) la variable aleatoria <span class="math inline">\(X\)</span> definida como:
<span class="math display">\[X = F_X^{-1}(U)\]</span>
tiene distribución <span class="math inline">\(F_X\)</span>.</p>
</div>
<p>La proposición anterior nos da un camino para simular variables aleatorias
continuas:</p>
<ol style="list-style-type: decimal">
<li>Generamos un número aleatorio <span class="math inline">\(U\)</span>.<br />
</li>
<li>Definimos <span class="math inline">\(X = F^{-1}(U)\)</span>:</li>
</ol>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span> , <span class="dv">2</span>)), <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb253-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb253-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb253-4" data-line-number="4"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> qnorm, <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;fq&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb253-5" data-line-number="5"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;fdp&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb253-6" data-line-number="6"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pnorm, <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;fda&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb253-7" data-line-number="7"><span class="st">    </span><span class="kw">coord_fixed</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb253-8" data-line-number="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Método de transformación inversa caso Normal&quot;</span>)</a></code></pre></div>
<p><img src="06-v_aleatorias_y_simualcion_files/figure-html/inversion_normal-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="ejemplo-exponencial" class="section level4 unnumbered">
<h4>Ejemplo: Exponencial</h4>
<p>Si <span class="math inline">\(X\)</span> es una variable aleatoria exponencial con tasa 1, entonces</p>
<p><span class="math display">\[F(x)=1-e^{-x}\]</span></p>
<p>Si definimos <span class="math inline">\(x=F^{-1}(u)\)</span>, entonces
<span class="math display">\[u=F(x)=1-e^{-x}\]</span>
o
<span class="math display">\[x = -log(1-u)\]</span></p>
<p>Vale la pena notar que si <span class="math inline">\(U\)</span> tiene distribución <span class="math inline">\(U(0,1)\)</span>, <span class="math inline">\(1-U\)</span> también
se distribuye uniforme(0,1).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1">simExp &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb254-2" data-line-number="2">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb254-3" data-line-number="3">  x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(u)</a>
<a class="sourceLine" id="cb254-4" data-line-number="4">}</a></code></pre></div>
<p>Notemos que para cualquier constante positiva <span class="math inline">\(c\)</span>, <span class="math inline">\(cX\)</span> tiene distribución
exponencial con media <span class="math inline">\(c\)</span>, por tanto una variable aleatoria exponencial con
parámetro <span class="math inline">\(\beta\)</span> se puede generar de la siguiente manera:</p>
<p><span class="math display">\[X=-\beta log(U)\]</span></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1">sim_exp_beta &lt;-<span class="st"> </span><span class="cf">function</span>(beta, <span class="dt">n =</span> <span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb255-2" data-line-number="2">  <span class="op">-</span>beta <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">runif</span>(n))</a>
<a class="sourceLine" id="cb255-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb255-4" data-line-number="4">sims_exp &lt;-<span class="st"> </span><span class="kw">sim_exp_beta</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb255-5" data-line-number="5"><span class="kw">mean</span>(sims_exp)</a>
<a class="sourceLine" id="cb255-6" data-line-number="6"><span class="co">#&gt; [1] 2.0629</span></a>
<a class="sourceLine" id="cb255-7" data-line-number="7"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb255-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sims_exp, <span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="06-v_aleatorias_y_simualcion_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>El algoritmo anterior también provee una manera de generar variables aleatorias
Poisson. Para esto usamos la relación entre la Poisson y la exponencial:</p>
<ul>
<li><p>Un proceso Poisson con tasa <span class="math inline">\(\lambda\)</span> resulta cuando los tiempos de espera
entre eventos sucesivos son exponenciales independientes con parámetro
<span class="math inline">\(\beta = 1/\lambda\)</span>,</p></li>
<li><p>Para este proceso, <span class="math inline">\(N(1)\)</span>, el número de eventos en el tiempo 1 se distribuye
Poisson con media <span class="math inline">\(1/\beta\)</span>.</p></li>
<li><p>Si denotamos por <span class="math inline">\(X_i\)</span> los tiempos entre eventos, el <span class="math inline">\(n\)</span>-ésimo evento
ocurrirá en el tiempo <span class="math inline">\(\sum_{i=1}^n X_i\)</span> y por tanto el número de eventos
al tiempo 1 se puede expresar como:</p></li>
</ul>
<p><span class="math display">\[N(1)=max\bigg\{n: \sum_{i=1}^nX_i \leq 1\bigg\}\]</span></p>
<ul>
<li><p>Esto es, el número de eventos al tiempo 1 es igual a la <span class="math inline">\(n\)</span> mayor para la cual
el n-ésimo evento ocurrió al tiempo 1.</p></li>
<li><p>Por ejemplo, si el cuarto evento ocurrió al tiempo uno pero el quinto no,
habría 4 eventos al tiempo 1. Por tanto podemos generar una variable aleatoria
Poisson con media <span class="math inline">\(\lambda = 1/\beta\)</span> generando números aleatorios
<span class="math inline">\(U_1,...U_n,...\)</span> y definiendo</p></li>
</ul>
<p><span class="math display">\[N=max\bigg\{n: \sum_{i=1}^n -\beta log(U_i) \le 1\bigg\}\]</span>
<span class="math display">\[=max\bigg\{n: \sum_{i=1}^n -1/\lambda log(U_i) \le 1\bigg\}\]</span>
<span class="math display">\[=max\bigg\{n:\sum_{i=1}^n log(U_i)\geq -\lambda \bigg\}\]</span>
<span class="math display">\[=max\{n:log(U_1\cdot\cdot\cdot U_n) \geq -\lambda\}\]</span>
<span class="math display">\[=max\{n: U_1\cdot \cdot \cdot U_n \geq e^{-\lambda}\}\]</span></p>
<p>Es así, que una variable aleatoria Poisson con media <span class="math inline">\(\lambda\)</span> se puede generar
a partir de una sucesión de números aleatorios, generando números hasta que
el producto sea menor a <span class="math inline">\(e^{-\lambda}\)</span> y definiendo <span class="math inline">\(X\)</span> como uno menos del
número de números aleatorios requeridos.</p>
<p><span class="math display">\[N = min\{n: U_1\cdot\cdot\cdot U_n &lt; e^{-\lambda}\} - 1\]</span></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1">poisson &lt;-<span class="st"> </span><span class="cf">function</span>(lambda){</a>
<a class="sourceLine" id="cb256-2" data-line-number="2">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb256-3" data-line-number="3">  N &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb256-4" data-line-number="4">  <span class="cf">while</span> (u <span class="op">&gt;</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda)) {</a>
<a class="sourceLine" id="cb256-5" data-line-number="5">    u &lt;-<span class="st"> </span>u <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb256-6" data-line-number="6">    N &lt;-<span class="st"> </span>N <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb256-7" data-line-number="7">  }</a>
<a class="sourceLine" id="cb256-8" data-line-number="8">  N <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb256-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb256-10" data-line-number="10"></a>
<a class="sourceLine" id="cb256-11" data-line-number="11"><span class="kw">poisson</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb256-12" data-line-number="12"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb256-13" data-line-number="13"><span class="kw">mean</span>(<span class="kw">rdply</span>(<span class="dv">1000</span>, <span class="kw">poisson</span>(<span class="dv">10</span>))<span class="op">$</span>V1)</a>
<a class="sourceLine" id="cb256-14" data-line-number="14"><span class="co">#&gt; [1] 10.073</span></a></code></pre></div>
</div>
<div id="ejemplo-gamma" class="section level4 unnumbered">
<h4>Ejemplo: Gamma</h4>
<p>Supongamos que deseamos generar el valor de una variable aleatoria
<span class="math inline">\(Gamma(n,\beta)\)</span>, la función de distribución es,</p>
<p><span class="math display">\[\int_{0}^x \frac{1}{\beta^n \Gamma(n)}x^{n-1}e^{-x/\beta}dy\]</span></p>
<ul>
<li><p>La inversa de la función de distribución acumulada anterior no se puede
escribir de forma cerrada.</p></li>
<li><p>Sin embargo, podeos usar que una <span class="math inline">\(Gamma(n,\beta)\)</span> se puede ver como la suma
de <span class="math inline">\(n\)</span> exponenciales independientes, cada una con parámetro <span class="math inline">\(\beta\)</span>:</p></li>
</ul>
<p><span class="math display">\[X=-\beta log(U_1)-\cdot\cdot\cdot - \beta log(U_n)\]</span>
<span class="math display">\[=-\beta log(U_1\cdot\cdot\cdot U_n)\]</span></p>
<p>donde la identidad <span class="math inline">\(\sum log(x_i) = log(x_1\cdot\cdot\cdot x_n)\)</span> deriva en
ganancias computacionales.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" data-line-number="1">gamma_nb &lt;-<span class="st"> </span><span class="cf">function</span>(n, beta){</a>
<a class="sourceLine" id="cb257-2" data-line-number="2">  <span class="op">-</span>beta <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">Reduce</span>(<span class="st">`</span><span class="dt">*</span><span class="st">`</span>,<span class="kw">runif</span>(<span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb257-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb257-4" data-line-number="4">sims_gamma &lt;-<span class="st"> </span><span class="kw">rdply</span>(<span class="dv">1000</span>, <span class="kw">gamma_nb</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">beta =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb257-5" data-line-number="5"><span class="kw">mean</span>(sims_gamma<span class="op">$</span>V1)</a>
<a class="sourceLine" id="cb257-6" data-line-number="6"><span class="co">#&gt; [1] 19.77</span></a>
<a class="sourceLine" id="cb257-7" data-line-number="7"><span class="kw">var</span>(sims_gamma<span class="op">$</span>V1)</a>
<a class="sourceLine" id="cb257-8" data-line-number="8"><span class="co">#&gt; [1] 37.19</span></a></code></pre></div>
</div>
</div>
<div id="aceptación-y-rechazo-1" class="section level3 unnumbered">
<h3>Aceptación y rechazo</h3>
<ul>
<li><p>Supongamos que tenemos un método para generar variables aleatorias con función
de densidad <span class="math inline">\(g(x)\)</span>,</p></li>
<li><p>podemos usarla como base para generar observaciones de una variable aleatoria
con densidad <span class="math inline">\(f(x)\)</span> generando <span class="math inline">\(Y\)</span> de <span class="math inline">\(g\)</span> y después aceptando
el valor generado con una probabilidad proporcional a <span class="math inline">\(f(Y)/g(Y)\)</span>.</p></li>
<li><p>Sea <span class="math inline">\(c\)</span> una constante tal que</p></li>
</ul>
<p><span class="math display">\[\frac{f(y)}{g(y)} \leq c\]</span></p>
<p>para toda <span class="math inline">\(c\)</span>, entonces el método se puede escribir como sigue:</p>
<div class="caja">
<p><strong>Aceptación y rechazo</strong></p>
<ol style="list-style-type: decimal">
<li>Genera <span class="math inline">\(Y\)</span> con densidad <span class="math inline">\(g\)</span>.<br />
</li>
<li>Genera un número aleatorio <span class="math inline">\(U\)</span>.<br />
</li>
<li>Si <span class="math inline">\(U \leq \frac{f(Y)}{cg(Y)}\)</span>
define <span class="math inline">\(X=Y\)</span>, de lo contrario regresa a 1.</li>
</ol>
<p>El método de aceptación y rechazo es análogo al correspondiente a variables
aleatorias discretas.</p>
<ol style="list-style-type: lower-roman">
<li>La variable aleatoria generada usando el método de aceptación y rechazo
tiene densidad <span class="math inline">\(f\)</span>.<br />
</li>
<li>El número de iteraciones del algoritmo que se necesitan es una variable
aleatoria geométrica con media <span class="math inline">\(c\)</span>.</li>
</ol>
</div>
<div id="ejemplo-beta" class="section level4 unnumbered">
<h4>Ejemplo: Beta</h4>
<p>Usemos el método de aceptación y rechazo para generar observaciones de una
variable aleatoria <span class="math inline">\(beta(2,4)\)</span>:
<span class="math display">\[f(x)=20x(1-x)^3\]</span>
La variable aleatoria beta toma valores en el intervalo (0,1) por lo que
consideremos <span class="math inline">\(g(x)=1\)</span>, para <span class="math inline">\(0&lt;x&lt;1\)</span>. Para determinar la menor <span class="math inline">\(c\)</span> tal que
<span class="math inline">\(f(x)/g(x)\leq c\)</span> podemos derivar y obtenemos <span class="math inline">\(c = 135/64\)</span>,
<span class="math display">\[\frac{f(x)}{g(x)} \leq 20 \cdot \frac{1}{4} \bigg(\frac{3}{4}\bigg)^3 = \frac{135}{64}\]</span></p>
<p>y</p>
<p><span class="math display">\[\frac{f(x)}{cg(x)}=\frac{256}{27}x(1-x)^3\]</span></p>
<p>por lo que el procedimiento para simular sería el siguiente:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1">beta24 &lt;-<span class="st"> </span><span class="cf">function</span>(){</a>
<a class="sourceLine" id="cb258-2" data-line-number="2">  <span class="co"># 1. Generar dos números aleatorios U_1, U_2. </span></a>
<a class="sourceLine" id="cb258-3" data-line-number="3">  u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb258-4" data-line-number="4">  u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb258-5" data-line-number="5">  <span class="co"># 2. Comparar con f(x)/cg(x)</span></a>
<a class="sourceLine" id="cb258-6" data-line-number="6">  <span class="cf">while</span> (u2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">256</span> <span class="op">/</span><span class="st"> </span><span class="dv">27</span> <span class="op">*</span><span class="st"> </span>u1 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u1) <span class="op">^</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb258-7" data-line-number="7">    u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb258-8" data-line-number="8">    u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb258-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb258-10" data-line-number="10">  u1</a>
<a class="sourceLine" id="cb258-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb258-12" data-line-number="12">sims &lt;-<span class="st"> </span><span class="kw">rdply</span>(<span class="dv">1000</span>, beta24)</a>
<a class="sourceLine" id="cb258-13" data-line-number="13"><span class="kw">mean</span>(sims<span class="op">$</span>V1)</a>
<a class="sourceLine" id="cb258-14" data-line-number="14"><span class="co">#&gt; [1] 0.334</span></a></code></pre></div>
</div>
<div id="ejemplo-gamma32-1" class="section level4 unnumbered">
<h4>Ejemplo: Gamma(3/2, 1)</h4>
<p>Supongamos que deseamos generar simulaciones de una variable aleatoria con densidad gamma(3/2, 1):
<span class="math display">\[f(x)=\frac{1}{\Gamma(3/2)}x^{1/2}e^{-x}\]</span>
dado que la variable aleatoria de nuestro interés se concentra en los números positivos, y tiene media <span class="math inline">\(3/2\)</span>, es conveniente usar el método de aceptación y rechazo con la variable aleatoria exponencial de la misma media.
<span class="math display">\[g(x)=\frac{2}{3}e^{-2x/3}\]</span></p>
<p><img src="img/manicule2.jpg" /> Usa el método de aceptación y rechazo para generar 1000 observaciones de una variable aleatoria con distribución gamma(3/2,1).</p>
</div>
<div id="ejemplo-variable-aleatoria-normal" class="section level4 unnumbered">
<h4>Ejemplo: Variable aleatoria normal</h4>
<p>Nuestro objetivo es primero, simular una variable aleatoria normal estándar Z,
para ello comencemos notando que el valor absoluto de Z tiene función de
densidad:
<span class="math display">\[f(x)=\frac{2}{\sqrt{2\pi}}e^{-x^2/2}\]</span>
con soporte en los reales positivos. Generaremos observaciones de la densidad
anterior usando el método de aceptación y rechazo con <span class="math inline">\(g\)</span> una densidad
exponencial con media 1:</p>
<p><span class="math display">\[g(x)= e^{-x}\]</span></p>
<p>Ahora,
<span class="math inline">\(\frac{f(x)}{g(x)}=\sqrt{2/\pi}e^{x - x^2/2}\)</span>
y por tanto el máximo valor de <span class="math inline">\(f(x)/g(x)\)</span> ocurre en el valor <span class="math inline">\(x\)</span> que maximiza
<span class="math inline">\(x - x^2/2\)</span>, esto ocurre en <span class="math inline">\(x=1\)</span>, y podemos tomar <span class="math inline">\(c=\sqrt{2e/\pi}\)</span>,
<span class="math display">\[\frac{f(x)}{cg(x)}=exp\bigg\{x - \frac{x^2}{2}-{1}{2}\bigg\}\]</span>
<span class="math display">\[=exp\bigg\{\frac{(x-1)^2}{2}\bigg\}\]</span></p>
<p>y por tanto podemos generar el valor absoluto de una variable aleatoria con
distribución normal estándar de la siguiente manera:</p>
<ol style="list-style-type: decimal">
<li>Genera <span class="math inline">\(Y\)</span> una variable aleatoria exponencial con tasa 1.<br />
</li>
<li>Genera un número aleatorio <span class="math inline">\(U\)</span>.<br />
</li>
<li>Si <span class="math inline">\(U \leq exp\{-(Y-1)^2/2\}\)</span> define <span class="math inline">\(X=Y\)</span>, en otro caso vuelve a 1.</li>
</ol>
<p>Para generar una variable aleatoria con distribución normal estándar <span class="math inline">\(Z\)</span>
simplemente elegimos <span class="math inline">\(X\)</span> o <span class="math inline">\(-X\)</span> con igual probabilidad.</p>
<p>Notemos además que en paso 3 <span class="math inline">\(Y\)</span> es aceptado si <span class="math inline">\(U \leq exp(-(Y-1)^2/2)\)</span> esto es
equivalente a <span class="math inline">\(-log(U) \geq (Y-1)^2/2\)</span> y recordemos que <span class="math inline">\(-log(U)\)</span> es exponencial
con parámetro 1, por lo que podems escribir los pasos como:</p>
<ol style="list-style-type: decimal">
<li>Genera 2 exponenciales independientes con parámetro 1: <span class="math inline">\(Y_1, Y_2\)</span>.<br />
</li>
<li>Si <span class="math inline">\(Y_2 \geq (Y_1 - 1)^2/2\)</span> define <span class="math inline">\(X=Y\)</span>, de lo contrario vuelve a 1.</li>
</ol>
<p>Supongamos ahora que aceptamos <span class="math inline">\(Y_1\)</span>, esto es equivalente a decir que <span class="math inline">\(Y_2\)</span> es
mayor a <span class="math inline">\((Y_1 - 1)^2/2\)</span>, y la diferencia <span class="math inline">\(Y_2 - (Y_1 - 1)^2/2\)</span> se distribuye
exponencial con parámetro 1. Esto es, cuando aceptamos en el segundo paso no
sólo obtenemos <span class="math inline">\(X\)</span> sino que calculando
<span class="math inline">\(Y_2 - (Y_1 - 1)^2/2\)</span> podemos generar una variable aleatoria exponencial con
parámetro 1 independiente de <span class="math inline">\(X\)</span>. Esto es relevante pues si estamos generando
una sucesión de variables aleatorias normales obtendríamos un algoritmo más
eficiente.</p>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="variables-aleatorias-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulación-de-modelos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/06-v_aleatorias_y_simualcion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
