<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.4 Tamaño de muestra/calculos de potencia | Estadística Computacional</title>
  <meta name="description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="generator" content="bookdown 0.15.1 and GitBook 2.6.7" />

  <meta property="og:title" content="8.4 Tamaño de muestra/calculos de potencia | Estadística Computacional" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  <meta name="github-repo" content="tereom/est-computacional-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.4 Tamaño de muestra/calculos de potencia | Estadística Computacional" />
  
  <meta name="twitter:description" content="Curso de estadística computacional, Maestría en Ciencia de Datos, ITAM 2019." />
  

<meta name="author" content="María Teresa Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inferencia-visual.html"/>
<link rel="next" href="inferencia-paramétrica.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6/profvis.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.6/profvis.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="css/cajas.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Computacional</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a><ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#calificación"><i class="fa fa-check"></i>Calificación</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#otros-recursos"><i class="fa fa-check"></i>Otros recursos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="noticias.html"><a href="noticias.html"><i class="fa fa-check"></i>Noticias</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-visualización.html"><a href="principios-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios visualización</a><ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-de-datos-en-la-estadística"><i class="fa fa-check"></i>Visualización de datos en la estadística</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="teoría-de-visualización-de-datos.html"><a href="teoría-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>1.2</b> Teoría de visualización de datos</a></li>
<li class="chapter" data-level="1.3" data-path="factor-de-engaño-y-chartjunk.html"><a href="factor-de-engaño-y-chartjunk.html"><i class="fa fa-check"></i><b>1.3</b> Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="1.4" data-path="pequeños-múltiplos-y-densidad-gráfica.html"><a href="pequeños-múltiplos-y-densidad-gráfica.html"><i class="fa fa-check"></i><b>1.4</b> Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="1.5" data-path="tinta-de-datos.html"><a href="tinta-de-datos.html"><i class="fa fa-check"></i><b>1.5</b> Tinta de datos</a></li>
<li class="chapter" data-level="1.6" data-path="decoración.html"><a href="decoración.html"><i class="fa fa-check"></i><b>1.6</b> Decoración</a></li>
<li class="chapter" data-level="1.7" data-path="percepción-de-escala.html"><a href="percepción-de-escala.html"><i class="fa fa-check"></i><b>1.7</b> Percepción de escala</a></li>
<li class="chapter" data-level="1.8" data-path="ejemplos-gráfica-de-minard.html"><a href="ejemplos-gráfica-de-minard.html"><i class="fa fa-check"></i><b>1.8</b> Ejemplos: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r-y-al-paquete-ggplot2.html"><a href="introducción-a-r-y-al-paquete-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introducción a R y al paquete ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html"><i class="fa fa-check"></i><b>2.1</b> R: primeros pasos</a><ul>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#r-en-análisis-de-datos"><i class="fa fa-check"></i>R en análisis de datos</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#paquetes-y-el-tidyverse"><i class="fa fa-check"></i>Paquetes y el Tidyverse</a></li>
<li class="chapter" data-level="" data-path="r-primeros-pasos.html"><a href="r-primeros-pasos.html#recursos"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html"><i class="fa fa-check"></i><b>2.2</b> Visualización con ggplot2</a><ul>
<li class="chapter" data-level="" data-path="visualización-con-ggplot2.html"><a href="visualización-con-ggplot2.html#recursos-1"><i class="fa fa-check"></i>Recursos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulación-y-agrupación-de-datos.html"><a href="manipulación-y-agrupación-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y agrupación de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html"><i class="fa fa-check"></i><b>3.1</b> Transformación de datos</a><ul>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#datos"><i class="fa fa-check"></i>Datos</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#filtrar"><i class="fa fa-check"></i>Filtrar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#seleccionar"><i class="fa fa-check"></i>Seleccionar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#ordenar"><i class="fa fa-check"></i>Ordenar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#mutar"><i class="fa fa-check"></i>Mutar</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#summarise-y-resúmenes-por-grupo"><i class="fa fa-check"></i>Summarise y resúmenes por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#variables-por-grupo"><i class="fa fa-check"></i>Variables por grupo</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos.html"><a href="transformación-de-datos.html#verbos-de-dos-tablas"><i class="fa fa-check"></i>Verbos de dos tablas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datos-limpios.html"><a href="datos-limpios.html"><i class="fa fa-check"></i><b>3.2</b> Datos limpios</a><ul>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#limpieza-bases-de-datos"><i class="fa fa-check"></i>Limpieza bases de datos</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#los-encabezados-de-las-columanas-son-valores"><i class="fa fa-check"></i>Los encabezados de las columanas son valores</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-columna-asociada-a-más-de-una-variable"><i class="fa fa-check"></i>Una columna asociada a más de una variable</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#variables-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i>Variables almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#una-misma-unidad-observacional-está-almacenada-en-múltiples-tablas"><i class="fa fa-check"></i>Una misma unidad observacional está almacenada en múltiples tablas</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#otras-consideraciones"><i class="fa fa-check"></i>Otras consideraciones</a></li>
<li class="chapter" data-level="" data-path="datos-limpios.html"><a href="datos-limpios.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="temas-selectos-de-r.html"><a href="temas-selectos-de-r.html"><i class="fa fa-check"></i><b>4</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html"><i class="fa fa-check"></i><b>4.1</b> Funciones e iteración</a><ul>
<li class="chapter" data-level="" data-path="funciones-e-iteración.html"><a href="funciones-e-iteración.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>4.2</b> Vectores</a><ul>
<li class="chapter" data-level="" data-path="vectores.html"><a href="vectores.html#propiedades"><i class="fa fa-check"></i>Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="iteración.html"><a href="iteración.html"><i class="fa fa-check"></i><b>4.3</b> Iteración</a><ul>
<li class="chapter" data-level="" data-path="iteración.html"><a href="iteración.html#ciclos-for"><i class="fa fa-check"></i>Ciclos for</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html"><i class="fa fa-check"></i><b>4.4</b> Rendimiento en R</a><ul>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#diagnosticar"><i class="fa fa-check"></i>Diagnosticar</a></li>
<li class="chapter" data-level="" data-path="rendimiento-en-r.html"><a href="rendimiento-en-r.html#estrategias-para-mejorar-desempeño"><i class="fa fa-check"></i>Estrategias para mejorar desempeño</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="lecturas-y-recursos-recomendados-de-r.html"><a href="lecturas-y-recursos-recomendados-de-r.html"><i class="fa fa-check"></i><b>4.5</b> Lecturas y recursos recomendados de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-a-cálculo-de-probabilidades.html"><a href="introducción-a-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5</b> Introducción a Cálculo de Probabilidades</a><ul>
<li class="chapter" data-level="5.1" data-path="probabilidad-como-extensión-de-proporción.html"><a href="probabilidad-como-extensión-de-proporción.html"><i class="fa fa-check"></i><b>5.1</b> Probabilidad como extensión de proporción</a></li>
<li class="chapter" data-level="5.2" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html"><i class="fa fa-check"></i><b>5.2</b> Interpretación frecuentista de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="interpretación-frecuentista-de-probabilidad.html"><a href="interpretación-frecuentista-de-probabilidad.html#resultados-empíricos-acerca-de-frecuencias-relativas"><i class="fa fa-check"></i>Resultados empíricos acerca de frecuencias relativas</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulación-para-el-cálculo-de-probabilidades.html"><a href="simulación-para-el-cálculo-de-probabilidades.html"><i class="fa fa-check"></i><b>5.3</b> Simulación para el cálculo de probabilidades</a></li>
<li class="chapter" data-level="5.4" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html"><i class="fa fa-check"></i><b>5.4</b> Modelos de probabilidad (definición general)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-discretos"><i class="fa fa-check"></i><b>5.4.1</b> Espacios discretos</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelos-de-probabilidad-definición-general.html"><a href="modelos-de-probabilidad-definición-general.html#espacios-continuos"><i class="fa fa-check"></i><b>5.4.2</b> Espacios continuos</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html"><i class="fa fa-check"></i><b>5.5</b> Probabilidad: definición matemática</a><ul>
<li class="chapter" data-level="" data-path="probabilidad-definición-matemática.html"><a href="probabilidad-definición-matemática.html#propiedades-de-la-función-de-probabilidad"><i class="fa fa-check"></i>Propiedades de la función de probabilidad:</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>5.6</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribución-de-probabilidad"><i class="fa fa-check"></i>Distribución de probabilidad</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrap-no-paramétrico.html"><a href="bootstrap-no-paramétrico.html"><i class="fa fa-check"></i><b>6</b> Bootstrap no paramétrico</a><ul>
<li class="chapter" data-level="6.1" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html"><i class="fa fa-check"></i><b>6.1</b> El principio del plug-in</a><ul>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#muestras-aleatorias"><i class="fa fa-check"></i>Muestras aleatorias</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#función-de-distribución-empírica"><i class="fa fa-check"></i>Función de distribución empírica</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#parámetros-y-estadísticas"><i class="fa fa-check"></i>Parámetros y estadísticas</a></li>
<li class="chapter" data-level="" data-path="el-principio-del-plug-in.html"><a href="el-principio-del-plug-in.html#distribuciones-muestrales-y-errores-estándar"><i class="fa fa-check"></i>Distribuciones muestrales y errores estándar</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html"><i class="fa fa-check"></i><b>6.2</b> El estimador bootstrap del error estándar</a><ul>
<li class="chapter" data-level="" data-path="el-estimador-bootstrap-del-error-estándar.html"><a href="el-estimador-bootstrap-del-error-estándar.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>6.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="6.4" data-path="más-alla-de-muestras-aleatorias-simples.html"><a href="más-alla-de-muestras-aleatorias-simples.html"><i class="fa fa-check"></i><b>6.4</b> Más alla de muestras aleatorias simples</a></li>
<li class="chapter" data-level="6.5" data-path="bootstrap-en-r.html"><a href="bootstrap-en-r.html"><i class="fa fa-check"></i><b>6.5</b> Bootstrap en R</a></li>
<li class="chapter" data-level="6.6" data-path="conclusiones-y-observaciones.html"><a href="conclusiones-y-observaciones.html"><i class="fa fa-check"></i><b>6.6</b> Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="teoría-básica-de-simulación.html"><a href="teoría-básica-de-simulación.html"><i class="fa fa-check"></i><b>7</b> Teoría básica de simulación</a><ul>
<li class="chapter" data-level="7.1" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>7.1</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#generadores-congruenciales-y-mersenne-twister"><i class="fa fa-check"></i>Generadores congruenciales y Mersenne-Twister</a></li>
<li class="chapter" data-level="" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html#pruebas-de-aleatoriedad"><i class="fa fa-check"></i>Pruebas de aleatoriedad</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html"><i class="fa fa-check"></i><b>7.2</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-discretas-importantes"><i class="fa fa-check"></i>Familias discretas importantes</a></li>
<li class="chapter" data-level="" data-path="variables-aleatorias-1.html"><a href="variables-aleatorias-1.html#familias-continuas-importantes"><i class="fa fa-check"></i>Familias Continuas importantes</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html"><i class="fa fa-check"></i><b>7.3</b> Simulación de variables aleatorias</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aletaorias-discretas"><i class="fa fa-check"></i>Variables aletaorias discretas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#variables-aleatorias-continuas-2"><i class="fa fa-check"></i>Variables aleatorias continuas</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias.html"><a href="simulación-de-variables-aleatorias.html#aceptación-y-rechazo-1"><i class="fa fa-check"></i>Aceptación y rechazo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html"><i class="fa fa-check"></i><b>8</b> Simulación de modelos</a><ul>
<li class="chapter" data-level="" data-path="simulación-de-modelos.html"><a href="simulación-de-modelos.html#para-qué-simular-de-un-modelo"><i class="fa fa-check"></i>¿Para qué simular de un modelo?</a></li>
<li class="chapter" data-level="8.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>8.1</b> Distribuciones multivariadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#regla-de-bayes"><i class="fa fa-check"></i>Regla de Bayes</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#independencia"><i class="fa fa-check"></i>Independencia</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelos-gráficos-y-simulación-predictiva.html"><a href="modelos-gráficos-y-simulación-predictiva.html"><i class="fa fa-check"></i><b>8.2</b> Modelos gráficos y simulación predictiva</a></li>
<li class="chapter" data-level="8.3" data-path="inferencia-visual.html"><a href="inferencia-visual.html"><i class="fa fa-check"></i><b>8.3</b> Inferencia visual</a><ul>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia"><i class="fa fa-check"></i>Inferencia</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#protocolos-de-inferencia-visual"><i class="fa fa-check"></i>Protocolos de inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#pruebas-de-hipótesis-típicas"><i class="fa fa-check"></i>Pruebas de hipótesis típicas</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#inferencia-visual-1"><i class="fa fa-check"></i>Inferencia visual</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#más-allá-que-permutación"><i class="fa fa-check"></i>Más allá que permutación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual.html"><a href="inferencia-visual.html#otras-consideraciones-1"><i class="fa fa-check"></i>Otras consideraciones</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="tamaño-de-muestracalculos-de-potencia.html"><a href="tamaño-de-muestracalculos-de-potencia.html"><i class="fa fa-check"></i><b>8.4</b> Tamaño de muestra/calculos de potencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inferencia-paramétrica.html"><a href="inferencia-paramétrica.html"><i class="fa fa-check"></i><b>9</b> Inferencia paramétrica</a><ul>
<li class="chapter" data-level="9.1" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.1</b> Máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="máxima-verosimilitud.html"><a href="máxima-verosimilitud.html#propiedades-de-los-estimadores-de-máxima-verosimilitud"><i class="fa fa-check"></i>Propiedades de los estimadores de máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>9.2</b> Bootstrap paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="análisis-bayesiano.html"><a href="análisis-bayesiano.html"><i class="fa fa-check"></i><b>10</b> Análisis bayesiano</a><ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-subjetiva.html"><a href="probabilidad-subjetiva.html"><i class="fa fa-check"></i><b>10.1</b> Probabilidad subjetiva</a></li>
<li class="chapter" data-level="10.2" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html"><i class="fa fa-check"></i><b>10.2</b> Regla de Bayes e inferencia bayesiana</a><ul>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#regla-de-bayes-en-modelos-y-datos"><i class="fa fa-check"></i>Regla de Bayes en modelos y datos</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#objetivos-de-la-inferencia"><i class="fa fa-check"></i>Objetivos de la inferencia</a></li>
<li class="chapter" data-level="" data-path="regla-de-bayes-e-inferencia-bayesiana.html"><a href="regla-de-bayes-e-inferencia-bayesiana.html#cálculo-de-la-distribución-posterior"><i class="fa fa-check"></i>Cálculo de la distribución posterior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html"><i class="fa fa-check"></i><b>10.3</b> Distribuciones conjugadas</a><ul>
<li class="chapter" data-level="" data-path="distribuciones-conjugadas.html"><a href="distribuciones-conjugadas.html#ejemplo-bernoulli"><i class="fa fa-check"></i>Ejemplo: Bernoulli</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="aproximación-por-cuadrícula.html"><a href="aproximación-por-cuadrícula.html"><i class="fa fa-check"></i><b>10.4</b> Aproximación por cuadrícula</a></li>
<li class="chapter" data-level="10.5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>10.5</b> MCMC</a><ul>
<li class="chapter" data-level="" data-path="mcmc.html"><a href="mcmc.html#introducción-metrópolis"><i class="fa fa-check"></i>Introducción Metrópolis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="metrópolis.html"><a href="metrópolis.html"><i class="fa fa-check"></i><b>10.6</b> Metrópolis</a><ul>
<li class="chapter" data-level="" data-path="metrópolis.html"><a href="metrópolis.html#inferencia-de-dos-proporciones-binomiales"><i class="fa fa-check"></i>Inferencia de dos proporciones binomiales</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html"><i class="fa fa-check"></i><b>10.7</b> Muestreador de Gibbs</a><ul>
<li class="chapter" data-level="" data-path="muestreador-de-gibbs.html"><a href="muestreador-de-gibbs.html#conclusiones-y-observaciones-metrópolis-y-gibbs"><i class="fa fa-check"></i>Conclusiones y observaciones Metrópolis y Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html"><i class="fa fa-check"></i><b>10.8</b> HMC y Stan</a><ul>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#muestreo-hmc"><i class="fa fa-check"></i>Muestreo HMC</a></li>
<li class="chapter" data-level="" data-path="hmc-y-stan.html"><a href="hmc-y-stan.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html"><i class="fa fa-check"></i><b>10.9</b> Diagnósticos generales</a><ul>
<li class="chapter" data-level="" data-path="diagnósticos-generales.html"><a href="diagnósticos-generales.html#recomendaciones-generales"><i class="fa fa-check"></i>Recomendaciones generales</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html"><i class="fa fa-check"></i><b>10.10</b> Modelos jerárquicos</a><ul>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#modelo-jerárquico-una-moneda"><i class="fa fa-check"></i>Modelo jerárquico una moneda</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#multiples-monedas-de-una-misma-fábrica"><i class="fa fa-check"></i>Multiples monedas de una misma fábrica</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos.html"><a href="modelos-jerárquicos.html#ejemplo-estimación-de-tasas-de-mortalidad"><i class="fa fa-check"></i>Ejemplo: estimación de tasas de mortalidad</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html"><i class="fa fa-check"></i><b>10.11</b> Inicialesy Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="inicialesy-reparametrización.html"><a href="inicialesy-reparametrización.html#iniciales-en-stan"><i class="fa fa-check"></i>Iniciales en Stan</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="reparametrización.html"><a href="reparametrización.html"><i class="fa fa-check"></i><b>10.12</b> Reparametrización</a><ul>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#ejemplo-el-embudo-de-neal"><i class="fa fa-check"></i>Ejemplo: El embudo de Neal</a></li>
<li class="chapter" data-level="" data-path="reparametrización.html"><a href="reparametrización.html#modelos-jerárquicos-y-parametrización-no-centrada"><i class="fa fa-check"></i>Modelos jerárquicos y parametrización no centrada</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="recursos-de-stan-y-paquetes-con-r.html"><a href="recursos-de-stan-y-paquetes-con-r.html"><i class="fa fa-check"></i><b>10.13</b> Recursos de Stan y paquetes con R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="instalación-y-visualización.html"><a href="instalación-y-visualización.html"><i class="fa fa-check"></i>1. Instalación y visualización</a></li>
<li class="chapter" data-level="" data-path="transformación-de-datos-1.html"><a href="transformación-de-datos-1.html"><i class="fa fa-check"></i>2. Transformación de datos</a></li>
<li class="chapter" data-level="" data-path="unión-de-tablas-y-limpieza-de-datos.html"><a href="unión-de-tablas-y-limpieza-de-datos.html"><i class="fa fa-check"></i>3. Unión de tablas y limpieza de datos</a></li>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html"><i class="fa fa-check"></i>4. Programación funcional y distribución muestral</a><ul>
<li class="chapter" data-level="" data-path="programación-funcional-y-distribución-muestral.html"><a href="programación-funcional-y-distribución-muestral.html#solución-bootstrap"><i class="fa fa-check"></i>Solución + bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bootstrap-conteo.html"><a href="bootstrap-conteo.html"><i class="fa fa-check"></i>5. Bootstrap conteo</a></li>
<li class="chapter" data-level="" data-path="respuesta-ejercicios-clase.html"><a href="respuesta-ejercicios-clase.html"><i class="fa fa-check"></i>Respuesta ejercicios clase</a></li>
<li class="chapter" data-level="" data-path="más-bootstrap.html"><a href="más-bootstrap.html"><i class="fa fa-check"></i>6. Más bootstrap</a></li>
<li class="chapter" data-level="" data-path="simulación-de-variables-aleatorias-1.html"><a href="simulación-de-variables-aleatorias-1.html"><i class="fa fa-check"></i>7. Simulación de variables aleatorias</a></li>
<li class="chapter" data-level="" data-path="distribuciones-multivariada-y-simulación.html"><a href="distribuciones-multivariada-y-simulación.html"><i class="fa fa-check"></i>8. Distribuciones multivariada y simulación</a></li>
<li class="chapter" data-level="" data-path="inferencia-visual-y-simulación-e-modelos.html"><a href="inferencia-visual-y-simulación-e-modelos.html"><i class="fa fa-check"></i>9. Inferencia visual y simulación e modelos</a></li>
<li class="chapter" data-level="" data-path="simulación-muestra-y-bootstrap-paramétrico.html"><a href="simulación-muestra-y-bootstrap-paramétrico.html"><i class="fa fa-check"></i>10. Simulación muestra y bootstrap paramétrico</a></li>
<li class="chapter" data-level="" data-path="familias-conjugadas.html"><a href="familias-conjugadas.html"><i class="fa fa-check"></i>11-Familias conjugadas</a></li>
<li class="chapter" data-level="" data-path="metropolis-1.html"><a href="metropolis-1.html"><i class="fa fa-check"></i>12-Metropolis</a></li>
<li class="chapter" data-level="" data-path="modelos-jerárquicos-1.html"><a href="modelos-jerárquicos-1.html"><i class="fa fa-check"></i>13-Modelos jerárquicos</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html"><i class="fa fa-check"></i>Final</a><ul>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#inferencia-gráfica"><i class="fa fa-check"></i>1. Inferencia gráfica</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#simulación-para-el-cálculo-de-tamaños-de-muestra"><i class="fa fa-check"></i>2. Simulación para el cálculo de tamaños de muestra</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#mcmc-1"><i class="fa fa-check"></i>3. MCMC</a></li>
<li class="chapter" data-level="" data-path="final.html"><a href="final.html#modelos-jerárquicos-stan-y-evaluación-de-ajuste"><i class="fa fa-check"></i>4. Modelos jerárquicos, Stan y evaluación de ajuste</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Computacional</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tamaño-de-muestracalculos-de-potencia" class="section level2">
<h2><span class="header-section-number">8.4</span> Tamaño de muestra/calculos de potencia</h2>
<p>Cuando se esta diseñando un estudio se determina la precisión en las inferencias
que se desea, y esto (junto con algunos supuestos de la población) determina el
tamaño de muestra que se tomará. Usualmente se fija uno de los siguientes dos
objetivos:</p>
<ol style="list-style-type: decimal">
<li><p>Se determina el error estándar de un parámetro o cantidad de interés (o de
manera equivalente se fija la longitud máxima aceptable del intervalo de
confianza que resultará). Por ejemplo, en encuestas electorales es típico
reportar <em>los resultados de esta encuesta más menos <span class="math inline">\(3\)</span> puntos porcentuales tienen
un nivel del <span class="math inline">\(95\%\)</span> de confianza</em>, ¿cúantas personas se debe entrevistar para
lograr esto?</p></li>
<li><p>Se determina la probabilidad de que un estadístico determinado sea
<em>estadísticamente significativo</em>, esto se conoce como la potencia de un
experimento. Por ejemplo, cuando se hacen ensayos clínicos
se determina un tamaño de muestra para que con probabilidad de <span class="math inline">\(x\)</span>% se detecte
una diferencia clinicamente relevante con el nuevo tratamiento (si es que este
es efectivo).</p></li>
</ol>
<p>En muchos casos existen fórmulas para calcular tamaños de muestra de tal manera
que se cumplan los objetivos planteados, sin embargo, conforme se agrega
complejidad al levantamiento de los datos (faltantes, levantamientos en
varias etapas, …) o si nos alejamos de las estadísticas típicas, las fórmulas
dejan de aplicar o se vuelven muy complejas, de manera que suele ser conveniente
recurrir a simulación. Veremos dos ejemplos que se tomaron de <span class="citation">Gelman and Hill (<a href="#ref-gelman-hill">2007</a>)</span>.</p>
<div id="tamaño-de-muestra-para-un-error-estándar-determinado" class="section level4 unnumbered">
<h4>Tamaño de muestra para un error estándar determinado</h4>
<p>Supongamos que queremos estimar el porcentaje de la población que
desaprueba la legalización del aborto en México (ante una pregunta particular).
Sospechamos que la proporción es <span class="math inline">\(60\%\)</span>, imaginemos
que queremos una precisión (error estándar) de a lo más <span class="math inline">\(0.05\)</span>, o <span class="math inline">\(5\)</span> puntos
porcentuales. Bajo muestreo aleatorio simple, para una muestra de tamaño <span class="math inline">\(n\)</span>,
el error estándar de la proporción <span class="math inline">\(p\)</span> es</p>
<p><span class="math display">\[\sqrt{p(1-p)/n}\]</span></p>
<p>Sustituyendo nuestra expectativa <span class="math inline">\(p = 0.60\)</span> llegamos a que el error estándar
sería <span class="math inline">\(0.49/\sqrt{n}\)</span>, de tal manera que si queremos <span class="math inline">\(se(p) \le 0.05\)</span>
necesitamos <span class="math inline">\(n&gt;96\)</span>, en el caso de proporciones es fácil determinar el tamaño de
muestra de manera conservadora pues basta con suponer <span class="math inline">\(p = 0.5\)</span>.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1">se_fun_n &lt;-<span class="st"> </span><span class="cf">function</span>(n, p) <span class="kw">sqrt</span>(p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p) <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb297-2" data-line-number="2"></a>
<a class="sourceLine" id="cb297-3" data-line-number="3">xy &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">20</span><span class="op">:</span><span class="dv">220</span>, <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.005</span>))</a>
<a class="sourceLine" id="cb297-4" data-line-number="4"></a>
<a class="sourceLine" id="cb297-5" data-line-number="5"><span class="kw">ggplot</span>(xy, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-6" data-line-number="6"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> se_fun_n, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">p =</span> <span class="fl">0.7</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;p=0.7&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-7" data-line-number="7"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> se_fun_n, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">p =</span> <span class="fl">0.9</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;p=0.9&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-8" data-line-number="8"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> se_fun_n, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">p =</span> <span class="fl">0.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;p=0.5&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-9" data-line-number="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="dv">20</span>, <span class="dt">xend =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.05</span>, <span class="dt">yend =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb297-11" data-line-number="11">        <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb297-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="dv">100</span>, <span class="dt">xend =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.05</span>, <span class="dt">yend =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb297-13" data-line-number="13">        <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-44-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>Cómo calcularíamos el tamaño de muestra simulando? En este caso es trivial
calcular de manera analítica, pero nos sirve para comparar los resultados que
obtendríamos con simulación.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" data-line-number="1">sim_p_hat &lt;-<span class="st"> </span><span class="cf">function</span>(n, p, <span class="dt">n_sims =</span> <span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb298-2" data-line-number="2">    sim_muestra &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n_sims, <span class="dt">size =</span> n, <span class="dt">prob =</span> p)</a>
<a class="sourceLine" id="cb298-3" data-line-number="3">    se_p_hat &lt;-<span class="st"> </span><span class="kw">sd</span>(sim_muestra <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb298-4" data-line-number="4">    <span class="kw">tibble</span>(<span class="dt">n =</span> n, <span class="dt">se_p_hat =</span> se_p_hat, <span class="dt">p =</span> p)</a>
<a class="sourceLine" id="cb298-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb298-6" data-line-number="6"></a>
<a class="sourceLine" id="cb298-7" data-line-number="7">sims_.<span class="dv">7</span> &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">220</span>, <span class="dv">5</span>), sim_p_hat, <span class="dt">p =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb298-8" data-line-number="8">sims_.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">220</span>, <span class="dv">5</span>), sim_p_hat, <span class="dt">p =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb298-9" data-line-number="9">sims_.<span class="dv">9</span> &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">220</span>, <span class="dv">5</span>), sim_p_hat, <span class="dt">p =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb298-10" data-line-number="10">sims &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(sims_.<span class="dv">7</span>, sims_.<span class="dv">5</span>, sims_.<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb298-11" data-line-number="11"></a>
<a class="sourceLine" id="cb298-12" data-line-number="12"><span class="kw">ggplot</span>(sims, <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> se_p_hat, <span class="dt">color =</span> <span class="kw">factor</span>(p), <span class="dt">group =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-14" data-line-number="14"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="dv">20</span>, <span class="dt">xend =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.05</span>, <span class="dt">yend =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb298-16" data-line-number="16">        <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-17" data-line-number="17"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="dv">100</span>, <span class="dt">xend =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.05</span>, <span class="dt">yend =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb298-18" data-line-number="18">        <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>)</a>
<a class="sourceLine" id="cb298-19" data-line-number="19"><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-45-1.png" width="350px" style="display: block; margin: auto;" /></p>
</div>
<div id="tamaño-de-muestra-determinado-para-obtener-significancia-estadística-con-una-probabilidad-determinada" class="section level4 unnumbered">
<h4>Tamaño de muestra determinado para obtener significancia estadística con una probabilidad determinada</h4>
<p>Supongamos que nuestro objetivo es demostrar que más de la mitad de la población
desaprueba la legalización del anorto, esto es <span class="math inline">\(p&gt;0.5\)</span>, nuevamente tenemos la
hipótesis que el verdadero valor es <span class="math inline">\(p=0.6\)</span>.</p>
<p>Una prueba de potencia típica tiene un poder de <span class="math inline">\(80\)</span>%, es decir nos gustaría
seleccionar <span class="math inline">\(n\)</span> tal que el <span class="math inline">\(80\%\)</span> de los intervalos construidos con <span class="math inline">\(95\%\)</span> de
confianza no incluyan <span class="math inline">\(0.5\)</span>. Para encontrar la <span class="math inline">\(n\)</span> tal que el <span class="math inline">\(80\%\)</span> de las
estimaciones estén al menos, <span class="math inline">\(1.96\)</span> errores estándar por encima de <span class="math inline">\(0.5\)</span>
necesitamos que:</p>
<p><span class="math display">\[0.5 + 1.96 se \leq 0.6 - 0.84 se\]</span></p>
<p>Sustituyendo <span class="math inline">\(se = 0.5/\sqrt{n}\)</span> obtenemos <span class="math inline">\(n=196\)</span></p>
<p>Y simulando sería</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" data-line-number="1">sim_potencia &lt;-<span class="st"> </span><span class="cf">function</span>(n, p, <span class="dt">n_sims =</span> <span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb299-2" data-line-number="2">    sim_muestra &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n_sims, <span class="dt">size =</span> n, <span class="dt">prob =</span> p)</a>
<a class="sourceLine" id="cb299-3" data-line-number="3">    p_hat &lt;-<span class="st"> </span>sim_muestra <span class="op">/</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb299-4" data-line-number="4">    se_p_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_hat) <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb299-5" data-line-number="5">    acepta &lt;-<span class="st"> </span>(p_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se_p_hat) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb299-6" data-line-number="6">    <span class="kw">tibble</span>(<span class="dt">n =</span> n, <span class="dt">p =</span> p, <span class="dt">potencia =</span> <span class="kw">mean</span>(acepta))</a>
<a class="sourceLine" id="cb299-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb299-8" data-line-number="8"></a>
<a class="sourceLine" id="cb299-9" data-line-number="9">casos_sim &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">500</span>), </a>
<a class="sourceLine" id="cb299-10" data-line-number="10">    <span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>))</a>
<a class="sourceLine" id="cb299-11" data-line-number="11"></a>
<a class="sourceLine" id="cb299-12" data-line-number="12">sims &lt;-<span class="st"> </span><span class="kw">map2_df</span>(casos_sim<span class="op">$</span>n, casos_sim<span class="op">$</span>p, <span class="op">~</span><span class="kw">sim_potencia</span>(<span class="dt">n =</span> .x, <span class="dt">p =</span> .y))</a>
<a class="sourceLine" id="cb299-13" data-line-number="13"></a>
<a class="sourceLine" id="cb299-14" data-line-number="14"><span class="kw">ggplot</span>(sims) <span class="op">+</span></a>
<a class="sourceLine" id="cb299-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> potencia, <span class="dt">color =</span> <span class="kw">factor</span>(p), <span class="dt">group =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb299-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.8</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb299-17" data-line-number="17">        <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-46-1.png" width="350px" style="display: block; margin: auto;" /></p>
</div>
<div id="respuestas-continuas" class="section level4 unnumbered">
<h4>Respuestas continuas</h4>
<p>En el caso de variables respuesta continuas la dificultad adicional está en
que debemos fijar además del tamaño hipotético del efecto la desviación estándar
poblacional.</p>
<p>Como ejemplo, supongamos que se implementará un experimento en el que se añadirá
un suplemento de zinc en la dieta de niños VIH positivos en el Sudáfrica, esto
porque en otras poblaciones se ha visto que agregar zinc y otros micronutrientes
reduce la ocurrencia de diarrea que a su vez está asociado a problemas del
sistema inmune y que alenta el avance del VIH. Comenzamos con el problema de una
muestra, ¿qué tamaño de muestra necesitamos para alacanzar una
precisión dada?</p>
</div>
<div id="calculo-de-poder-en-modelo-multinivel" class="section level4 unnumbered">
<h4>Calculo de poder en modelo multinivel</h4>
<p>Veamos un ejemplo más interesante, en donde usamos simulación de un modelo
probabilístico. Tenemos medidas del sistema inmune (porcentaje de CD4
transformado con raíz cuadrada) de niños VIH positivos a lo largo de un periodo
de <span class="math inline">\(2\)</span> años. Las series de tiempo se ajustan de manera razonable con un modelo
de intercepto y pendiente variable:</p>
<p><span class="math display">\[y_i \sim N(\alpha_{j[i]} + \beta_{j[i]}t_i, \sigma^2_y)\]</span></p>
<p>donde <span class="math inline">\(i\)</span> indexa las mediciones tomadas al tiempo <span class="math inline">\(i\)</span> en el individuo <span class="math inline">\(j[i]\)</span>.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" data-line-number="1"><span class="co"># preparación de los datos</span></a>
<a class="sourceLine" id="cb300-2" data-line-number="2"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb300-3" data-line-number="3">allvar &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/data_sim/allvar.csv&quot;</span>)</a>
<a class="sourceLine" id="cb300-4" data-line-number="4"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb300-5" data-line-number="5"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb300-6" data-line-number="6"><span class="co">#&gt;   VISIT = col_double(),</span></a>
<a class="sourceLine" id="cb300-7" data-line-number="7"><span class="co">#&gt;   newpid = col_double(),</span></a>
<a class="sourceLine" id="cb300-8" data-line-number="8"><span class="co">#&gt;   VDATE = col_character(),</span></a>
<a class="sourceLine" id="cb300-9" data-line-number="9"><span class="co">#&gt;   CD4PCT = col_double(),</span></a>
<a class="sourceLine" id="cb300-10" data-line-number="10"><span class="co">#&gt;   arv = col_double(),</span></a>
<a class="sourceLine" id="cb300-11" data-line-number="11"><span class="co">#&gt;   visage = col_double(),</span></a>
<a class="sourceLine" id="cb300-12" data-line-number="12"><span class="co">#&gt;   treatmnt = col_double(),</span></a>
<a class="sourceLine" id="cb300-13" data-line-number="13"><span class="co">#&gt;   CD4CNT = col_double(),</span></a>
<a class="sourceLine" id="cb300-14" data-line-number="14"><span class="co">#&gt;   baseage = col_double()</span></a>
<a class="sourceLine" id="cb300-15" data-line-number="15"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb300-16" data-line-number="16">cd4 &lt;-<span class="st"> </span>allvar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-17" data-line-number="17"><span class="st">    </span><span class="kw">filter</span>(treatmnt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="op">!</span><span class="kw">is.na</span>(CD4PCT), baseage <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>, baseage <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-18" data-line-number="18"><span class="st">    </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb300-19" data-line-number="19">        <span class="dt">y =</span> <span class="kw">sqrt</span>(CD4PCT), </a>
<a class="sourceLine" id="cb300-20" data-line-number="20">        <span class="dt">person =</span> newpid, </a>
<a class="sourceLine" id="cb300-21" data-line-number="21">        <span class="dt">time =</span> visage <span class="op">-</span><span class="st"> </span>baseage</a>
<a class="sourceLine" id="cb300-22" data-line-number="22">        ) </a></code></pre></div>
<p>La siguiente gráfica muestra las mediciones para cada individuo, podemos ver que
las series de tiempo son ruidosas.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="kw">ggplot</span>(cd4, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> y, <span class="dt">group =</span> person)) <span class="op">+</span></a>
<a class="sourceLine" id="cb301-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-48-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>Veamos un ajuste usando la función <code>lmer()</code> del paquete <code>lme4</code>.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" data-line-number="1">fit_cd4 &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>person), cd4)</a>
<a class="sourceLine" id="cb302-2" data-line-number="2"><span class="kw">summary</span>(fit_cd4)</a>
<a class="sourceLine" id="cb302-3" data-line-number="3"><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></a>
<a class="sourceLine" id="cb302-4" data-line-number="4"><span class="co">#&gt; Formula: y ~ time + (1 + time | person)</span></a>
<a class="sourceLine" id="cb302-5" data-line-number="5"><span class="co">#&gt;    Data: cd4</span></a>
<a class="sourceLine" id="cb302-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb302-7" data-line-number="7"><span class="co">#&gt; REML criterion at convergence: 1096.1</span></a>
<a class="sourceLine" id="cb302-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb302-9" data-line-number="9"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb302-10" data-line-number="10"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb302-11" data-line-number="11"><span class="co">#&gt; -4.4621 -0.4354  0.0504  0.3597  3.4620 </span></a>
<a class="sourceLine" id="cb302-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb302-13" data-line-number="13"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb302-14" data-line-number="14"><span class="co">#&gt;  Groups   Name        Variance Std.Dev. Corr</span></a>
<a class="sourceLine" id="cb302-15" data-line-number="15"><span class="co">#&gt;  person   (Intercept) 1.7659   1.3289       </span></a>
<a class="sourceLine" id="cb302-16" data-line-number="16"><span class="co">#&gt;           time        0.4619   0.6796   0.15</span></a>
<a class="sourceLine" id="cb302-17" data-line-number="17"><span class="co">#&gt;  Residual             0.5595   0.7480       </span></a>
<a class="sourceLine" id="cb302-18" data-line-number="18"><span class="co">#&gt; Number of obs: 369, groups:  person, 83</span></a>
<a class="sourceLine" id="cb302-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb302-20" data-line-number="20"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb302-21" data-line-number="21"><span class="co">#&gt;             Estimate Std. Error t value</span></a>
<a class="sourceLine" id="cb302-22" data-line-number="22"><span class="co">#&gt; (Intercept)   4.8460     0.1597  30.349</span></a>
<a class="sourceLine" id="cb302-23" data-line-number="23"><span class="co">#&gt; time         -0.4683     0.1276  -3.671</span></a>
<a class="sourceLine" id="cb302-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb302-25" data-line-number="25"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb302-26" data-line-number="26"><span class="co">#&gt;      (Intr)</span></a>
<a class="sourceLine" id="cb302-27" data-line-number="27"><span class="co">#&gt; time -0.146</span></a></code></pre></div>
<p>Notamos que las tendencias sobre el tiempo <span class="math inline">\(\beta\)</span> tienen un promedio estimado
en <span class="math inline">\(-0.5\)</span> con desviación estándar de <span class="math inline">\(0.7\)</span>, es decir, estimamos que la mayoría
de los niños tienen niveles de CD4 decrecientes, pero no todos.</p>
<p>Usaremos estos resultados para hacer calculos de potencia para una nueva prueba
que busca medir el efecto del consumo de zinc en la dieta. Quisiéramos que el
estudio fuera suficientemente grande para que con probabilidad de al menos <span class="math inline">\(80\)</span>%
la media del efecto del tratamiento sea significativo con un nivel de confianza
del <span class="math inline">\(95\%\)</span>.</p>
<p>Necesitamos hacer supuestos del efecto del tratamiento y del resto de los
parámetros que caracterizan el estudio. El análisis de arriba muestra que en los
niños VIH positivos que no recibieron zinc los niveles de CD4 caían en promedio
<span class="math inline">\(0.5\)</span> al año. Suponemos que con el zinc reduciremos la caída a cero.</p>
<p><span class="math display">\[y_i \sim N(\alpha_{j[i]} + \beta_{j[i]}t_i, \sigma^2_y)\]</span></p>
<p><span class="math display">\[
\begin{eqnarray*}
\begin{pmatrix}\alpha_{j}\\
\beta_{j}
\end{pmatrix} &amp; \sim &amp; N\left[\left(\begin{array}{c}
\gamma_0^{\alpha}\\
\gamma_0^{\beta}+\gamma_1^{\beta}z_j
\end{array}\right), \left(\begin{array}{cc}
\sigma^2_{\alpha} &amp; \rho \sigma_{\alpha}\sigma_{\beta}\\
\rho \sigma_{\alpha}\sigma_{\beta} &amp; \sigma^2_{\beta}
\end{array}\right)\right]
\end{eqnarray*}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
z_j = \left\{
  \begin{array}{lr}
    1 &amp;  \text{si el }j \text{-ésimo niño recibió trataiento}\\
    0 &amp;  e.o.c
  \end{array}
\right.
\]</span></p>
<p>El tratamiento <span class="math inline">\(z_j\)</span> afecta la pendiente <span class="math inline">\(\beta_j\)</span> más no el intercepto <span class="math inline">\(\alpha_j\)</span>
pues el tratamiento no puede afectar en el tiempo cero. Usando los datos del ajuste
de arriba tenemos que para el grupo control la pendiente será:</p>
<p><span class="math inline">\(\gamma_0^{\beta} = -0.5\)</span> y el efecto del tratamiento <span class="math inline">\(\gamma_1^{\beta} = 0.5\)</span>,
el resto de los parámetros los especificamos de acuerdo al ajuste de arriba.
Por simplicidad fijaremos la correlación <span class="math inline">\(\rho\)</span> en cero.</p>
<p>El siguiente paso es determinar el diseño del modelo, suponemos que dividiremos
a <span class="math inline">\(J\)</span> niños VIH positivos en dos grupos del mismo tamaño, <span class="math inline">\(J/2\)</span> de ellos
recibirán el cuidado usual y <span class="math inline">\(J/2\)</span> recibirán suplementos de zinc. Más aún
suponemos que se medirá el porcentaje de CD4 cada <span class="math inline">\(2\)</span> meses durante un año.</p>
<p>Usaremos simulación para determinar el tamaño de muestra <span class="math inline">\(J\)</span> que se requiere
para tener una potencia de <span class="math inline">\(80\%\)</span> si el verdadero efecto es <span class="math inline">\(0.5\)</span>, ¿cuál es el
modelo gráfico asociado?</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1"><span class="co"># cd4_sim simula del modelo con los supuestos que fijamos arriba</span></a>
<a class="sourceLine" id="cb303-2" data-line-number="2"><span class="co">#   podemos variar los valores de los parámetros para cambiar el escenario</span></a>
<a class="sourceLine" id="cb303-3" data-line-number="3">cd4_sim &lt;-<span class="st"> </span><span class="cf">function</span>(J, K, <span class="dt">mu.a.true =</span> <span class="fl">4.8</span>, <span class="dt">g.0.true =</span> <span class="fl">-0.5</span>, <span class="dt">g.1.true =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb303-4" data-line-number="4">    <span class="dt">sigma.y.true =</span> <span class="fl">0.7</span>, <span class="dt">sigma.a.true =</span> <span class="fl">1.3</span>, <span class="dt">sigma.b.true =</span> <span class="fl">0.7</span>){</a>
<a class="sourceLine" id="cb303-5" data-line-number="5">    time &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> K), J) <span class="co"># K mediciones en el año</span></a>
<a class="sourceLine" id="cb303-6" data-line-number="6">    person &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>J, <span class="dt">each =</span> K)        <span class="co"># ids</span></a>
<a class="sourceLine" id="cb303-7" data-line-number="7">    treatment &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, J<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb303-8" data-line-number="8">    treatment1 &lt;-<span class="st"> </span>treatment[person]</a>
<a class="sourceLine" id="cb303-9" data-line-number="9">    <span class="co"># parámetros a nivel persona</span></a>
<a class="sourceLine" id="cb303-10" data-line-number="10">    a.true &lt;-<span class="st"> </span><span class="kw">rnorm</span>(J, mu.a.true, sigma.a.true)</a>
<a class="sourceLine" id="cb303-11" data-line-number="11">    b.true &lt;-<span class="st"> </span><span class="kw">rnorm</span>(J, g.<span class="fl">0.</span>true <span class="op">+</span><span class="st"> </span>g.<span class="fl">1.</span>true <span class="op">*</span><span class="st"> </span>treatment, sigma.b.true)</a>
<a class="sourceLine" id="cb303-12" data-line-number="12">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(J <span class="op">*</span><span class="st"> </span>K, a.true[person] <span class="op">+</span><span class="st"> </span>b.true[person] <span class="op">*</span><span class="st"> </span>time, sigma.y.true)</a>
<a class="sourceLine" id="cb303-13" data-line-number="13">    <span class="kw">data.frame</span>(y, time, person, treatment1)</a>
<a class="sourceLine" id="cb303-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb303-15" data-line-number="15"></a>
<a class="sourceLine" id="cb303-16" data-line-number="16"><span class="co"># calcular si el parámetro es significativo para una generación de simulación</span></a>
<a class="sourceLine" id="cb303-17" data-line-number="17">cd4_signif &lt;-<span class="st"> </span><span class="cf">function</span>(J, K){</a>
<a class="sourceLine" id="cb303-18" data-line-number="18">    fake &lt;-<span class="st"> </span><span class="kw">cd4_sim</span>(J, K)</a>
<a class="sourceLine" id="cb303-19" data-line-number="19">    lme_power &lt;-<span class="st"> </span><span class="kw">lmer</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>treatment1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>person), <span class="dt">data =</span> fake)</a>
<a class="sourceLine" id="cb303-20" data-line-number="20">    theta_hat &lt;-<span class="st"> </span><span class="kw">fixef</span>(lme_power)[<span class="st">&quot;time:treatment1&quot;</span>]</a>
<a class="sourceLine" id="cb303-21" data-line-number="21">    theta_se &lt;-<span class="st"> </span><span class="kw">summary</span>(lme_power)<span class="op">$</span>coefficients[<span class="st">&quot;time:treatment1&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>]</a>
<a class="sourceLine" id="cb303-22" data-line-number="22">    theta_hat <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>theta_se <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb303-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb303-24" data-line-number="24"></a>
<a class="sourceLine" id="cb303-25" data-line-number="25"><span class="co"># repetir la simulación de cd4 n_sims veces y calcular el porcentaje de las</span></a>
<a class="sourceLine" id="cb303-26" data-line-number="26"><span class="co">#   muestras en que es significativo el parámetro (el poder)</span></a>
<a class="sourceLine" id="cb303-27" data-line-number="27">cd4_power &lt;-<span class="st"> </span><span class="cf">function</span>(n_sims, J, K){</a>
<a class="sourceLine" id="cb303-28" data-line-number="28">    <span class="kw">rerun</span>(n_sims, <span class="kw">cd4_signif</span>(J, <span class="dt">K =</span> <span class="dv">7</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean</span>()</a>
<a class="sourceLine" id="cb303-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb303-30" data-line-number="30"></a>
<a class="sourceLine" id="cb303-31" data-line-number="31"><span class="co"># calculamos el poder para distintos tamaños de muestra, con 7 mediciones al año</span></a>
<a class="sourceLine" id="cb303-32" data-line-number="32">potencias &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">60</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">225</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">400</span>), </a>
<a class="sourceLine" id="cb303-33" data-line-number="33">    <span class="op">~</span><span class="kw">data_frame</span>(<span class="dt">n =</span> ., <span class="dt">p =</span> <span class="kw">cd4_power</span>(<span class="dt">n_sims =</span> <span class="dv">500</span>, <span class="dt">J =</span> ., <span class="dt">K =</span> <span class="dv">7</span>)))</a>
<a class="sourceLine" id="cb303-34" data-line-number="34"></a>
<a class="sourceLine" id="cb303-35" data-line-number="35"><span class="kw">ggplot</span>(potencias, <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-36" data-line-number="36"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.8</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-37" data-line-number="37"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</a></code></pre></div>
<p><img src="07-simulacion_modelos_files/figure-html/unnamed-chunk-50-1.png" width="350px" style="display: block; margin: auto;" /></p>
<p>Notemos que la función <code>cd4_rep()</code> regresa la proporción de las simulaciones en
las que el resultado es estadísticamente significativo, esto es, la potencia
calculada con simulación, para un estudio con <span class="math inline">\(J\)</span> niños medidos en <span class="math inline">\(K\)</span>
intervalos igualmente espaciados.</p>
<p>Notemos también que en el límite, cuando <span class="math inline">\(J \to 0\)</span> el poder es <span class="math inline">\(0.025\)</span>, esto es,
con una muestra suficientemente chica el efecto del estimador es básicamente
aleatorio y por tanto en <span class="math inline">\(2.5\%\)</span> de los casos el estimador está <span class="math inline">\(2\)</span> desviaciones
por encima de cero.</p>
<p>Una ventaja de usar simulación para calcular potencia es que nos permite
flexibilidad, por ejemplo, es fácil calcular para más escenarios:</p>
<p><img src="img/manicule2.jpg" /> ¿qué ocurriría si solo puedo medir <span class="math inline">\(3\)</span> veces al año?</p>
<ul>
<li>Se sabe que es común que algunos participantes abandonen el estudio, o no
asistan a todas las mediciones, con simulación es fácil incorporar faltantes.</li>
</ul>
<!--
* Cook, D. [To the tidyverse and beyond: Challenges to the future of data science](http://www.dicook.org/files/rstudio/#1)

* Wickham, H., Cook, D., Hofmann, H. and Buja, A. (2010) [Graphical Inference for Infovis](http://stat.wharton.upenn.edu/~buja/PAPERS/Wickham-Cook-Hofmann-Buja-IEEE-TransVizCompGraphics_2010-Graphical%20Inference%20for%20Infovis.pdf)

* Hofmann, H., Follett, L., Majumder, M. and Cook, D. (2012) Graphical Tests for Power Comparison of Competing Designs.

* Tufte, E. [Making better inferences from statistical graphics](http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003wa).

* Cook, D. [To the tidyverse and beyond: Challenges to the future of data science](http://www.dicook.org/files/rstudio/#1)

* [Supplementary Material for “Statistical Inference for Exploratory Data Analysis
and Model Diagnostics"](http://stat.wharton.upenn.edu/~buja/PAPERS/06-Buja-Cook-Hofmann-Lawrence-Lee-Swayne-Wickham-suppl.pdf)
-->

</div>
</div>
<!-- </div> -->
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-gelman-hill">
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Vol. Analytical methods for social research. New York: Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inferencia-visual.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferencia-paramétrica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/est-computacional-2019/edit/master/07-simulacion_modelos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
